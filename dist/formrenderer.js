!function(j){var e;e=function(L){"use strict";var b={};b.fileapi=void 0!==L("<input type='file'/>").get(0).files,b.formdata=void 0!==j.FormData;var I=!!L.fn.prop;function n(e){var t=e.data;e.isDefaultPrevented()||(e.preventDefault(),L(e.target).ajaxSubmit(t))}function r(e){var t=e.target,n=L(t);if(!n.is("[type=submit],[type=image]")){var r=n.closest("[type=submit]");if(0===r.length)return;t=r[0]}var i=this;if("image"==(i.clk=t).type)if(void 0!==e.offsetX)i.clk_x=e.offsetX,i.clk_y=e.offsetY;else if("function"==typeof L.fn.offset){var o=n.offset();i.clk_x=e.pageX-o.left,i.clk_y=e.pageY-o.top}else i.clk_x=e.pageX-t.offsetLeft,i.clk_y=e.pageY-t.offsetTop;setTimeout(function(){i.clk=i.clk_x=i.clk_y=null},100)}function V(){if(L.fn.ajaxSubmit.debug){var e="[jquery.form] "+Array.prototype.join.call(arguments,"");j.console&&j.console.log?j.console.log(e):j.opera&&j.opera.postError&&j.opera.postError(e)}}L.fn.attr2=function(){if(!I)return this.attr.apply(this,arguments);var e=this.prop.apply(this,arguments);return e&&e.jquery||"string"==typeof e?e:this.attr.apply(this,arguments)},L.fn.ajaxSubmit=function(E){if(!this.length)return V("ajaxSubmit: skipping submit process - no element selected"),this;var M,e,t,A=this;"function"==typeof E?E={success:E}:void 0===E&&(E={}),M=E.type||this.attr2("method"),(t=(t="string"==typeof(e=E.url||this.attr2("action"))?L.trim(e):"")||j.location.href||"")&&(t=(t.match(/^([^#]+)/)||[])[1]),E=L.extend(!0,{url:t,success:L.ajaxSettings.success,type:M||L.ajaxSettings.type,iframeSrc:/^https/i.test(j.location.href||"")?"javascript:false":"about:blank"},E);var n={};if(this.trigger("form-pre-serialize",[this,E,n]),n.veto)return V("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(E.beforeSerialize&&!1===E.beforeSerialize(this,E))return V("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var r=E.traditional;void 0===r&&(r=L.ajaxSettings.traditional);var i,P=[],o=this.formToArray(E.semantic,P);if(E.data&&(E.extraData=E.data,i=L.param(E.data,r)),E.beforeSubmit&&!1===E.beforeSubmit(o,this,E))return V("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[o,this,E,n]),n.veto)return V("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var s=L.param(o,r);i&&(s=s?s+"&"+i:i),"GET"==E.type.toUpperCase()?(E.url+=(0<=E.url.indexOf("?")?"&":"?")+s,E.data=null):E.data=s;var a=[];if(E.resetForm&&a.push(function(){A.resetForm()}),E.clearForm&&a.push(function(){A.clearForm(E.includeHidden)}),!E.dataType&&E.target){var l=E.success||function(){};a.push(function(e){var t=E.replaceTarget?"replaceWith":"html";L(E.target)[t](e).each(l,arguments)})}else E.success&&a.push(E.success);if(E.success=function(e,t,n){for(var r=E.context||this,i=0,o=a.length;i<o;i++)a[i].apply(r,[e,t,n||A,A])},E.error){var u=E.error;E.error=function(e,t,n){var r=E.context||this;u.apply(r,[e,t,n,A])}}if(E.complete){var c=E.complete;E.complete=function(e,t){var n=E.context||this;c.apply(n,[e,t,A])}}var d=0<L("input[type=file]:enabled",this).filter(function(){return""!==L(this).val()}).length,h="multipart/form-data",f=A.attr("enctype")==h||A.attr("encoding")==h,p=b.fileapi&&b.formdata;V("fileAPI :"+p);var m,g=(d||f)&&!p;!1!==E.iframe&&(E.iframe||g)?E.closeKeepAlive?L.get(E.closeKeepAlive,function(){m=_(o)}):m=_(o):m=(d||f)&&p?function(e){for(var n=new FormData,t=0;t<e.length;t++)n.append(e[t].name,e[t].value);if(E.extraData){var r=function(e){var t,n,r=L.param(e,E.traditional).split("&"),i=r.length,o=[];for(t=0;t<i;t++)r[t]=r[t].replace(/\+/g," "),n=r[t].split("="),o.push([decodeURIComponent(n[0]),decodeURIComponent(n[1])]);return o}(E.extraData);for(t=0;t<r.length;t++)r[t]&&n.append(r[t][0],r[t][1])}E.data=null;var i=L.extend(!0,{},L.ajaxSettings,E,{contentType:!1,processData:!1,cache:!1,type:M||"POST"});E.uploadProgress&&(i.xhr=function(){var e=L.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",function(e){var t=0,n=e.loaded||e.position,r=e.total;e.lengthComputable&&(t=Math.ceil(n/r*100)),E.uploadProgress(e,n,r,t)},!1),e});i.data=null;var o=i.beforeSend;return i.beforeSend=function(e,t){E.formData?t.data=E.formData:t.data=n,o&&o.call(this,e,t)},L.ajax(i)}(o):L.ajax(E),A.removeData("jqxhr").data("jqxhr",m);for(var v=0;v<P.length;v++)P[v]=null;return this.trigger("form-submit-notify",[this,E]),this;function _(e){var t,n,c,d,i,h,f,p,r,o,m,g,s=A[0],v=L.Deferred();if(v.abort=function(e){p.abort(e)},e)for(n=0;n<P.length;n++)t=L(P[n]),I?t.prop("disabled",!1):t.removeAttr("disabled");if((c=L.extend(!0,{},L.ajaxSettings,E)).context=c.context||c,i="jqFormIO"+(new Date).getTime(),c.iframeTarget?(o=(h=L(c.iframeTarget)).attr2("name"))?i=o:h.attr2("name",i):(h=L('<iframe name="'+i+'" src="'+c.iframeSrc+'" />')).css({position:"absolute",top:"-1000px",left:"-1000px"}),f=h[0],p={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(e){var t="timeout"===e?"timeout":"aborted";V("aborting upload... "+t),this.aborted=1;try{f.contentWindow.document.execCommand&&f.contentWindow.document.execCommand("Stop")}catch(e){}h.attr("src",c.iframeSrc),p.error=t,c.error&&c.error.call(c.context,p,t,e),d&&L.event.trigger("ajaxError",[p,c,t]),c.complete&&c.complete.call(c.context,p,t)}},(d=c.global)&&0==L.active++&&L.event.trigger("ajaxStart"),d&&L.event.trigger("ajaxSend",[p,c]),c.beforeSend&&!1===c.beforeSend.call(c.context,p,c))return c.global&&L.active--,v.reject(),v;if(p.aborted)return v.reject(),v;(r=s.clk)&&(o=r.name)&&!r.disabled&&(c.extraData=c.extraData||{},c.extraData[o]=r.value,"image"==r.type&&(c.extraData[o+".x"]=s.clk_x,c.extraData[o+".y"]=s.clk_y));var _=1,b=2;function y(t){var n=null;try{t.contentWindow&&(n=t.contentWindow.document)}catch(e){V("cannot get iframe.contentWindow document: "+e)}if(n)return n;try{n=t.contentDocument?t.contentDocument:t.document}catch(e){V("cannot get iframe.contentDocument: "+e),n=t.document}return n}var a=L("meta[name=csrf-token]").attr("content"),l=L("meta[name=csrf-param]").attr("content");function u(){var e=A.attr2("target"),t=A.attr2("action");s.setAttribute("target",i),M&&!/post/i.test(M)||s.setAttribute("method","POST"),t!=c.url&&s.setAttribute("action",c.url),c.skipEncodingOverride||M&&!/post/i.test(M)||A.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),c.timeout&&(g=setTimeout(function(){m=!0,F(_)},c.timeout));var n=[];try{if(c.extraData)for(var r in c.extraData)c.extraData.hasOwnProperty(r)&&(L.isPlainObject(c.extraData[r])&&c.extraData[r].hasOwnProperty("name")&&c.extraData[r].hasOwnProperty("value")?n.push(L('<input type="hidden" name="'+c.extraData[r].name+'">').val(c.extraData[r].value).appendTo(s)[0]):n.push(L('<input type="hidden" name="'+r+'">').val(c.extraData[r]).appendTo(s)[0]));c.iframeTarget||h.appendTo("body"),f.attachEvent?f.attachEvent("onload",F):f.addEventListener("load",F,!1),setTimeout(function e(){try{var t=y(f).readyState;V("state = "+t),t&&"uninitialized"==t.toLowerCase()&&setTimeout(e,50)}catch(e){V("Server abort: ",e," (",e.name,")"),F(b),g&&clearTimeout(g),g=void 0}},15);try{s.submit()}catch(e){document.createElement("form").submit.apply(s)}}finally{s.setAttribute("action",t),e?s.setAttribute("target",e):A.removeAttr("target"),L(n).remove()}}l&&a&&(c.extraData=c.extraData||{},c.extraData[l]=a),c.forceSync?u():setTimeout(u,10);var x,R,w,S=50;function F(e){if(!p.aborted&&!w){if((R=y(f))||(V("cannot access response document"),e=b),e===_&&p)return p.abort("timeout"),void v.reject(p,"timeout");if(e==b&&p)return p.abort("server abort"),void v.reject(p,"error","server abort");if(R&&R.location.href!=c.iframeSrc||m){f.detachEvent?f.detachEvent("onload",F):f.removeEventListener("load",F,!1);var t,n="success";try{if(m)throw"timeout";var r="xml"==c.dataType||R.XMLDocument||L.isXMLDoc(R);if(V("isXml="+r),!r&&j.opera&&(null===R.body||!R.body.innerHTML)&&--S)return V("requeing onLoad callback, DOM not available"),void setTimeout(F,250);var i=R.body?R.body:R.documentElement;p.responseText=i?i.innerHTML:null,p.responseXML=R.XMLDocument?R.XMLDocument:R,r&&(c.dataType="xml"),p.getResponseHeader=function(e){return{"content-type":c.dataType}[e.toLowerCase()]},i&&(p.status=Number(i.getAttribute("status"))||p.status,p.statusText=i.getAttribute("statusText")||p.statusText);var o=(c.dataType||"").toLowerCase(),s=/(json|script|text)/.test(o);if(s||c.textarea){var a=R.getElementsByTagName("textarea")[0];if(a)p.responseText=a.value,p.status=Number(a.getAttribute("status"))||p.status,p.statusText=a.getAttribute("statusText")||p.statusText;else if(s){var l=R.getElementsByTagName("pre")[0],u=R.getElementsByTagName("body")[0];l?p.responseText=l.textContent?l.textContent:l.innerText:u&&(p.responseText=u.textContent?u.textContent:u.innerText)}}else"xml"==o&&!p.responseXML&&p.responseText&&(p.responseXML=T(p.responseText));try{x=C(p,o,c)}catch(e){n="parsererror",p.error=t=e||n}}catch(e){V("error caught: ",e),n="error",p.error=t=e||n}p.aborted&&(V("upload aborted"),n=null),p.status&&(n=200<=p.status&&p.status<300||304===p.status?"success":"error"),"success"===n?(c.success&&c.success.call(c.context,x,"success",p),v.resolve(p.responseText,"success",p),d&&L.event.trigger("ajaxSuccess",[p,c])):n&&(void 0===t&&(t=p.statusText),c.error&&c.error.call(c.context,p,n,t),v.reject(p,"error",t),d&&L.event.trigger("ajaxError",[p,c,t])),d&&L.event.trigger("ajaxComplete",[p,c]),d&&!--L.active&&L.event.trigger("ajaxStop"),c.complete&&c.complete.call(c.context,p,n),w=!0,c.timeout&&clearTimeout(g),setTimeout(function(){c.iframeTarget?h.attr("src",c.iframeSrc):h.remove(),p.responseXML=null},100)}}}var T=L.parseXML||function(e,t){return j.ActiveXObject?((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&"parsererror"!=t.documentElement.nodeName?t:null},k=L.parseJSON||function(e){return j.eval("("+e+")")},C=function(e,t,n){var r=e.getResponseHeader("content-type")||"",i="xml"===t||!t&&0<=r.indexOf("xml"),o=i?e.responseXML:e.responseText;return i&&"parsererror"===o.documentElement.nodeName&&L.error&&L.error("parsererror"),n&&n.dataFilter&&(o=n.dataFilter(o,t)),"string"==typeof o&&("json"===t||!t&&0<=r.indexOf("json")?o=k(o):("script"===t||!t&&0<=r.indexOf("javascript"))&&L.globalEval(o)),o};return v}},L.fn.ajaxForm=function(e){if((e=e||{}).delegation=e.delegation&&L.isFunction(L.fn.on),e.delegation||0!==this.length)return e.delegation?(L(document).off("submit.form-plugin",this.selector,n).off("click.form-plugin",this.selector,r).on("submit.form-plugin",this.selector,e,n).on("click.form-plugin",this.selector,e,r),this):this.ajaxFormUnbind().bind("submit.form-plugin",e,n).bind("click.form-plugin",e,r);var t={s:this.selector,c:this.context};return!L.isReady&&t.s?(V("DOM not ready, queuing ajaxForm"),L(function(){L(t.s,t.c).ajaxForm(e)})):V("terminating; zero elements found by selector"+(L.isReady?"":" (DOM not ready)")),this},L.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},L.fn.formToArray=function(e,t){var n=[];if(0===this.length)return n;var r,i,o,s,a,l,u,c=this[0],d=e?c.getElementsByTagName("*"):c.elements;if(!d)return n;for(r=0,l=d.length;r<l;r++)if((o=(a=d[r]).name)&&!a.disabled)if(e&&c.clk&&"image"==a.type)c.clk==a&&(n.push({name:o,value:L(a).val(),type:a.type}),n.push({name:o+".x",value:c.clk_x},{name:o+".y",value:c.clk_y}));else if((s=L.fieldValue(a,!0))&&s.constructor==Array)for(t&&t.push(a),i=0,u=s.length;i<u;i++)n.push({name:o,value:s[i]});else if(b.fileapi&&"file"==a.type){t&&t.push(a);var h=a.files;if(h.length)for(i=0;i<h.length;i++)n.push({name:o,value:h[i],type:a.type});else n.push({name:o,value:"",type:a.type})}else null!=s&&(t&&t.push(a),n.push({name:o,value:s,type:a.type,required:a.required}));if(!e&&c.clk){var f=L(c.clk),p=f[0];(o=p.name)&&!p.disabled&&"image"==p.type&&(n.push({name:o,value:f.val()}),n.push({name:o+".x",value:c.clk_x},{name:o+".y",value:c.clk_y}))}return n},L.fn.formSerialize=function(e){return L.param(this.formToArray(e))},L.fn.fieldSerialize=function(i){var o=[];return this.each(function(){var e=this.name;if(e){var t=L.fieldValue(this,i);if(t&&t.constructor==Array)for(var n=0,r=t.length;n<r;n++)o.push({name:e,value:t[n]});else null!=t&&o.push({name:this.name,value:t})}}),L.param(o)},L.fn.fieldValue=function(e){for(var t=[],n=0,r=this.length;n<r;n++){var i=this[n],o=L.fieldValue(i,e);null==o||o.constructor==Array&&!o.length||(o.constructor==Array?L.merge(t,o):t.push(o))}return t},L.fieldValue=function(e,t){var n=e.name,r=e.type,i=e.tagName.toLowerCase();if(void 0===t&&(t=!0),t&&(!n||e.disabled||"reset"==r||"button"==r||("checkbox"==r||"radio"==r)&&!e.checked||("submit"==r||"image"==r)&&e.form&&e.form.clk!=e||"select"==i&&-1==e.selectedIndex))return null;if("select"!=i)return L(e).val();var o=e.selectedIndex;if(o<0)return null;for(var s=[],a=e.options,l="select-one"==r,u=l?o+1:a.length,c=l?o:0;c<u;c++){var d=a[c];if(d.selected){var h=d.value;if(h||(h=d.attributes&&d.attributes.value&&!d.attributes.value.specified?d.text:d.value),l)return h;s.push(h)}}return s},L.fn.clearForm=function(e){return this.each(function(){L("input,select,textarea",this).clearFields(e)})},L.fn.clearFields=L.fn.clearInputs=function(n){var r=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var e=this.type,t=this.tagName.toLowerCase();r.test(e)||"textarea"==t?this.value="":"checkbox"==e||"radio"==e?this.checked=!1:"select"==t?this.selectedIndex=-1:"file"==e?/MSIE/.test(navigator.userAgent)?L(this).replaceWith(L(this).clone(!0)):L(this).val(""):n&&(!0===n&&/hidden/.test(e)||"string"==typeof n&&L(this).is(n))&&(this.value="")})},L.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},L.fn.enable=function(e){return void 0===e&&(e=!0),this.each(function(){this.disabled=!e})},L.fn.selected=function(n){return void 0===n&&(n=!0),this.each(function(){var e=this.type;if("checkbox"==e||"radio"==e)this.checked=n;else if("option"==this.tagName.toLowerCase()){var t=L(this).parent("select");n&&t[0]&&"select-one"==t[0].type&&t.find("option").selected(!1),this.selected=n}})},L.fn.ajaxSubmit.debug=!1},"function"==typeof define&&define.amd?define(["jquery"],e):e("undefined"!=typeof jQuery?jQuery:j.Zepto);var l,r,t,i=[].slice;l=j.jQuery,r=function(){function e(e,t){var n,r,i;this.$input=e,this.options=l.extend({},this.defaults,t,this.$input.data("ifu-options")),n=this.$input.closest("form"),(r=this.options).action||(r.action=n.attr("action")),(i=this.options).method||(i.method=n.find("[name=_method]").val()||n.attr("method")),this._bindInputChange()}return e.prototype.defaults={name:"file",action:void 0,method:void 0,additionalParams:{},ajaxOpts:{}},e.prototype._baseParams=function(){return l.extend({inline_file_upload:!0},this.options.additionalParams)},e.prototype._ajaxUpload=function(){var r,i,o,s,a;return(r=this._createTemporaryForm()).ajaxSubmit(l.extend({dataType:"json",data:this._baseParams(),uploadProgress:(a=this,function(e,t,n,r){var i,o;return o={percent:r},"function"==typeof(i=a.options).progress&&i.progress(o),a.$input.trigger("inline_file_upload:progress",o)}),success:(s=this,function(e){var t,n;return n={data:e},"function"==typeof(t=s.options).success&&t.success(n),s.$input.trigger("inline_file_upload:success",n)}),error:(o=this,function(e){var t,n;return n={xhr:e},"function"==typeof(t=o.options).error&&t.error(n),o.$input.trigger("inline_file_upload:error",n)}),complete:(i=this,function(e){var t,n;return r.remove(),n={xhr:e},"function"==typeof(t=i.options).complete&&t.complete(n),i.$input.trigger("inline_file_upload:complete",n)})},this.options.ajaxOpts))},e.prototype._createTemporaryForm=function(){var e,t;return t=l("<form action='"+this.options.action+"' method='post' style='position:fixed;left:-9999px;'>\n  <input type='hidden' name='_method' value='"+this.options.method+"' />\n</form>"),e=this.$input,this.$input=e.clone().val("").insertBefore(e),this._bindInputChange(),e.appendTo(t),e.attr("name",this.options.name),t.insertBefore(this.$input),t},e.prototype._eventToFilename=function(e){return null!=e.target.files?e.target.files[0].name:e.target.value?e.target.value.replace(/^.+\\/,""):void 0},e.prototype._onChange=function(e){var t,n;if(this.$input.val())return n={filename:this._eventToFilename(e)},"function"==typeof(t=this.options).start&&t.start(n),this.$input.trigger("inline_file_upload:start",n),this._ajaxUpload()},e.prototype._bindInputChange=function(){return this.$input.on("change",l.proxy(this._onChange,this))},e}(),l.fn.extend({inlineFileUpload:function(){var t,n;return n=arguments[0],t=2<=arguments.length?i.call(arguments,1):[],this.each(function(){var e;if((e=l(this).data("inline-file-upload"))||l(this).data("inline-file-upload",e=new r(l(this),n)),"string"==typeof n)return e[n].apply(e,t)})}}),function(e){var t=!1;if("function"==typeof define&&define.amd&&(define(e),t=!0),"object"==typeof exports&&(module.exports=e(),t=!0),!t){var n=j.Cookies,r=j.Cookies=e();r.noConflict=function(){return j.Cookies=n,r}}}(function(){function f(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}return function e(d){function h(e,t,n){var r;if("undefined"!=typeof document){if(1<arguments.length){if("number"==typeof(n=f({path:"/"},h.defaults,n)).expires){var i=new Date;i.setMilliseconds(i.getMilliseconds()+864e5*n.expires),n.expires=i}try{r=JSON.stringify(t),/^[\{\[]/.test(r)&&(t=r)}catch(e){}return t=d.write?d.write(t,e):encodeURIComponent(String(t)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=(e=(e=encodeURIComponent(String(e))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape),document.cookie=[e,"=",t,n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}e||(r={});for(var o=document.cookie?document.cookie.split("; "):[],s=/(%[0-9A-Z]{2})+/g,a=0;a<o.length;a++){var l=o[a].split("="),u=l.slice(1).join("=");'"'===u.charAt(0)&&(u=u.slice(1,-1));try{var c=l[0].replace(s,decodeURIComponent);if(u=d.read?d.read(u,c):d(u,c)||u.replace(s,decodeURIComponent),this.json)try{u=JSON.parse(u)}catch(e){}if(e===c){r=u;break}e||(r[c]=u)}catch(e){}}return r}}return(h.set=h).get=function(e){return h.call(h,e)},h.getJSON=function(){return h.apply({json:!0},[].slice.call(arguments))},h.defaults={},h.remove=function(e,t){h(e,"",f(t,{expires:-1}))},h.withConverter=e,h}(function(){})}),function(){var e=this,t=e._,s={},i=Array.prototype,n=Object.prototype,r=Function.prototype,o=i.push,a=i.slice,l=i.concat,d=n.toString,u=n.hasOwnProperty,c=i.forEach,h=i.map,f=i.reduce,p=i.reduceRight,m=i.filter,g=i.every,v=i.some,_=i.indexOf,b=i.lastIndexOf,y=Array.isArray,x=Object.keys,R=r.bind,w=function(e){return e instanceof w?e:this instanceof w?void(this._wrapped=e):new w(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=w),exports._=w):e._=w,w.VERSION="1.6.0";var S=w.each=w.forEach=function(e,t,n){if(null==e)return e;if(c&&e.forEach===c)e.forEach(t,n);else if(e.length===+e.length){for(var r=0,i=e.length;r<i;r++)if(t.call(n,e[r],r,e)===s)return}else{var o=w.keys(e);for(r=0,i=o.length;r<i;r++)if(t.call(n,e[o[r]],o[r],e)===s)return}return e};w.map=w.collect=function(e,r,i){var o=[];return null==e?o:h&&e.map===h?e.map(r,i):(S(e,function(e,t,n){o.push(r.call(i,e,t,n))}),o)};var F="Reduce of empty array with no initial value";w.reduce=w.foldl=w.inject=function(e,r,i,o){var s=2<arguments.length;if(null==e&&(e=[]),f&&e.reduce===f)return o&&(r=w.bind(r,o)),s?e.reduce(r,i):e.reduce(r);if(S(e,function(e,t,n){s?i=r.call(o,i,e,t,n):(i=e,s=!0)}),!s)throw new TypeError(F);return i},w.reduceRight=w.foldr=function(r,i,o,s){var a=2<arguments.length;if(null==r&&(r=[]),p&&r.reduceRight===p)return s&&(i=w.bind(i,s)),a?r.reduceRight(i,o):r.reduceRight(i);var l=r.length;if(l!==+l){var u=w.keys(r);l=u.length}if(S(r,function(e,t,n){t=u?u[--l]:--l,a?o=i.call(s,o,r[t],t,n):(o=r[t],a=!0)}),!a)throw new TypeError(F);return o},w.find=w.detect=function(e,r,i){var o;return T(e,function(e,t,n){if(r.call(i,e,t,n))return o=e,!0}),o},w.filter=w.select=function(e,r,i){var o=[];return null==e?o:m&&e.filter===m?e.filter(r,i):(S(e,function(e,t,n){r.call(i,e,t,n)&&o.push(e)}),o)},w.reject=function(e,r,i){return w.filter(e,function(e,t,n){return!r.call(i,e,t,n)},i)},w.every=w.all=function(e,r,i){r||(r=w.identity);var o=!0;return null==e?o:g&&e.every===g?e.every(r,i):(S(e,function(e,t,n){if(!(o=o&&r.call(i,e,t,n)))return s}),!!o)};var T=w.some=w.any=function(e,r,i){r||(r=w.identity);var o=!1;return null==e?o:v&&e.some===v?e.some(r,i):(S(e,function(e,t,n){if(o||(o=r.call(i,e,t,n)))return s}),!!o)};w.contains=w.include=function(e,t){return null!=e&&(_&&e.indexOf===_?-1!=e.indexOf(t):T(e,function(e){return e===t}))},w.invoke=function(e,t){var n=a.call(arguments,2),r=w.isFunction(t);return w.map(e,function(e){return(r?t:e[t]).apply(e,n)})},w.pluck=function(e,t){return w.map(e,w.property(t))},w.where=function(e,t){return w.filter(e,w.matches(t))},w.findWhere=function(e,t){return w.find(e,w.matches(t))},w.max=function(e,i,o){if(!i&&w.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);var s=-1/0,a=-1/0;return S(e,function(e,t,n){var r=i?i.call(o,e,t,n):e;a<r&&(s=e,a=r)}),s},w.min=function(e,i,o){if(!i&&w.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);var s=1/0,a=1/0;return S(e,function(e,t,n){var r=i?i.call(o,e,t,n):e;r<a&&(s=e,a=r)}),s},w.shuffle=function(e){var t,n=0,r=[];return S(e,function(e){t=w.random(n++),r[n-1]=r[t],r[t]=e}),r},w.sample=function(e,t,n){return null==t||n?(e.length!==+e.length&&(e=w.values(e)),e[w.random(e.length-1)]):w.shuffle(e).slice(0,Math.max(0,t))};var k=function(e){return null==e?w.identity:w.isFunction(e)?e:w.property(e)};w.sortBy=function(e,r,i){return r=k(r),w.pluck(w.map(e,function(e,t,n){return{value:e,index:t,criteria:r.call(i,e,t,n)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(r<n||void 0===n)return 1;if(n<r||void 0===r)return-1}return e.index-t.index}),"value")};var C=function(a){return function(r,i,o){var s={};return i=k(i),S(r,function(e,t){var n=i.call(o,e,t,r);a(s,n,e)}),s}};w.groupBy=C(function(e,t,n){w.has(e,t)?e[t].push(n):e[t]=[n]}),w.indexBy=C(function(e,t,n){e[t]=n}),w.countBy=C(function(e,t){w.has(e,t)?e[t]++:e[t]=1}),w.sortedIndex=function(e,t,n,r){for(var i=(n=k(n)).call(r,t),o=0,s=e.length;o<s;){var a=o+s>>>1;n.call(r,e[a])<i?o=a+1:s=a}return o},w.toArray=function(e){return e?w.isArray(e)?a.call(e):e.length===+e.length?w.map(e,w.identity):w.values(e):[]},w.size=function(e){return null==e?0:e.length===+e.length?e.length:w.keys(e).length},w.first=w.head=w.take=function(e,t,n){if(null!=e)return null==t||n?e[0]:t<0?[]:a.call(e,0,t)},w.initial=function(e,t,n){return a.call(e,0,e.length-(null==t||n?1:t))},w.last=function(e,t,n){if(null!=e)return null==t||n?e[e.length-1]:a.call(e,Math.max(e.length-t,0))},w.rest=w.tail=w.drop=function(e,t,n){return a.call(e,null==t||n?1:t)},w.compact=function(e){return w.filter(e,w.identity)};var E=function(e,t,n){return t&&w.every(e,w.isArray)?l.apply(n,e):(S(e,function(e){w.isArray(e)||w.isArguments(e)?t?o.apply(n,e):E(e,t,n):n.push(e)}),n)};w.flatten=function(e,t){return E(e,t,[])},w.without=function(e){return w.difference(e,a.call(arguments,1))},w.partition=function(e,t){var n=[],r=[];return S(e,function(e){(t(e)?n:r).push(e)}),[n,r]},w.uniq=w.unique=function(n,r,e,t){w.isFunction(r)&&(t=e,e=r,r=!1);var i=e?w.map(n,e,t):n,o=[],s=[];return S(i,function(e,t){(r?t&&s[s.length-1]===e:w.contains(s,e))||(s.push(e),o.push(n[t]))}),o},w.union=function(){return w.uniq(w.flatten(arguments,!0))},w.intersection=function(e){var n=a.call(arguments,1);return w.filter(w.uniq(e),function(t){return w.every(n,function(e){return w.contains(e,t)})})},w.difference=function(e){var t=l.apply(i,a.call(arguments,1));return w.filter(e,function(e){return!w.contains(t,e)})},w.zip=function(){for(var e=w.max(w.pluck(arguments,"length").concat(0)),t=new Array(e),n=0;n<e;n++)t[n]=w.pluck(arguments,""+n);return t},w.object=function(e,t){if(null==e)return{};for(var n={},r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},w.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return e[r=w.sortedIndex(e,t)]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(_&&e.indexOf===_)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},w.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var i=r?n:e.length;i--;)if(e[i]===t)return i;return-1},w.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=n||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,o=new Array(r);i<r;)o[i++]=e,e+=n;return o};var M=function(){};w.bind=function(n,r){var i,o;if(R&&n.bind===R)return R.apply(n,a.call(arguments,1));if(!w.isFunction(n))throw new TypeError;return i=a.call(arguments,2),o=function(){if(!(this instanceof o))return n.apply(r,i.concat(a.call(arguments)));M.prototype=n.prototype;var e=new M;M.prototype=null;var t=n.apply(e,i.concat(a.call(arguments)));return Object(t)===t?t:e}},w.partial=function(i){var o=a.call(arguments,1);return function(){for(var e=0,t=o.slice(),n=0,r=t.length;n<r;n++)t[n]===w&&(t[n]=arguments[e++]);for(;e<arguments.length;)t.push(arguments[e++]);return i.apply(this,t)}},w.bindAll=function(t){var e=a.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return S(e,function(e){t[e]=w.bind(t[e],t)}),t},w.memoize=function(t,n){var r={};return n||(n=w.identity),function(){var e=n.apply(this,arguments);return w.has(r,e)?r[e]:r[e]=t.apply(this,arguments)}},w.delay=function(e,t){var n=a.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},w.defer=function(e){return w.delay.apply(w,[e,1].concat(a.call(arguments,1)))},w.throttle=function(n,r,i){var o,s,a,l=null,u=0;i||(i={});var c=function(){u=!1===i.leading?0:w.now(),l=null,a=n.apply(o,s),o=s=null};return function(){var e=w.now();u||!1!==i.leading||(u=e);var t=r-(e-u);return o=this,s=arguments,t<=0?(clearTimeout(l),l=null,u=e,a=n.apply(o,s),o=s=null):l||!1===i.trailing||(l=setTimeout(c,t)),a}},w.debounce=function(t,n,r){var i,o,s,a,l,u=function(){var e=w.now()-a;e<n?i=setTimeout(u,n-e):(i=null,r||(l=t.apply(s,o),s=o=null))};return function(){s=this,o=arguments,a=w.now();var e=r&&!i;return i||(i=setTimeout(u,n)),e&&(l=t.apply(s,o),s=o=null),l}},w.once=function(e){var t,n=!1;return function(){return n||(n=!0,t=e.apply(this,arguments),e=null),t}},w.wrap=function(e,t){return w.partial(t,e)},w.compose=function(){var n=arguments;return function(){for(var e=arguments,t=n.length-1;0<=t;t--)e=[n[t].apply(this,e)];return e[0]}},w.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},w.keys=function(e){if(!w.isObject(e))return[];if(x)return x(e);var t=[];for(var n in e)w.has(e,n)&&t.push(n);return t},w.values=function(e){for(var t=w.keys(e),n=t.length,r=new Array(n),i=0;i<n;i++)r[i]=e[t[i]];return r},w.pairs=function(e){for(var t=w.keys(e),n=t.length,r=new Array(n),i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},w.invert=function(e){for(var t={},n=w.keys(e),r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t},w.functions=w.methods=function(e){var t=[];for(var n in e)w.isFunction(e[n])&&t.push(n);return t.sort()},w.extend=function(n){return S(a.call(arguments,1),function(e){if(e)for(var t in e)n[t]=e[t]}),n},w.pick=function(t){var n={},e=l.apply(i,a.call(arguments,1));return S(e,function(e){e in t&&(n[e]=t[e])}),n},w.omit=function(e){var t={},n=l.apply(i,a.call(arguments,1));for(var r in e)w.contains(n,r)||(t[r]=e[r]);return t},w.defaults=function(n){return S(a.call(arguments,1),function(e){if(e)for(var t in e)void 0===n[t]&&(n[t]=e[t])}),n},w.clone=function(e){return w.isObject(e)?w.isArray(e)?e.slice():w.extend({},e):e},w.tap=function(e,t){return t(e),e};var A=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof w&&(e=e._wrapped),t instanceof w&&(t=t._wrapped);var i=d.call(e);if(i!=d.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=n.length;o--;)if(n[o]==e)return r[o]==t;var s=e.constructor,a=t.constructor;if(s!==a&&!(w.isFunction(s)&&s instanceof s&&w.isFunction(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1;n.push(e),r.push(t);var l=0,u=!0;if("[object Array]"==i){if(u=(l=e.length)==t.length)for(;l--&&(u=A(e[l],t[l],n,r)););}else{for(var c in e)if(w.has(e,c)&&(l++,!(u=w.has(t,c)&&A(e[c],t[c],n,r))))break;if(u){for(c in t)if(w.has(t,c)&&!l--)break;u=!l}}return n.pop(),r.pop(),u};w.isEqual=function(e,t){return A(e,t,[],[])},w.isEmpty=function(e){if(null==e)return!0;if(w.isArray(e)||w.isString(e))return 0===e.length;for(var t in e)if(w.has(e,t))return!1;return!0},w.isElement=function(e){return!(!e||1!==e.nodeType)},w.isArray=y||function(e){return"[object Array]"==d.call(e)},w.isObject=function(e){return e===Object(e)},S(["Arguments","Function","String","Number","Date","RegExp"],function(t){w["is"+t]=function(e){return d.call(e)=="[object "+t+"]"}}),w.isArguments(arguments)||(w.isArguments=function(e){return!(!e||!w.has(e,"callee"))}),"function"!=typeof/./&&(w.isFunction=function(e){return"function"==typeof e}),w.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},w.isNaN=function(e){return w.isNumber(e)&&e!=+e},w.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"==d.call(e)},w.isNull=function(e){return null===e},w.isUndefined=function(e){return void 0===e},w.has=function(e,t){return u.call(e,t)},w.noConflict=function(){return e._=t,this},w.identity=function(e){return e},w.constant=function(e){return function(){return e}},w.property=function(t){return function(e){return e[t]}},w.matches=function(n){return function(e){if(e===n)return!0;for(var t in n)if(n[t]!==e[t])return!1;return!0}},w.times=function(e,t,n){for(var r=Array(Math.max(0,e)),i=0;i<e;i++)r[i]=t.call(n,i);return r},w.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},w.now=Date.now||function(){return(new Date).getTime()};var P={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};P.unescape=w.invert(P.escape);var L={escape:new RegExp("["+w.keys(P.escape).join("")+"]","g"),unescape:new RegExp("("+w.keys(P.unescape).join("|")+")","g")};w.each(["escape","unescape"],function(t){w[t]=function(e){return null==e?"":(""+e).replace(L[t],function(e){return P[t][e]})}}),w.result=function(e,t){if(null!=e){var n=e[t];return w.isFunction(n)?n.call(e):n}},w.mixin=function(n){S(w.functions(n),function(e){var t=w[e]=n[e];w.prototype[e]=function(){var e=[this._wrapped];return o.apply(e,arguments),N.call(this,t.apply(w,e))}})};var I=0;w.uniqueId=function(e){var t=++I+"";return e?e+t:t},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var V=/(.)^/,j={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},O=/\\|'|\r|\n|\t|\u2028|\u2029/g;w.template=function(o,e,t){var n;t=w.defaults({},t,w.templateSettings);var r=new RegExp([(t.escape||V).source,(t.interpolate||V).source,(t.evaluate||V).source].join("|")+"|$","g"),s=0,a="__p+='";o.replace(r,function(e,t,n,r,i){return a+=o.slice(s,i).replace(O,function(e){return"\\"+j[e]}),t&&(a+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'"),n&&(a+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),r&&(a+="';\n"+r+"\n__p+='"),s=i+e.length,e}),a+="';\n",t.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{n=new Function(t.variable||"obj","_",a)}catch(e){throw e.source=a,e}if(e)return n(e,w);var i=function(e){return n.call(this,e,w)};return i.source="function("+(t.variable||"obj")+"){\n"+a+"}",i},w.chain=function(e){return w(e).chain()};var N=function(e){return this._chain?w(e).chain():e};w.mixin(w),S(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var n=i[t];w.prototype[t]=function(){var e=this._wrapped;return n.apply(e,arguments),"shift"!=t&&"splice"!=t||0!==e.length||delete e[0],N.call(this,e)}}),S(["concat","join","slice"],function(e){var t=i[e];w.prototype[e]=function(){return N.call(this,t.apply(this._wrapped,arguments))}}),w.extend(w.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return w})}.call(this),function(r,i){if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(e,t,n){r.Backbone=i(r,n,e,t)});else if("undefined"!=typeof exports){var e=require("underscore");i(r,exports,e)}else r.Backbone=i(r,{},r._,r.jQuery||r.Zepto||r.ender||r.$)}(this,function(e,a,R,t){var n=e.Backbone,r=[],i=r.slice;a.VERSION="1.1.2",a.$=t,a.noConflict=function(){return e.Backbone=n,this},a.emulateHTTP=!1,a.emulateJSON=!1;var o=a.Events={on:function(e,t,n){return d(this,"on",e,[t,n])&&t&&(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:n,ctx:n||this})),this},once:function(e,t,n){if(!d(this,"once",e,[t,n])||!t)return this;var r=this,i=R.once(function(){r.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,n)},off:function(e,t,n){var r,i,o,s,a,l,u,c;if(!this._events||!d(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events=void 0,this;for(a=0,l=(s=e?[e]:R.keys(this._events)).length;a<l;a++)if(e=s[a],o=this._events[e]){if(this._events[e]=r=[],t||n)for(u=0,c=o.length;u<c;u++)i=o[u],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=i.call(arguments,1);if(!d(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&s(n,t),r&&s(r,arguments),this},stopListening:function(e,t,n){var r=this._listeningTo;if(!r)return this;var i=!t&&!n;for(var o in n||"object"!=typeof t||(n=this),e&&((r={})[e._listenId]=e),r)(e=r[o]).off(t,n,this),(i||R.isEmpty(e._events))&&delete this._listeningTo[o];return this}},l=/\s+/,d=function(e,t,n,r){if(!n)return!0;if("object"==typeof n){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(l.test(n)){for(var o=n.split(l),s=0,a=o.length;s<a;s++)e[t].apply(e,[o[s]].concat(r));return!1}return!0},s=function(e,t){var n,r=-1,i=e.length,o=t[0],s=t[1],a=t[2];switch(t.length){case 0:for(;++r<i;)(n=e[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=e[r]).callback.call(n.ctx,o);return;case 2:for(;++r<i;)(n=e[r]).callback.call(n.ctx,o,s);return;case 3:for(;++r<i;)(n=e[r]).callback.call(n.ctx,o,s,a);return;default:for(;++r<i;)(n=e[r]).callback.apply(n.ctx,t);return}};R.each({listenTo:"on",listenToOnce:"once"},function(i,e){o[e]=function(e,t,n){var r=this._listeningTo||(this._listeningTo={});return n||"object"!=typeof t||(n=this),(r[e._listenId||(e._listenId=R.uniqueId("l"))]=e)[i](t,n,this),this}}),o.bind=o.on,o.unbind=o.off,R.extend(a,o);var w=a.Model=function(e,t){var n=e||{};t||(t={}),this.cid=R.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{}),n=R.defaults({},n,R.result(this,"defaults")),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};R.extend(w.prototype,o,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return R.clone(this.attributes)},sync:function(){return a.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return R.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var r,i,o,s,a,l,u,c;if(null==e)return this;if("object"==typeof e?(i=e,n=t):(i={})[e]=t,n||(n={}),!this._validate(i,n))return!1;for(r in o=n.unset,a=n.silent,s=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=R.clone(this.attributes),this.changed={}),c=this.attributes,u=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]),i)t=i[r],R.isEqual(c[r],t)||s.push(r),R.isEqual(u[r],t)?delete this.changed[r]:this.changed[r]=t,o?delete c[r]:c[r]=t;if(!a){s.length&&(this._pending=n);for(var d=0,h=s.length;d<h;d++)this.trigger("change:"+s[d],this,c[s[d]],n)}if(l)return this;if(!a)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,R.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,R.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!R.isEmpty(this.changed):R.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&R.clone(this.changed);var t,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var i in e)R.isEqual(r[i],t=e[i])||((n||(n={}))[i]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return R.clone(this._previousAttributes)},fetch:function(t){void 0===(t=t?R.clone(t):{}).parse&&(t.parse=!0);var n=this,r=t.success;return t.success=function(e){if(!n.set(n.parse(e,t),t))return!1;r&&r(n,e,t),n.trigger("sync",n,e,t)},P(this,t),this.sync("read",this,t)},save:function(e,t,n){var r,i,o,s=this.attributes;if(null==e||"object"==typeof e?(r=e,n=t):(r={})[e]=t,n=R.extend({validate:!0},n),r&&!n.wait){if(!this.set(r,n))return!1}else if(!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=R.extend({},s,r)),void 0===n.parse&&(n.parse=!0);var a=this,l=n.success;return n.success=function(e){a.attributes=s;var t=a.parse(e,n);if(n.wait&&(t=R.extend(r||{},t)),R.isObject(t)&&!a.set(t,n))return!1;l&&l(a,e,n),a.trigger("sync",a,e,n)},P(this,n),"patch"===(i=this.isNew()?"create":n.patch?"patch":"update")&&(n.attrs=r),o=this.sync(i,this,n),r&&n.wait&&(this.attributes=s),o},destroy:function(t){t=t?R.clone(t):{};var n=this,r=t.success,i=function(){n.trigger("destroy",n,n.collection,t)};if(t.success=function(e){(t.wait||n.isNew())&&i(),r&&r(n,e,t),n.isNew()||n.trigger("sync",n,e,t)},this.isNew())return t.success(),!1;P(this,t);var e=this.sync("delete",this,t);return t.wait||i(),e},url:function(){var e=R.result(this,"urlRoot")||R.result(this.collection,"url")||A();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},R.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=R.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return!n||(this.trigger("invalid",this,n,R.extend(t,{validationError:n})),!1)}});R.each(["keys","values","pairs","invert","pick","omit"],function(t){w.prototype[t]=function(){var e=i.call(arguments);return e.unshift(this.attributes),R[t].apply(R,e)}});var u=a.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,R.extend({silent:!0},t))},S={add:!0,remove:!0,merge:!0},c={add:!0,remove:!1};R.extend(u.prototype,o,{model:w,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return a.sync.apply(this,arguments)},add:function(e,t){return this.set(e,R.extend({merge:!1},t,c))},remove:function(e,t){var n,r,i,o,s=!R.isArray(e);for(t||(t={}),n=0,r=(e=s?[e]:R.clone(e)).length;n<r;n++)(o=e[n]=this.get(e[n]))&&(delete this._byId[o.id],delete this._byId[o.cid],i=this.indexOf(o),this.models.splice(i,1),this.length--,t.silent||(t.index=i,o.trigger("remove",o,this,t)),this._removeReference(o,t));return s?e[0]:e},set:function(e,t){(t=R.defaults({},t,S)).parse&&(e=this.parse(e,t));var n,r,i,o,s,a,l,u=!R.isArray(e);e=u?e?[e]:[]:R.clone(e);var c=t.at,d=this.model,h=this.comparator&&null==c&&!1!==t.sort,f=R.isString(this.comparator)?this.comparator:null,p=[],m=[],g={},v=t.add,_=t.merge,b=t.remove,y=!(h||!v||!b)&&[];for(n=0,r=e.length;n<r;n++){if(i=(s=e[n]||{})instanceof w?o=s:s[d.prototype.idAttribute||"id"],a=this.get(i))b&&(g[a.cid]=!0),_&&(s=s===o?o.attributes:s,t.parse&&(s=a.parse(s,t)),a.set(s,t),h&&!l&&a.hasChanged(f)&&(l=!0)),e[n]=a;else if(v){if(!(o=e[n]=this._prepareModel(s,t)))continue;p.push(o),this._addReference(o,t)}o=a||o,!y||!o.isNew()&&g[o.id]||y.push(o),g[o.id]=!0}if(b){for(n=0,r=this.length;n<r;++n)g[(o=this.models[n]).cid]||m.push(o);m.length&&this.remove(m,t)}if(p.length||y&&y.length)if(h&&(l=!0),this.length+=p.length,null!=c)for(n=0,r=p.length;n<r;n++)this.models.splice(c+n,0,p[n]);else{y&&(this.models.length=0);var x=y||p;for(n=0,r=x.length;n<r;n++)this.models.push(x[n])}if(l&&this.sort({silent:!0}),!t.silent){for(n=0,r=p.length;n<r;n++)(o=p[n]).trigger("add",o,this,t);(l||y&&y.length)&&this.trigger("sort",this,t)}return u?e[0]:e},reset:function(e,t){t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n],t);return t.previousModels=this.models,this._reset(),e=this.add(e,R.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,R.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,R.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return i.apply(this.models,arguments)},get:function(e){if(null!=e)return this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(n,e){return R.isEmpty(n)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var t in n)if(n[t]!==e.get(t))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),R.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(R.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return R.invoke(this.models,"get",e)},fetch:function(n){void 0===(n=n?R.clone(n):{}).parse&&(n.parse=!0);var r=n.success,i=this;return n.success=function(e){var t=n.reset?"reset":"set";i[t](e,n),r&&r(i,e,n),i.trigger("sync",i,e,n)},P(this,n),this.sync("read",this,n)},create:function(e,n){if(n=n?R.clone(n):{},!(e=this._prepareModel(e,n)))return!1;n.wait||this.add(e,n);var r=this,i=n.success;return n.success=function(e,t){n.wait&&r.add(e,n),i&&i(e,t,n)},e.save(null,n),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof w)return e;var n=new(((t=t?R.clone(t):{}).collection=this).model)(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_addReference:function(e,t){null!=(this._byId[e.cid]=e).id&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});R.each(["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"],function(t){u.prototype[t]=function(){var e=i.call(arguments);return e.unshift(this.models),R[t].apply(R,e)}});R.each(["groupBy","countBy","sortBy","indexBy"],function(r){u.prototype[r]=function(t,e){var n=R.isFunction(t)?t:function(e){return e.get(t)};return R[r](this.models,n,e)}});var h=a.View=function(e){this.cid=R.uniqueId("view"),e||(e={}),R.extend(this,R.pick(e,p)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},f=/^(\S+)\s*(.*)$/,p=["model","collection","el","id","attributes","className","tagName","events"];R.extend(h.prototype,o,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof a.$?e:a.$(e),this.el=this.$el[0],!1!==t&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=R.result(this,"events")))return this;for(var t in this.undelegateEvents(),e){var n=e[t];if(R.isFunction(n)||(n=this[e[t]]),n){var r=t.match(f),i=r[1],o=r[2];n=R.bind(n,this),i+=".delegateEvents"+this.cid,""===o?this.$el.on(i,n):this.$el.on(i,o,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(R.result(this,"el"),!1);else{var e=R.extend({},R.result(this,"attributes"));this.id&&(e.id=R.result(this,"id")),this.className&&(e.class=R.result(this,"className"));var t=a.$("<"+R.result(this,"tagName")+">").attr(e);this.setElement(t,!1)}}}),a.sync=function(e,t,n){var r=g[e];R.defaults(n||(n={}),{emulateHTTP:a.emulateHTTP,emulateJSON:a.emulateJSON});var i={type:r,dataType:"json"};if(n.url||(i.url=R.result(t,"url")||A()),null!=n.data||!t||"create"!==e&&"update"!==e&&"patch"!==e||(i.contentType="application/json",i.data=JSON.stringify(n.attrs||t.toJSON(n))),n.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{}),n.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){i.type="POST",n.emulateJSON&&(i.data._method=r);var o=n.beforeSend;n.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",r),o)return o.apply(this,arguments)}}"GET"===i.type||n.emulateJSON||(i.processData=!1),"PATCH"===i.type&&m&&(i.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var s=n.xhr=a.ajax(R.extend(i,n));return t.trigger("request",t,s,n),s};var m=!(void 0===j||!j.ActiveXObject||j.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),g={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};a.ajax=function(){return a.$.ajax.apply(a.$,arguments)};var v=a.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},_=/\((.*?)\)/g,b=/(\(\?)?:\w+/g,y=/\*\w+/g,x=/[\-{}\[\]+?.,\\\^$|#\s]/g;R.extend(v.prototype,o,{initialize:function(){},route:function(n,r,i){R.isRegExp(n)||(n=this._routeToRegExp(n)),R.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var o=this;return a.history.route(n,function(e){var t=o._extractParameters(n,e);o.execute(i,t),o.trigger.apply(o,["route:"+r].concat(t)),o.trigger("route",r,t),a.history.trigger("route",o,r,t)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,t){return a.history.navigate(e,t),this},_bindRoutes:function(){if(this.routes){this.routes=R.result(this,"routes");for(var e,t=R.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(x,"\\$&").replace(_,"(?:$1)?").replace(b,function(e,t){return t?e:"([^/?]+)"}).replace(y,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return R.map(n,function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null})}});var F=a.History=function(){this.handlers=[],R.bindAll(this,"checkUrl"),void 0!==j&&(this.location=j.location,this.history=j.history)},T=/^[#\/]|\s+$/g,k=/^\/+|\/+$/g,C=/msie [\w.]+/,E=/\/$/,M=/#.*$/;F.started=!1,R.extend(F.prototype,o,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(E,"");e.indexOf(n)||(e=e.slice(n.length))}else e=this.getHash();return e.replace(T,"")},start:function(e){if(F.started)throw new Error("Backbone.history has already been started");F.started=!0,this.options=R.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment(),n=document.documentMode,r=C.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);if(this.root=("/"+this.root+"/").replace(k,"/"),r&&this._wantsHashChange){var i=a.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=i.hide().appendTo("body")[0].contentWindow,this.navigate(t)}this._hasPushState?a.$(j).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in j&&!r?a.$(j).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var o=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&o.hash&&(this.fragment=this.getHash().replace(T,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){a.$(j).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),F.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(t){return t=this.fragment=this.getFragment(t),R.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0})},navigate:function(e,t){if(!F.started)return!1;t&&!0!==t||(t={trigger:!!t});var n=this.root+(e=this.getFragment(e||""));if(e=e.replace(M,""),this.fragment!==e){if(""===(this.fragment=e)&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),a.history=new F;w.extend=u.extend=v.extend=h.extend=F.extend=function(e,t){var n,r=this;n=e&&R.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},R.extend(n,r,t);var i=function(){this.constructor=n};return i.prototype=r.prototype,n.prototype=new i,e&&R.extend(n.prototype,e),n.__super__=r.prototype,n};var A=function(){throw new Error('A "url" property or function must be specified')},P=function(t,n){var r=n.error;n.error=function(e){r&&r(t,e,n),t.trigger("error",t,e,n)}};return a}),function(e,m){"use strict";function r(e,t){var n,r,i=e.toLowerCase();for(t=[].concat(t),n=0;t.length>n;n+=1)if(r=t[n]){if(r.test&&r.test(e))return!0;if(r.toLowerCase()===i)return!0}}var n=m.prototype.trim,i=m.prototype.trimRight,o=m.prototype.trimLeft,s=function(e){return 1*e||0},a=function(e,t){if(t<1)return"";for(var n="";0<t;)1&t&&(n+=e),t>>=1,e+=e;return n},l=[].slice,u=function(e){return null==e?"\\s":e.source?e.source:"["+h.escapeRegExp(e)+"]"},c={lt:"<",gt:">",quot:'"',amp:"&",apos:"'"},t={};for(var d in c)t[c[d]]=d;t["'"]="#39";var g=function(){function f(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}var p=a,e=function(){return e.cache.hasOwnProperty(arguments[0])||(e.cache[arguments[0]]=e.parse(arguments[0])),e.format.call(null,e.cache[arguments[0]],arguments)};return e.format=function(e,t){var n,r,i,o,s,a,l,u=1,c=e.length,d="",h=[];for(r=0;r<c;r++)if("string"===(d=f(e[r])))h.push(e[r]);else if("array"===d){if((o=e[r])[2])for(n=t[u],i=0;o[2].length>i;i++){if(!n.hasOwnProperty(o[2][i]))throw new Error(g('[_.sprintf] property "%s" does not exist',o[2][i]));n=n[o[2][i]]}else n=o[1]?t[o[1]]:t[u++];if(/[^s]/.test(o[8])&&"number"!=f(n))throw new Error(g("[_.sprintf] expecting number but found %s",f(n)));switch(o[8]){case"b":n=n.toString(2);break;case"c":n=m.fromCharCode(n);break;case"d":n=parseInt(n,10);break;case"e":n=o[7]?n.toExponential(o[7]):n.toExponential();break;case"f":n=o[7]?parseFloat(n).toFixed(o[7]):parseFloat(n);break;case"o":n=n.toString(8);break;case"s":n=(n=m(n))&&o[7]?n.substring(0,o[7]):n;break;case"u":n=Math.abs(n);break;case"x":n=n.toString(16);break;case"X":n=n.toString(16).toUpperCase()}n=/[def]/.test(o[8])&&o[3]&&0<=n?"+"+n:n,a=o[4]?"0"==o[4]?"0":o[4].charAt(1):" ",l=o[6]-m(n).length,s=o[6]?p(a,l):"",h.push(o[5]?n+s:s+n)}return h.join("")},e.cache={},e.parse=function(e){for(var t=e,n=[],r=[],i=0;t;){if(null!==(n=/^[^\x25]+/.exec(t)))r.push(n[0]);else if(null!==(n=/^\x25{2}/.exec(t)))r.push("%");else{if(null===(n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw new Error("[_.sprintf] huh?");if(n[2]){i|=1;var o=[],s=n[2],a=[];if(null===(a=/^([a-z_][a-z_\d]*)/i.exec(s)))throw new Error("[_.sprintf] huh?");for(o.push(a[1]);""!==(s=s.substring(a[0].length));)if(null!==(a=/^\.([a-z_][a-z_\d]*)/i.exec(s)))o.push(a[1]);else{if(null===(a=/^\[(\d+)\]/.exec(s)))throw new Error("[_.sprintf] huh?");o.push(a[1])}n[2]=o}else i|=2;if(3===i)throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");r.push(n)}t=t.substring(n[0].length)}return r},e}(),h={VERSION:"2.3.0",isBlank:function(e){return null==e&&(e=""),/^\s*$/.test(e)},stripTags:function(e){return null==e?"":m(e).replace(/<\/?[^>]+>/g,"")},capitalize:function(e){return(e=null==e?"":m(e)).charAt(0).toUpperCase()+e.slice(1)},chop:function(e,t){return null==e?[]:(e=m(e),0<(t=~~t)?e.match(new RegExp(".{1,"+t+"}","g")):[e])},clean:function(e){return h.strip(e).replace(/\s+/g," ")},count:function(e,t){if(null==e||null==t)return 0;e=m(e);for(var n=0,r=0,i=(t=m(t)).length;-1!==(r=e.indexOf(t,r));)n++,r+=i;return n},chars:function(e){return null==e?[]:m(e).split("")},swapCase:function(e){return null==e?"":m(e).replace(/\S/g,function(e){return e===e.toUpperCase()?e.toLowerCase():e.toUpperCase()})},escapeHTML:function(e){return null==e?"":m(e).replace(/[&<>"']/g,function(e){return"&"+t[e]+";"})},unescapeHTML:function(e){return null==e?"":m(e).replace(/\&([^;]+);/g,function(e,t){var n;return t in c?c[t]:(n=t.match(/^#x([\da-fA-F]+)$/))?m.fromCharCode(parseInt(n[1],16)):(n=t.match(/^#(\d+)$/))?m.fromCharCode(~~n[1]):e})},escapeRegExp:function(e){return null==e?"":m(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},splice:function(e,t,n,r){var i=h.chars(e);return i.splice(~~t,~~n,r),i.join("")},insert:function(e,t,n){return h.splice(e,t,0,n)},include:function(e,t){return""===t||null!=e&&-1!==m(e).indexOf(t)},join:function(){var e=l.call(arguments),t=e.shift();return null==t&&(t=""),e.join(t)},lines:function(e){return null==e?[]:m(e).split("\n")},reverse:function(e){return h.chars(e).reverse().join("")},startsWith:function(e,t){return""===t||null!=e&&null!=t&&(e=m(e),t=m(t),e.length>=t.length&&e.slice(0,t.length)===t)},endsWith:function(e,t){return""===t||null!=e&&null!=t&&(e=m(e),t=m(t),e.length>=t.length&&e.slice(e.length-t.length)===t)},succ:function(e){return null==e?"":(e=m(e)).slice(0,-1)+m.fromCharCode(e.charCodeAt(e.length-1)+1)},titleize:function(e){return null==e?"":(e=m(e).toLowerCase()).replace(/(?:^|\s|-)\S/g,function(e){return e.toUpperCase()})},camelize:function(e){return h.trim(e).replace(/[-_\s]+(.)?/g,function(e,t){return t?t.toUpperCase():""})},underscored:function(e){return h.trim(e).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},dasherize:function(e){return h.trim(e).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},classify:function(e){return h.titleize(m(e).replace(/[\W_]/g," ")).replace(/\s/g,"")},humanize:function(e){return h.capitalize(h.underscored(e).replace(/_id$/,"").replace(/_/g," "))},trim:function(e,t){return null==e?"":!t&&n?n.call(e):(t=u(t),m(e).replace(new RegExp("^"+t+"+|"+t+"+$","g"),""))},ltrim:function(e,t){return null==e?"":!t&&o?o.call(e):(t=u(t),m(e).replace(new RegExp("^"+t+"+"),""))},rtrim:function(e,t){return null==e?"":!t&&i?i.call(e):(t=u(t),m(e).replace(new RegExp(t+"+$"),""))},truncate:function(e,t,n){return null==e?"":(n=n||"...",t=~~t,(e=m(e)).length>t?e.slice(0,t)+n:e)},prune:function(e,t,n){if(null==e)return"";if(e=m(e),t=~~t,n=null!=n?m(n):"...",t>=e.length)return e;var r=e.slice(0,t+1).replace(/.(?=\W*\w*$)/g,function(e){return e.toUpperCase()!==e.toLowerCase()?"A":" "});return((r=r.slice(r.length-2).match(/\w\w/)?r.replace(/\s*\S+$/,""):h.rtrim(r.slice(0,r.length-1)))+n).length>e.length?e:e.slice(0,r.length)+n},words:function(e,t){return h.isBlank(e)?[]:h.trim(e,t).split(t||/\s+/)},pad:function(e,t,n,r){e=null==e?"":m(e),t=~~t;var i=0;switch(n?1<n.length&&(n=n.charAt(0)):n=" ",r){case"right":return i=t-e.length,e+a(n,i);case"both":return i=t-e.length,a(n,Math.ceil(i/2))+e+a(n,Math.floor(i/2));default:return i=t-e.length,a(n,i)+e}},lpad:function(e,t,n){return h.pad(e,t,n)},rpad:function(e,t,n){return h.pad(e,t,n,"right")},lrpad:function(e,t,n){return h.pad(e,t,n,"both")},sprintf:g,vsprintf:function(e,t){return t.unshift(e),g.apply(null,t)},toNumber:function(e,t){return e?(e=h.trim(e)).match(/^-?\d+(?:\.\d+)?$/)?s(s(e).toFixed(~~t)):NaN:0},numberFormat:function(e,t,n,r){if(isNaN(e)||null==e)return"";r="string"==typeof r?r:",";var i=(e=e.toFixed(~~t)).split("."),o=i[0],s=i[1]?(n||".")+i[1]:"";return o.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+r)+s},strRight:function(e,t){if(null==e)return"";e=m(e);var n=(t=null!=t?m(t):t)?e.indexOf(t):-1;return~n?e.slice(n+t.length,e.length):e},strRightBack:function(e,t){if(null==e)return"";e=m(e);var n=(t=null!=t?m(t):t)?e.lastIndexOf(t):-1;return~n?e.slice(n+t.length,e.length):e},strLeft:function(e,t){if(null==e)return"";e=m(e);var n=(t=null!=t?m(t):t)?e.indexOf(t):-1;return~n?e.slice(0,n):e},strLeftBack:function(e,t){if(null==e)return"";var n=(e+="").lastIndexOf(t=null!=t?""+t:t);return~n?e.slice(0,n):e},toSentence:function(e,t,n,r){t=t||", ",n=n||" and ";var i=e.slice(),o=i.pop();return 2<e.length&&r&&(n=h.rtrim(t)+n),i.length?i.join(t)+n+o:o},toSentenceSerial:function(){var e=l.call(arguments);return e[3]=!0,h.toSentence.apply(h,e)},slugify:function(e){if(null==e)return"";var n="ąàáäâãåæăćęèéëêìíïîłńòóöôõøśșțùúüûñçżź",t=new RegExp(u(n),"g");return e=m(e).toLowerCase().replace(t,function(e){var t=n.indexOf(e);return"aaaaaaaaaceeeeeiiiilnoooooosstuuuunczz".charAt(t)||"-"}),h.dasherize(e.replace(/[^\w\s-]/g,""))},surround:function(e,t){return[t,e,t].join("")},quote:function(e,t){return h.surround(e,t||'"')},unquote:function(e,t){return t=t||'"',e[0]===t&&e[e.length-1]===t?e.slice(1,e.length-1):e},exports:function(){var e={};for(var t in this)this.hasOwnProperty(t)&&!t.match(/^(?:include|contains|reverse)$/)&&(e[t]=this[t]);return e},repeat:function(e,t,n){if(null==e)return"";if(t=~~t,null==n)return a(m(e),t);for(var r=[];0<t;r[--t]=e);return r.join(n)},naturalCmp:function(e,t){if(e==t)return 0;if(!e)return-1;if(!t)return 1;for(var n=/(\.\d+)|(\d+)|(\D+)/g,r=m(e).toLowerCase().match(n),i=m(t).toLowerCase().match(n),o=Math.min(r.length,i.length),s=0;s<o;s++){var a=r[s],l=i[s];if(a!==l){var u=parseInt(a,10);if(!isNaN(u)){var c=parseInt(l,10);if(!isNaN(c)&&u-c)return u-c}return a<l?-1:1}}return r.length===i.length?r.length-i.length:e<t?-1:1},levenshtein:function(e,t){if(null==e&&null==t)return 0;if(null==e)return m(t).length;if(null==t)return m(e).length;e=m(e),t=m(t);for(var n,r,i=[],o=0;t.length>=o;o++)for(var s=0;e.length>=s;s++)r=o&&s?e.charAt(s-1)===t.charAt(o-1)?n:Math.min(i[s],i[s-1],n)+1:o+s,n=i[s],i[s]=r;return i.pop()},toBoolean:function(e,t,n){return"number"==typeof e&&(e=""+e),"string"!=typeof e?!!e:!!r(e=h.trim(e),t||["true","1"])||!r(e,n||["false","0"])&&void 0}};h.strip=h.trim,h.lstrip=h.ltrim,h.rstrip=h.rtrim,h.center=h.lrpad,h.rjust=h.lpad,h.ljust=h.rpad,h.contains=h.include,h.q=h.quote,h.toBool=h.toBoolean,"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(module.exports=h),exports._s=h),"function"==typeof define&&define.amd&&define("underscore.string",[],function(){return h}),e._=e._||{},e._.string=e._.str=h}(this,String),function(){var e;e=function(){function e(){}return e.footerText="Are you sure you want to leave this page?",e.defaults={if:function(){return!0},message:"You have unsaved changes."},e.enable=function(e){var t,n;return this.opts={if:e.if||this.defaults.if,message:e.message||this.defaults.message,cb:e.cb},this._onTurbolinksUnload=(t=this,function(e){return t._willPrevent()?t.opts.cb&&!1!==t.opts.cb(e.data.url)?e.preventDefault():confirm(t.opts.message+"\n\n"+t.footerText)?t.disable():e.preventDefault():t.disable()}),document.body.beforeunload=this,j.onbeforeunload=(n=this,function(){return n._willPrevent()?n.opts.message:void 0}),document.addEventListener("page:before-change",this._onTurbolinksUnload,!1)},e.disable=function(){return j.onbeforeunload=null,document.removeEventListener("page:before-change",this._onTurbolinksUnload)},e._willPrevent=function(){return document.body.beforeunload===this&&this.opts.if()},e}(),j.BeforeUnload=e}.call(this),function(){var d,h,i,e,f,n,o=[].slice;i=function(e){var t,r;return!_.isObject(e)||_.isFunction(e)?e:e instanceof Backbone.Collection||e instanceof Backbone.Model?e:_.isDate(e)?new Date(e.getTime()):_.isRegExp(e)?new RegExp(e.source,e.toString().replace(/.*\//,"")):(r=_.isArray(e||_.isArguments(e)),t=function(e,t,n){return r?e.push(i(t)):e[n]=i(t),e},_.reduce(e,t,r?[]:{}))},n=function(e){return null!=e&&((e.prototype==={}.prototype||e.prototype===Object.prototype)&&_.isObject(e)&&!_.isArray(e)&&!_.isFunction(e)&&!_.isDate(e)&&!_.isRegExp(e)&&!_.isArguments(e))},h=function(t){return _.filter(_.keys(t),function(e){return n(t[e])})},d=function(t){return _.filter(_.keys(t),function(e){return _.isArray(t[e])})},f=function(t,n,r){var e,i,o,s,a,l,u,c;if(null==r&&(r=20),r<=0)return console.warn("_.deepExtend(): Maximum depth of recursion hit."),_.extend(t,n);for(i=function(e){return n[e]=f(t[e],n[e],r-1)},a=0,u=(s=_.intersection(h(t),h(n))).length;a<u;a++)i(s[a]);for(e=function(e){return n[e]=_.union(t[e],n[e])},l=0,c=(o=_.intersection(d(t),d(n))).length;l<c;l++)e(o[l]);return _.extend(t,n)},e=function(){var e,t,n,r;if(n=2<=arguments.length?o.call(arguments,0,r=arguments.length-1):(r=0,[]),t=arguments[r++],_.isNumber(t)||(n.push(t),t=20),n.length<=1)return n[0];if(t<=0)return _.extend.apply(this,n);for(e=n.shift();0<n.length;)e=f(e,i(n.shift()),t);return e},_.mixin({deepClone:i,isBasicObject:n,basicObjects:h,arrays:d,deepExtend:e})}.call(this),t=function(_,e){function b(e){var t={},n=w.keyPathSeparator;for(var r in e){var i=e[r];if(i&&i.constructor===Object&&!_.isEmpty(i)){var o=b(i);for(var s in o){var a=o[s];t[r+n+s]=a}}else t[r]=i}return t}function y(e,t,n){for(var r=w.keyPathSeparator,i=t.split(r),o=e,s=0,a=i.length;s<a;s++){if(n&&!_.has(o,i[s]))return!1;if(null==(o=o[i[s]])&&s<a-1&&(o={}),void 0===o)return!!n||o}return!!n||o}function x(e,t,n,r){r=r||{};for(var i=w.keyPathSeparator,o=t.split(i),s=e,a=0,l=o.length;a<l&&void 0!==s;a++){var u=o[a];a===l-1?r.unset?delete s[u]:s[u]=n:(void 0!==s[u]&&_.isObject(s[u])||(s[u]={}),s=s[u])}}function R(e,t){x(e,t,null,{unset:!0})}var w=e.Model.extend({constructor:function(e,t){var n,r=e||{};this.cid=_.uniqueId("c"),this.attributes={},t&&t.collection&&(this.collection=t.collection),t&&t.parse&&(r=this.parse(r,t)||{}),(n=_.result(this,"defaults"))&&(r=_.deepExtend({},n,r)),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)},toJSON:function(e){return _.deepClone(this.attributes)},get:function(e){return y(this.attributes,e)},set:function(e,t,n){var r,i,o,s,a,l,u,c;if(null==e)return this;if("object"==typeof e?(i=e,n=t||{}):(i={})[e]=t,n||(n={}),!this._validate(i,n))return!1;for(r in o=n.unset,a=n.silent,s=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=_.deepClone(this.attributes),this.changed={}),c=this.attributes,u=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]),i=b(i))t=i[r],_.isEqual(y(c,r),t)||s.push(r),_.isEqual(y(u,r),t)?R(this.changed,r):x(this.changed,r,t),o?R(c,r):x(c,r,t);if(!a){s.length&&(this._pending=!0);for(var d=w.keyPathSeparator,h=0,f=s.length;h<f;h++){e=s[h];this.trigger("change:"+e,this,y(c,e),n);for(var p=e.split(d),m=p.length-1;0<m;m--){var g=_.first(p,m).join(d),v=g+d+"*";this.trigger("change:"+v,this,y(c,g),n)}}}if(l)return this;if(!a)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},clear:function(e){var t={},n=b(this.attributes);for(var r in n)t[r]=void 0;return this.set(t,_.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!_.isEmpty(this.changed):void 0!==y(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&b(this.changed);var t=this._changing?this._previousAttributes:this.attributes;e=b(e),t=b(t);var n,r=!1;for(var i in e)_.isEqual(t[i],n=e[i])||((r||(r={}))[i]=n);return r},previous:function(e){return null!=e&&this._previousAttributes?y(this._previousAttributes,e):null},previousAttributes:function(){return _.deepClone(this._previousAttributes)}});return w.keyPathSeparator=".",e.DeepModel=w,"undefined"!=typeof module&&(module.exports=w),e},"function"==typeof define&&define.amd?define(["underscore","backbone"],t):t(_,Backbone),function(){var A,h=function(e,t){return function(){return e.apply(t,arguments)}},l=[].slice,P=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};A={},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),A.Binding=function(){function e(e,t,n,r,i,o){var s,a,l;if(this.view=e,this.el=t,this.type=n,this.key=r,this.keypath=i,this.options=null!=o?o:{},this.update=h(this.update,this),this.unbind=h(this.unbind,this),this.bind=h(this.bind,this),this.publish=h(this.publish,this),this.sync=h(this.sync,this),this.set=h(this.set,this),this.formattedValue=h(this.formattedValue,this),!(this.binder=this.view.binders[this.type]))for(s in l=this.view.binders)a=l[s],"*"!==s&&-1!==s.indexOf("*")&&new RegExp("^"+s.replace("*",".+")+"$").test(this.type)&&(this.binder=a,this.args=new RegExp("^"+s.replace("*","(.+)")+"$").exec(this.type),this.args.shift());this.binder||(this.binder=this.view.binders["*"]),this.binder instanceof Function&&(this.binder={routine:this.binder}),this.formatters=this.options.formatters||[],this.model=this.view.models[this.key]}return e.prototype.formattedValue=function(e){var t,n,r,i,o,s;for(i=0,o=(s=this.formatters).length;i<o;i++)r=(t=(n=s[i]).split(/\s+/)).shift(),(null!=(n=this.model[r]instanceof Function?this.model[r]:this.view.formatters[r])?n.read:void 0)instanceof Function?e=n.read.apply(n,[e].concat(l.call(t))):n instanceof Function&&(e=n.apply(null,[e].concat(l.call(t))));return e},e.prototype.set=function(e){var t;return e=e instanceof Function&&!this.binder.function?this.formattedValue(e.call(this.model)):this.formattedValue(e),null!=(t=this.binder.routine)?t.call(this,this.el,e):void 0},e.prototype.sync=function(){return this.set(this.options.bypass?this.model[this.keypath]:this.view.config.adapter.read(this.model,this.keypath))},e.prototype.publish=function(){var e,t,n,r,i,o,s,a;for(n=A.Util.getInputValue(this.el),r=0,i=(o=this.formatters.slice(0).reverse()).length;r<i;r++)t=(e=o[r].split(/\s+/)).shift(),(null!=(s=this.view.formatters[t])?s.publish:void 0)&&(n=(a=this.view.formatters[t]).publish.apply(a,[n].concat(l.call(e))));return this.view.config.adapter.publish(this.model,this.keypath,n)},e.prototype.bind=function(){var e,t,n,r,i,o,s,a,l;if(null!=(o=this.binder.bind)&&o.call(this,this.el),this.options.bypass?this.sync():(this.view.config.adapter.subscribe(this.model,this.keypath,this.sync),this.view.config.preloadData&&this.sync()),null!=(s=this.options.dependencies)?s.length:void 0){for(l=[],r=0,i=(a=this.options.dependencies).length;r<i;r++)e=a[r],t=/^\./.test(e)?(n=this.model,e.substr(1)):(e=e.split("."),n=this.view.models[e.shift()],e.join(".")),l.push(this.view.config.adapter.subscribe(n,t,this.sync));return l}},e.prototype.unbind=function(){var e,t,n,r,i,o,s,a,l;if(null!=(o=this.binder.unbind)&&o.call(this,this.el),this.options.bypass||this.view.config.adapter.unsubscribe(this.model,this.keypath,this.sync),null!=(s=this.options.dependencies)?s.length:void 0){for(l=[],r=0,i=(a=this.options.dependencies).length;r<i;r++)e=a[r],t=/^\./.test(e)?(n=this.model,e.substr(1)):(e=e.split("."),n=this.view.models[e.shift()],e.join(".")),l.push(this.view.config.adapter.unsubscribe(n,t,this.sync));return l}},e.prototype.update=function(){return this.unbind(),this.model=this.view.models[this.key],this.bind()},e}(),A.View=function(){function e(e,t,n){var r,i,o,s,a,l,u,c,d;for(this.els=e,this.models=t,this.options=null!=n?n:{},this.update=h(this.update,this),this.publish=h(this.publish,this),this.sync=h(this.sync,this),this.unbind=h(this.unbind,this),this.bind=h(this.bind,this),this.select=h(this.select,this),this.build=h(this.build,this),this.bindingRegExp=h(this.bindingRegExp,this),this.els.jquery||this.els instanceof Array||(this.els=[this.els]),a=0,l=(u=["config","binders","formatters"]).length;a<l;a++){if(this[i=u[a]]={},this.options[i])for(r in c=this.options[i])o=c[r],this[i][r]=o;for(r in d=A[i])o=d[r],null==(s=this[i])[r]&&(s[r]=o)}this.build()}return e.prototype.bindingRegExp=function(){var e;return(e=this.config.prefix)?new RegExp("^data-"+e+"-"):/^data-/},e.prototype.build=function(){var C,e,t,n,E,r,i,o,s,a,l,M=this;for(this.bindings=[],E=[],C=this.bindingRegExp(),n=function(e){var i,t,n,r,o,s,a,l,u,c,d,h,f,p,m,g,v,_,b,y,x,R,w,S,F,T,k;if(P.call(E,e)<0){for(_=0,x=(S=e.attributes).length;_<x;_++)if(i=S[_],C.test(i.name)){if(g=i.name.replace(C,""),!(n=M.binders[g]))for(a in F=M.binders)v=F[a],"*"!==a&&-1!==a.indexOf("*")&&new RegExp("^"+a.replace("*",".+")+"$").test(g)&&(n=v);if(n||(n=M.binders["*"]),n.block){for(b=0,R=(T=e.getElementsByTagName("*")).length;b<R;b++)c=T[b],E.push(c);t=[i]}}for(y=0,w=(k=t||e.attributes).length;y<w;y++)i=k[y],C.test(i.name)&&(d={},g=i.name.replace(C,""),p=function(){var e,t,n,r;for(r=[],e=0,t=(n=i.value.split("|")).length;e<t;e++)f=n[e],r.push(f.trim());return r}(),m=(h=(r=function(){var e,t,n,r;for(r=[],e=0,t=(n=p.shift().split("<")).length;e<t;e++)o=n[e],r.push(o.trim());return r}()).shift()).split(/\.|:/),d.formatters=p,d.bypass=-1!==h.indexOf(":"),m[0]?l=m.shift():(l=null,m.shift()),u=m.join("."),null!=M.models[l]&&((s=r.shift())&&(d.dependencies=s.split(/\s+/)),M.bindings.push(new A.Binding(M,e,g,l,u,d))));t&&(t=null)}},r=0,o=(a=this.els).length;r<o;r++)for(n(e=a[r]),i=0,s=(l=e.getElementsByTagName("*")).length;i<s;i++)null!=(t=l[i]).attributes&&n(t)},e.prototype.select=function(e){var t,n,r,i,o;for(o=[],n=0,r=(i=this.bindings).length;n<r;n++)e(t=i[n])&&o.push(t);return o},e.prototype.bind=function(){var e,t,n,r,i;for(i=[],t=0,n=(r=this.bindings).length;t<n;t++)e=r[t],i.push(e.bind());return i},e.prototype.unbind=function(){var e,t,n,r,i;for(i=[],t=0,n=(r=this.bindings).length;t<n;t++)e=r[t],i.push(e.unbind());return i},e.prototype.sync=function(){var e,t,n,r,i;for(i=[],t=0,n=(r=this.bindings).length;t<n;t++)e=r[t],i.push(e.sync());return i},e.prototype.publish=function(){var e,t,n,r,i;for(i=[],t=0,n=(r=this.select(function(e){return e.binder.publishes})).length;t<n;t++)e=r[t],i.push(e.publish());return i},e.prototype.update=function(e){var i,o,t,n;for(o in null==e&&(e={}),n=[],e)t=e[o],this.models[o]=t,n.push(function(){var e,t,n,r;for(r=[],e=0,t=(n=this.select(function(e){return e.key===o})).length;e<t;e++)i=n[e],r.push(i.update());return r}.call(this));return n},e}(),A.Util={bindEvent:function(e,t,n,r){var i;return i=function(e){return n.call(this,e,r)},null!=j.jQuery?null!=(e=jQuery(e)).on?e.on(t,i):e.bind(t,i):null!=j.addEventListener?e.addEventListener(t,i,!1):(t="on"+t,e.attachEvent(t,i)),i},unbindEvent:function(e,t,n){return null!=j.jQuery?null!=(e=jQuery(e)).off?e.off(t,n):e.unbind(t,n):j.removeEventListener?e.removeEventListener(t,n,!1):(t="on"+t,e.detachEvent(t,n))},getInputValue:function(e){var t,n,r,i;if(null!=j.jQuery)switch((e=jQuery(e))[0].type){case"checkbox":return e.is(":checked");default:return e.val()}else switch(e.type){case"checkbox":return e.checked;case"select-multiple":for(i=[],n=0,r=e.length;n<r;n++)(t=e[n]).selected&&i.push(t.value);return i;default:return e.value}}},A.binders={enabled:function(e,t){return e.disabled=!t},disabled:function(e,t){return e.disabled=!!t},checked:{publishes:!0,bind:function(e){return this.currentListener=A.Util.bindEvent(e,"change",this.publish)},unbind:function(e){return A.Util.unbindEvent(e,"change",this.currentListener)},routine:function(e,t){var n;return"radio"===e.type?e.checked=(null!=(n=e.value)?n.toString():void 0)===(null!=t?t.toString():void 0):e.checked=!!t}},unchecked:{publishes:!0,bind:function(e){return this.currentListener=A.Util.bindEvent(e,"change",this.publish)},unbind:function(e){return A.Util.unbindEvent(e,"change",this.currentListener)},routine:function(e,t){var n;return"radio"===e.type?e.checked=(null!=(n=e.value)?n.toString():void 0)!==(null!=t?t.toString():void 0):e.checked=!t}},show:function(e,t){return e.style.display=t?"":"none"},hide:function(e,t){return e.style.display=t?"none":""},html:function(e,t){return e.innerHTML=null!=t?t:""},value:{publishes:!0,bind:function(e){return this.currentListener=A.Util.bindEvent(e,"change",this.publish)},unbind:function(e){return A.Util.unbindEvent(e,"change",this.currentListener)},routine:function(e,t){var n,r,i,o,s,a,l;if(null!=j.jQuery){if(e=jQuery(e),(null!=t?t.toString():void 0)!==(null!=(o=e.val())?o.toString():void 0))return e.val(null!=t?t:"")}else if("select-multiple"===e.type){if(null!=t){for(l=[],r=0,i=e.length;r<i;r++)n=e[r],l.push(n.selected=(s=n.value,0<=P.call(t,s)));return l}}else if((null!=t?t.toString():void 0)!==(null!=(a=e.value)?a.toString():void 0))return e.value=null!=t?t:""}},text:function(e,t){return null!=e.innerText?e.innerText=null!=t?t:"":e.textContent=null!=t?t:""},"on-*":{function:!0,routine:function(e,t){return this.currentListener&&A.Util.unbindEvent(e,this.args[0],this.currentListener),this.currentListener=A.Util.bindEvent(e,this.args[0],t,this.view)}},"each-*":{block:!0,bind:function(e,t){return e.removeAttribute(["data",this.view.config.prefix,this.type].join("-").replace("--","-"))},unbind:function(e,t){var n,r,i,o,s;if(null!=this.iterated){for(s=[],r=0,i=(o=this.iterated).length;r<i;r++)n=o[r],s.push(n.unbind());return s}},routine:function(e,t){var n,r,i,o,s,a,l,u,c,d,h,f,p,m,g,v,_,b,y,x,R,w,S;if(null!=this.iterated)for(f=0,g=(b=this.iterated).length;f<g;f++)for((h=b[f]).unbind(),p=0,v=(y=h.els).length;p<v;p++)(r=y[p]).parentNode.removeChild(r);else this.marker=document.createComment(" rivets: "+this.type+" "),e.parentNode.insertBefore(this.marker,e),e.parentNode.removeChild(e);if(this.iterated=[],t){for(S=[],m=0,_=t.length;m<_;m++){for(l in i=t[m],n={},x=this.view.models)a=x[l],n[l]=a;if(n[this.args[0]]=i,o=e.cloneNode(!0),c=this.iterated.length?this.iterated[this.iterated.length-1].els[0]:this.marker,this.marker.parentNode.insertBefore(o,null!=(R=c.nextSibling)?R:null),u={binders:this.view.options.binders,formatters:this.view.options.binders,config:{}},this.view.options.config)for(s in w=this.view.options.config)d=w[s],u.config[s]=d;u.config.preloadData=!0,(h=new A.View(o,n,u)).bind(),S.push(this.iterated.push(h))}return S}}},"class-*":function(e,t){var n;if(!t==(-1!==(n=" "+e.className+" ").indexOf(" "+this.args[0]+" ")))return e.className=t?e.className+" "+this.args[0]:n.replace(" "+this.args[0]+" "," ").trim()},"*":function(e,t){return t?e.setAttribute(this.type,t):e.removeAttribute(this.type)}},A.config={preloadData:!0},A.formatters={},A.factory=function(e){return e.binders=A.binders,e.formatters=A.formatters,e.config=A.config,e.configure=function(e){var t,n;for(t in null==e&&(e={}),e)n=e[t],A.config[t]=n},e.bind=function(e,t,n){var r;return null==t&&(t={}),null==n&&(n={}),(r=new A.View(e,t,n)).bind(),r}},"object"==typeof exports?A.factory(exports):"function"==typeof define&&define.amd?define(["exports"],function(e){return A.factory(this.rivets=e),e}):A.factory(this.rivets={})}.call(this);var o,n,s,u,a,d={AF:"Afghanistan",AX:"Åland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia, Plurinational State of",BQ:"Bonaire, Sint Eustatius and Saba",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, the Democratic Republic of the",CK:"Cook Islands",CR:"Costa Rica",CI:"Côte d'Ivoire",HR:"Croatia",CU:"Cuba",CW:"Curaçao",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and McDonald Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran, Islamic Republic of",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KP:"Korea, Democratic People's Republic of",KR:"Korea, Republic of",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia, the Former Yugoslav Republic of",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States of",MD:"Moldova, Republic of",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine, State of",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Réunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthélemy",SH:"Saint Helena, Ascension and Tristan da Cunha",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",MF:"Saint Martin (French part)",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome and Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SX:"Sint Maarten (Dutch part)",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",SS:"South Sudan",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan, Province of China",TJ:"Tajikistan",TZ:"Tanzania, United Republic of",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Minor Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela, Bolivarian Republic of",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"};o={},j.requireOnce=function(r,i){return void 0===o[r]?(o[r]=[],null!=i&&o[r].push(i),u.getScript(r,function(){var e,t,n;for(e=0,t=(n=o[r]).length;e<t;e++)(i=n[e])();return o[r]=!0})):!0===o[r]?"function"==typeof i?i():void 0:null!=i?o[r].push(i):void 0},function(e){"use strict";function o(e){return encodeURIComponent(e).replace(/'/g,"%27")}function m(e){return(e=(e=(e=e.replace(/\+/g," ")).replace(/%([ef][0-9a-f])%([89ab][0-9a-f])%([89ab][0-9a-f])/gi,function(e,t,n,r){var i=parseInt(t,16)-224,o=parseInt(n,16)-128;if(0===i&&o<32)return e;var s=(i<<12)+(o<<6)+(parseInt(r,16)-128);return 65535<s?e:String.fromCharCode(s)})).replace(/%([cd][0-9a-f])%([89ab][0-9a-f])/gi,function(e,t,n){var r=parseInt(t,16)-192;if(r<2)return e;var i=parseInt(n,16)-128;return String.fromCharCode((r<<6)+i)})).replace(/%([0-7][0-9a-f])/gi,function(e,t){return String.fromCharCode(parseInt(t,16))})}function g(e){for(var t,n=/([^=&]+)(=([^&]*))?/g;t=n.exec(e);){var r=decodeURIComponent(t[1].replace(/\+/g," ")),i=t[3]?m(t[3]):"";void 0!==this[r]&&null!==this[r]?(this[r]instanceof Array||(this[r]=[this[r]]),this[r].push(i)):this[r]=i}}function v(e,t){!function(e,t,n){var r,i,o,s=_?"file://"+(process.platform.match(/^win/i)?"/":"")+b("fs").realpathSync("."):document.location.href;t||(t=s),_?r=b("url").parse(t):(r=document.createElement("a")).href=t;var a,l,u=(l={path:!0,query:!0,hash:!0},(a=t)&&/^[a-z]+:/.test(a)&&(l.protocol=!0,l.host=!0,/[-a-z0-9]+(\.[-a-z0-9])*:\d+/i.test(a)&&(l.port=!0),/\/\/(.*?)(?::(.*?))?@/.test(a)&&(l.user=!0,l.pass=!0)),l);for(i in o=t.match(/\/\/(.*?)(?::(.*?))?@/)||[],y)e[i]=u[i]&&r[y[i]]||"";if(e.protocol=e.protocol.replace(/:$/,""),e.query=e.query.replace(/^\?/,""),e.hash=m(e.hash.replace(/^#/,"")),e.user=m(o[1]||""),e.pass=m(o[2]||""),e.port=x[e.protocol]==e.port||0==e.port?"":e.port,!u.protocol&&/[^\/#?]/.test(t.charAt(0))&&(e.path=t.split("?")[0].split("#")[0]),!u.protocol&&n){var c=new v(s.match(/(.*\/)/)[0]),d=c.path.split("/"),h=e.path.split("/"),f=["protocol","user","pass","host","port"],p=f.length;for(d.pop(),i=0;i<p;i++)e[f[i]]=c[f[i]];for(;".."===h[0];)d.pop(),h.shift();e.path=("/"!==t.charAt(0)?d.join("/"):"")+"/"+h.join("/")}e.path=e.path.replace(/^\/{2,}/,"/"),e.paths(("/"===e.path.charAt(0)?e.path.slice(1):e.path).split("/")),e.query=new g(e.query)}(this,e,!t)}var _=void 0===j&&"undefined"!=typeof global&&"function"==typeof require,b=_?e.require:null,y={protocol:"protocol",host:"hostname",port:"port",path:"pathname",query:"search",hash:"hash"},x={ftp:21,gopher:70,http:80,https:443,ws:80,wss:443};g.prototype.toString=function(){var e,t,n="",r=o;for(e in this)if(!(this[e]instanceof Function||null===this[e]))if(this[e]instanceof Array){var i=this[e].length;if(i)for(t=0;t<i;t++)n+=n?"&":"",n+=r(e)+"="+r(this[e][t]);else n+=(n?"&":"")+r(e)+"="}else n+=n?"&":"",n+=r(e)+"="+r(this[e]);return n},v.prototype.clearQuery=function(){for(var e in this.query)this.query[e]instanceof Function||delete this.query[e];return this},v.prototype.queryLength=function(){var e,t=0;for(e in this)this[e]instanceof Function||t++;return t},v.prototype.isEmptyQuery=function(){return 0===this.queryLength()},v.prototype.paths=function(e){var t,n="",r=0;if(e&&e.length&&e+""!==e){for(this.isAbsolute()&&(n="/"),t=e.length;r<t;r++)e[r]=!r&&e[r].match(/^\w:$/)?e[r]:o(e[r]);this.path=n+e.join("/")}for(r=0,t=(e=("/"===this.path.charAt(0)?this.path.slice(1):this.path).split("/")).length;r<t;r++)e[r]=m(e[r]);return e},v.prototype.encode=o,v.prototype.decode=m,v.prototype.isAbsolute=function(){return this.protocol||"/"===this.path.charAt(0)},v.prototype.toString=function(){return(this.protocol&&this.protocol+"://")+(this.user&&o(this.user)+(this.pass&&":"+o(this.pass))+"@")+(this.host&&this.host)+(this.port&&":"+this.port)+(this.path&&this.path)+(this.query.toString()&&"?"+this.query)+(this.hash&&"#"+o(this.hash))},e[e.exports?"exports":"Url"]=v}("undefined"!=typeof module&&module.exports?module:j),n=this,s=function(){"use strict";function pe(e,t){for(var n=t.length;n--;)"string"==typeof t[n]&&(t[n]=t[n].toLowerCase()),e[t[n]]=!0;return e}function me(e){var t={},n=void 0;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function ge(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var ve=["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"],_e=["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","audio","canvas","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","video","view","vkern"],be=["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"],ye=["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmuliscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mpspace","msqrt","mystyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"],xe=["#text"],Re=["accept","action","align","alt","autocomplete","background","bgcolor","border","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","coords","crossorigin","datetime","default","dir","disabled","download","enctype","face","for","headers","height","hidden","high","href","hreflang","id","integrity","ismap","label","lang","list","loop","low","max","maxlength","media","method","min","multiple","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","type","usemap","valign","value","width","xmlns"],we=["accent-height","accumulate","additivive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"],Se=["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"],Fe=["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"],Te=/\{\{[\s\S]*|[\s\S]*\}\}/gm,ke=/<%[\s\S]*|[\s\S]*%>/gm,Ce=/^data-[\-\w.\u00B7-\uFFFF]/,Ee=/^aria-[\-\w]+$/,Me=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Ae=/^(?:\w+script|data):/i,Pe=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ie=function(){return void 0===j?null:j};return function t(){var l=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Ie(),h=function(e){return t(e)};if(h.version="1.0.8",h.removed=[],!l||!l.document||9!==l.document.nodeType)return h.isSupported=!1,h;var u=l.document,r=!1,i=!1,o=l.document,c=l.DocumentFragment,e=l.HTMLTemplateElement,d=l.Node,n=l.NodeFilter,s=l.NamedNodeMap,a=void 0===s?l.NamedNodeMap||l.MozNamedAttrMap:s,f=l.Text,p=l.Comment,m=l.DOMParser;if("function"==typeof e){var g=o.createElement("template");g.content&&g.content.ownerDocument&&(o=g.content.ownerDocument)}var v=o,_=v.implementation,b=v.createNodeIterator,y=v.getElementsByTagName,x=v.createDocumentFragment,R=u.importNode,w={};h.isSupported=_&&void 0!==_.createHTMLDocument&&9!==o.documentMode;var S=Te,F=ke,T=Ce,k=Ee,C=Ae,E=Pe,M=Me,A=null,P=pe({},[].concat(ge(ve),ge(_e),ge(be),ge(ye),ge(xe))),L=null,I=pe({},[].concat(ge(Re),ge(we),ge(Se),ge(Fe))),V=null,j=null,O=!0,N=!0,B=!1,D=!1,J=!1,$=!1,q=!1,z=!1,U=!1,H=!1,G=!1,W=!0,K=!0,X=!1,Y={},Q=pe({},["audio","head","math","script","style","template","svg","video"]),Z=pe({},["audio","video","img","source","image"]),ee=pe({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),te=null,ne=o.createElement("form"),re=function(e){"object"!==(void 0===e?"undefined":Le(e))&&(e={}),A="ALLOWED_TAGS"in e?pe({},e.ALLOWED_TAGS):P,L="ALLOWED_ATTR"in e?pe({},e.ALLOWED_ATTR):I,V="FORBID_TAGS"in e?pe({},e.FORBID_TAGS):{},j="FORBID_ATTR"in e?pe({},e.FORBID_ATTR):{},Y="USE_PROFILES"in e&&e.USE_PROFILES,O=!1!==e.ALLOW_ARIA_ATTR,N=!1!==e.ALLOW_DATA_ATTR,B=e.ALLOW_UNKNOWN_PROTOCOLS||!1,D=e.SAFE_FOR_JQUERY||!1,J=e.SAFE_FOR_TEMPLATES||!1,$=e.WHOLE_DOCUMENT||!1,U=e.RETURN_DOM||!1,H=e.RETURN_DOM_FRAGMENT||!1,G=e.RETURN_DOM_IMPORT||!1,z=e.FORCE_BODY||!1,W=!1!==e.SANITIZE_DOM,K=!1!==e.KEEP_CONTENT,X=e.IN_PLACE||!1,M=e.ALLOWED_URI_REGEXP||M,J&&(N=!1),H&&(U=!0),Y&&(A=pe({},[].concat(ge(xe))),L=[],!0===Y.html&&(pe(A,ve),pe(L,Re)),!0===Y.svg&&(pe(A,_e),pe(L,we),pe(L,Fe)),!0===Y.svgFilters&&(pe(A,be),pe(L,we),pe(L,Fe)),!0===Y.mathMl&&(pe(A,ye),pe(L,Se),pe(L,Fe))),e.ADD_TAGS&&(A===P&&(A=me(A)),pe(A,e.ADD_TAGS)),e.ADD_ATTR&&(L===I&&(L=me(L)),pe(L,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&pe(ee,e.ADD_URI_SAFE_ATTR),K&&(A["#text"]=!0),$&&pe(A,["html","head","body"]),A.table&&pe(A,["tbody"]),Object&&"freeze"in Object&&Object.freeze(e),te=e},ie=function(t){h.removed.push({element:t});try{t.parentNode.removeChild(t)}catch(e){t.outerHTML=""}},oe=function(e,t){try{h.removed.push({attribute:t.getAttributeNode(e),from:t})}catch(e){h.removed.push({attribute:null,from:t})}t.removeAttribute(e)},se=function(e){var t=void 0;if(z&&(e="<remove></remove>"+e),r)try{t=(new m).parseFromString(e,"text/html")}catch(e){}if(i&&pe(V,["title"]),!t||!t.documentElement){var n=(t=_.createHTMLDocument("")).body;n.parentNode.removeChild(n.parentNode.firstElementChild),n.outerHTML=e}return y.call(t,$?"html":"body")[0]};h.isSupported&&(function(){try{se('<svg><p><style><img src="</style><img src=x onerror=alert(1)//">').querySelector("svg img")&&(r=!0)}catch(e){}}(),function(){try{se("<x/><title>&lt;/title&gt;&lt;img&gt;").querySelector("title").textContent.match(/<\/title/)&&(i=!0)}catch(e){}}());var ae=function(e){return b.call(e.ownerDocument||e,e,n.SHOW_ELEMENT|n.SHOW_COMMENT|n.SHOW_TEXT,function(){return n.FILTER_ACCEPT},!1)},le=function(e){return"object"===(void 0===d?"undefined":Le(d))?e instanceof d:e&&"object"===(void 0===e?"undefined":Le(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},ue=function(e,t,n){w[e]&&w[e].forEach(function(e){e.call(h,t,n,te)})},ce=function(e){var t,n=void 0;if(ue("beforeSanitizeElements",e,null),!((t=e)instanceof f||t instanceof p||"string"==typeof t.nodeName&&"string"==typeof t.textContent&&"function"==typeof t.removeChild&&t.attributes instanceof a&&"function"==typeof t.removeAttribute&&"function"==typeof t.setAttribute))return ie(e),!0;var r=e.nodeName.toLowerCase();if(ue("uponSanitizeElement",e,{tagName:r,allowedTags:A}),A[r]&&!V[r])return!D||e.firstElementChild||e.content&&e.content.firstElementChild||!/</g.test(e.textContent)||(h.removed.push({element:e.cloneNode()}),e.innerHTML?e.innerHTML=e.innerHTML.replace(/</g,"&lt;"):e.innerHTML=e.textContent.replace(/</g,"&lt;")),J&&3===e.nodeType&&(n=(n=(n=e.textContent).replace(S," ")).replace(F," "),e.textContent!==n&&(h.removed.push({element:e.cloneNode()}),e.textContent=n)),ue("afterSanitizeElements",e,null),!1;if(K&&!Q[r]&&"function"==typeof e.insertAdjacentHTML)try{e.insertAdjacentHTML("AfterEnd",e.innerHTML)}catch(e){}return ie(e),!0},de=function(e,t,n){if(W&&("id"===t||"name"===t)&&(n in o||n in ne))return!1;if(J&&(n=(n=n.replace(S," ")).replace(F," ")),N&&T.test(t));else if(O&&k.test(t));else{if(!L[t]||j[t])return!1;if(ee[t]);else if(M.test(n.replace(E,"")));else if("src"!==t&&"xlink:href"!==t||"script"===e||0!==n.indexOf("data:")||!Z[e])if(B&&!C.test(n.replace(E,"")));else if(n)return!1}return!0},he=function(e){var t=void 0,n=void 0,r=void 0,i=void 0,o=void 0;ue("beforeSanitizeAttributes",e,null);var s=e.attributes;if(s){var a={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:L};for(o=s.length;o--;){var l=t=s[o],u=l.name,c=l.namespaceURI;if(n=t.value.trim(),r=u.toLowerCase(),a.attrName=r,a.attrValue=n,a.keepAttr=!0,ue("uponSanitizeAttribute",e,a),n=a.attrValue,"name"===r&&"IMG"===e.nodeName&&s.id)i=s.id,s=Array.prototype.slice.apply(s),oe("id",e),oe(u,e),s.indexOf(i)>o&&e.setAttribute("id",i.value);else{if("INPUT"===e.nodeName&&"type"===r&&"file"===n&&(L[r]||!j[r]))continue;"id"===u&&e.setAttribute(u,""),oe(u,e)}if(a.keepAttr){var d=e.nodeName.toLowerCase();if(de(d,r,n))try{c?e.setAttributeNS(c,u,n):e.setAttribute(u,n),h.removed.pop()}catch(e){}}}ue("afterSanitizeAttributes",e,null)}},fe=function e(t){var n=void 0,r=ae(t);for(ue("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)ue("uponSanitizeShadowNode",n,null),ce(n)||(n.content instanceof c&&e(n.content),he(n));ue("afterSanitizeShadowDOM",t,null)};return h.sanitize=function(e,t){var n=void 0,r=void 0,i=void 0,o=void 0,s=void 0;if(e||(e="\x3c!--\x3e"),"string"!=typeof e&&!le(e)){if("function"!=typeof e.toString)throw new TypeError("toString is not a function");if("string"!=typeof(e=e.toString()))throw new TypeError("dirty is not a string, aborting")}if(!h.isSupported){if("object"===Le(l.toStaticHTML)||"function"==typeof l.toStaticHTML){if("string"==typeof e)return l.toStaticHTML(e);if(le(e))return l.toStaticHTML(e.outerHTML)}return e}if(q||re(t),h.removed=[],X);else if(e instanceof d)1===(r=(n=se("\x3c!--\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===r.nodeName?n=r:n.appendChild(r);else{if(!U&&!$&&-1===e.indexOf("<"))return e;if(!(n=se(e)))return U?null:""}n&&z&&ie(n.firstChild);for(var a=ae(X?e:n);i=a.nextNode();)3===i.nodeType&&i===o||ce(i)||(i.content instanceof c&&fe(i.content),he(i),o=i);if(X)return e;if(U){if(H)for(s=x.call(n.ownerDocument);n.firstChild;)s.appendChild(n.firstChild);else s=n;return G&&(s=R.call(u,s,!0)),s}return $?n.outerHTML:n.innerHTML},h.setConfig=function(e){re(e),q=!0},h.clearConfig=function(){te=null,q=!1},h.isValidAttribute=function(e,t,n){te||re({});var r=e.toLowerCase(),i=t.toLowerCase();return de(r,i,n)},h.addHook=function(e,t){"function"==typeof t&&(w[e]=w[e]||[],w[e].push(t))},h.removeHook=function(e){w[e]&&w[e].pop()},h.removeHooks=function(e){w[e]&&(w[e]=[])},h.removeAllHooks=function(){w={}},h}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=s():"function"==typeof define&&define.amd?define(s):n.DOMPurify=s(),u=jQuery,a=_.str,rivets.inputEvent=document.addEventListener?"input":"keyup",rivets.binders.input={publishes:!0,routine:rivets.binders.value.routine,bind:function(e){return u(e).bind(rivets.inputEvent+".rivets",this.publish)},unbind:function(e){return u(e).unbind(rivets.inputEvent+".rivets")}},rivets.binders.checkedarray={publishes:!0,routine:function(e,t){return e.checked=_.contains(t,e.value)},bind:function(n){return u(n).bind("change.rivets",(r=this,function(){var e,t;return t=r.model.get(r.keypath)||[],e=n.checked?_.uniq(t.concat(n.value)):_.without(t,n.value),r.model.set(r.keypath,e)}));var r},unbind:function(e){return u(e).unbind("change.rivets")}},rivets.binders.dobtradiogroup={publishes:!0,routine:function(e,t){return e.checked=u(e).hasClass("js_other_option")?this.model.get("value.other_checked"):_.contains(t,e.value)},bind:function(e){return u(e).bind("change.rivets",(t=this,function(){return u(e).hasClass("js_other_option")?(t.model.set("value.other_checked",!0),t.model.set(t.keypath,[])):(t.model.unset("value.other_checked"),t.model.unset("value.other_text"),t.model.set(t.keypath,[e.value]))}));var t}},rivets.configure({prefix:"rv",adapter:{subscribe:function(e,t,n){return n.wrapped=function(e,t){return n(t)},e.on("change:"+t,n.wrapped)},unsubscribe:function(e,t,n){return e.off("change:"+t,n.wrapped)},read:function(e,t){return"cid"===t?e.cid:e.get(t)},publish:function(e,t,n){return e.cid?e.set(t,n):e[t]=n}}}),function(){var l;j.FormRenderer=l=Backbone.View.extend({defaults:{enablePages:!0,screendoorBase:"https://screendoor.dobt.co",target:"[data-formrenderer]",validateImmediately:!1,response:{},responderLanguage:void 0,preview:!1,skipValidation:void 0,skipConditions:void 0,saveParams:{},showLabels:!1,scrollToPadding:0,plugins:["Autosave","WarnBeforeUnload","BottomBar","ErrorBar","SavedSession"]},constructor:function(e){var t,n,i,r,o,s;for((this.fr=this).options=u.extend({},this.defaults,e),this.requests=0,this.state=new Backbone.Model({hasChanges:!1}),this.setElement(u(this.options.target)),this.$el.addClass("fr_form"),this.$el.data("formrenderer-instance",this),this.subviews={pages:{}},this.serverHeaders={"X-FR-Version":l.VERSION,"X-FR-URL":document.URL},this.plugins=_.map(this.options.plugins,(o=this,function(e){return new l.Plugins[e](o)})),t=0,n=(r=this.plugins).length;t<n;t++)"function"==typeof(i=r[t]).beforeFormLoad&&i.beforeFormLoad();return this.$el.html(JST.main(this)),this.trigger("viewRendered",this),this.loadFromServer((s=this,function(){var e,t,n,r;for(s.$el.find(".fr_loading").remove(),s.initFormComponents(s.options.response_fields,s.options.response.responses),s.initPages(),s.options.enablePages?s.initPagination():s.initNoPagination(),t=0,n=(r=s.plugins).length;t<n;t++)"function"==typeof(i=r[t]).afterFormLoad&&i.afterFormLoad();return s.options.validateImmediately&&s.validate(),s.trigger("ready"),"function"==typeof(e=s.options).onReady?e.onReady():void 0})),this.$el.on("submit",function(e){return e.preventDefault()}),this},corsSupported:function(){return"withCredentials"in new XMLHttpRequest},projectUrl:function(){return this.options.screendoorBase+"/projects/"+this.options.project_id},loadFromServer:function(i){return null!=this.options.response_fields&&null!=this.options.response.responses?i():u.ajax({url:this.options.screendoorBase+"/api/form_renderer/load",type:"get",dataType:"json",data:this.loadParams(),headers:this.serverHeaders,success:(o=this,function(e){var t,n,r;return(t=o.options).response_fields||(t.response_fields=e.project.response_fields),(n=o.options.response).responses||(n.responses=(null!=(r=e.response)?r.responses:void 0)||{}),null==o.options.afterSubmit&&(o.options.afterSubmit={method:"page",html:e.project.after_response_page_html||"<p>"+l.t.thanks+"</p>"}),i()}),error:(n=this,function(e){var t;return n.corsSupported()?(n.$el.find(".fr_loading").text(l.t.error_loading+': "'+((null!=(t=e.responseJSON)?t.error:void 0)||"Unknown")+'"'),n.trigger("errorSaving",e)):n.$el.find(".fr_loading").html(l.t.not_supported.replace(/\:url/g,n.projectUrl()))})});var n,o},initPages:function(){var t,n,e,r,i,o,s,a;for(r in t=function(){return s.subviews.pages[n]=new l.Views.Page({form_renderer:s})},(s=this).numPages=this.formComponents.where({field_type:"page_break"}).length+1,this.state.set("activePage",1),n=1,t(),this.formComponents.each((a=this,function(e){return"page_break"===e.get("field_type")?(n++,t()):a.subviews.pages[n].models.push(e)})),o=[],i=this.subviews.pages)e=i[r],o.push(this.$el.append(e.render().el));return o},initPagination:function(){return this.subviews.pagination=new l.Views.Pagination({form_renderer:this}),this.$el.prepend(this.subviews.pagination.render().el),this.subviews.pages[this.state.get("activePage")].show()},initNoPagination:function(){var e,t,n,r;for(t in r=[],n=this.subviews.pages)e=n[t],r.push(e.show());return r},activatePage:function(e){return this.subviews.pages[this.state.get("activePage")].hide(),this.subviews.pages[e].show(),j.scrollTo(0,this.options.scrollToPadding),this.state.set("activePage",e)},validate:function(){var e,t;for(e in t=this.subviews.pages)t[e].validate();return this.trigger("afterValidate afterValidate:all"),this.areAllPagesValid()},isPageVisible:function(e){var t;return null!=(t=this.subviews.pages[e])?t.isVisible():void 0},isPageValid:function(e){var t;return null!=(t=this.subviews.pages[e])?t.isValid():void 0},focusFirstError:function(){var e,t;return e=this.invalidPages()[0],this.activatePage(e),t=this.subviews.pages[e].firstViewWithError(),j.scrollTo(0,t.$el.offset().top-this.options.scrollToPadding),t.focus()},invalidPages:function(){var n,t;return _.filter(function(){n=[];for(var e=1,t=this.numPages;1<=t?e<=t:t<=e;1<=t?e++:e--)n.push(e);return n}.apply(this),(t=this,function(e){return!1===t.isPageValid(e)}))},areAllPagesValid:function(){return 0===this.invalidPages().length},visiblePages:function(){return _.tap([],(i=this,function(e){var t,n,r;for(t in r=[],n=i.subviews.pages)n[t],i.isPageVisible(t)?r.push(e.push(parseInt(t,10))):r.push(void 0);return r}));var i},isFirstPage:function(){var e;return!(e=this.visiblePages()[0])||this.state.get("activePage")===e},isLastPage:function(){var e;return!(e=_.last(this.visiblePages()))||this.state.get("activePage")===e},previousPage:function(){return this.visiblePages()[_.indexOf(this.visiblePages(),this.state.get("activePage"))-1]},nextPage:function(){return this.visiblePages()[_.indexOf(this.visiblePages(),this.state.get("activePage"))+1]},handlePreviousPage:function(){return this.activatePage(this.previousPage())},handleNextPage:function(){return this.isLastPage()||!this.options.enablePages?this.submit():this.activatePage(this.nextPage())},queryParams:function(){return l.queryParams(document.location.search)},loadParams:function(){return _.extend({v:0,response_id:this.options.response.id,project_id:this.options.project_id,responder_language:this.options.responderLanguage,query_params:this.queryParams()},this.followUpFormParams())},saveParams:function(){return _.extend(this.loadParams(),{skip_validation:this.options.skipValidation},this.options.saveParams)},followUpFormParams:function(){return this.isRenderingFollowUpForm()?{follow_up_form_id:this.options.follow_up_form_id,initial_response_id:this.options.initial_response_id}:{}},isRenderingFollowUpForm:function(){return!!this.options.follow_up_form_id},responsesChanged:function(){if(this.state.set("hasChanges",!0),this.isSaving)return this.changedWhileSaving=!0},save:function(n){var r,i,e;if(null==n&&(n={}),!this.isSaving)return this.requests+=1,this.isSaving=!0,this.changedWhileSaving=!1,u.ajax({url:this.options.screendoorBase+"/api/form_renderer/save",type:"post",contentType:"application/json",dataType:"json",data:JSON.stringify(_.extend(this.saveParams(),{raw_responses:this.getValue(),submit:!!n.submit||void 0})),headers:this.serverHeaders,complete:(e=this,function(){return e.requests-=1,e.isSaving=!1,e.trigger("afterSave")}),success:(i=this,function(e){var t;return i.state.set({hasChanges:i.changedWhileSaving,hasServerErrors:!1}),i.options.response.id=e.response_id,null!=(t=n.cb)?t.apply(i,arguments):void 0}),error:(r=this,function(e){var t,n;return r.state.set({hasServerErrors:!0,serverErrorText:null!=(t=e.responseJSON)?t.error:void 0,serverErrorKey:null!=(n=e.responseJSON)?n.error_key:void 0,submitting:!1})})})},waitForRequests:function(e){return 0<this.requests?setTimeout((t=this,function(){return t.waitForRequests(e)}),100):e();var t},submit:function(e){var t;if(null==e&&(e={}),e.skipValidation||this.options.skipValidation||this.validate())return this.state.set("submitting",!0),this.waitForRequests((t=this,function(){return t.options.preview?t._preview():t.save({submit:!0,cb:function(){return t.trigger("afterSubmit"),t._afterSubmit()}})}))},_afterSubmit:function(){var e,t;return"function"==typeof(t=this.options.afterSubmit)?t.call(this):"string"==typeof t?j.location=t.replace(":id",this.options.response.id.split(",")[0]):"object"==typeof t&&"page"===t.method?(e=u("<div class='fr_after_submit_page'>"+t.html+"</div>"),this.$el.replaceWith(e)):console.log("[FormRenderer] Not sure what to do...")},_preview:function(){var e,t;return e=function(){return j.location=t.options.preview.replace(":id",t.options.response.id.split(",")[0])},!(t=this).state.get("hasChanges")&&this.options.response.id?e():this.save({cb:e})},reflectConditions:function(){var e,t,n;for(e in t=this.subviews.pages)t[e].reflectConditions();return null!=(n=this.subviews.pagination)?n.render():void 0}}),l.BUTTON_CLASS="fr_button",l.DEFAULT_LAT_LNG=[40.7700118,-73.9800453],l.MAPBOX_URL="https://api.tiles.mapbox.com/mapbox.js/v2.1.4/mapbox.js",l.EMAIL_REGEX=/^\s*([^@\s]{1,64})@((?:[-a-z0-9]+\.)+[a-z]{2,})\s*$/i,l.ADD_ROW_ICON="+",l.REMOVE_ROW_ICON="-",l.REMOVE_ENTRY_LINK_CLASS="fr_group_entry_remove",l.REMOVE_ENTRY_LINK_HTML="Remove",l.Views={},l.Models={},l.Plugins={},l.Validators={EmailValidator:{VALID_REGEX:l.EMAIL_REGEX}},l.addPlugin=function(e){return this.prototype.defaults.plugins.push(e)},l.removePlugin=function(e){return this.prototype.defaults.plugins=_.without(this.prototype.defaults.plugins,e)}}.call(this),function(){FormRenderer.formComponentViewClass=function(e){var t;return e.group?FormRenderer.Views.ResponseFieldRepeatingGroup:(t=FormRenderer.Views["ResponseField"+a.classify(e.field_type)])?t:FormRenderer.Views.ResponseField},FormRenderer.buildFormComponentView=function(e,t){return new(FormRenderer.formComponentViewClass(e))({model:e,form_renderer:t})},FormRenderer.formComponentModelClass=function(e){return FormRenderer.Models["ResponseField"+a.classify(e.field_type)]},FormRenderer.buildFormComponentModel=function(e,t,n){return new(FormRenderer.formComponentModelClass(e))(e,t,n)}}.call(this),function(){var t,n,r,i,o;n=["a","p","br","b","strong","em","i"],t=["href","target"],r=function(e){var t;return t=/(^|[\s\n]|<br\/?>)((?:https?|ftp):\/\/[\-A-Z0-9+\u0026\u2019@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~()_|])/gi,e.replace(t,"$1<a href='$2' target='_blank'>$2</a>")},o=function(e){return null==e&&(e=""),(""+e).replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br />$2")},i=function(e){return DOMPurify.sanitize(e,{ALLOWED_TAGS:n,ALLOWED_ATTR:t})},FormRenderer.formatAndSanitizeHTML=function(e){return i(r(o(e)))}}.call(this),function(){FormRenderer.getLength=function(e,t){var n;return n=a.trim(t),"words"===e?(n.replace(/['";:,.?¿\-!¡]+/g,"").match(/\S+/g)||"").length:n.length}}.call(this),function(){FormRenderer.normalizeNumber=function(e,t){var n;return n=e.replace(/,/g,"").replace(/-/g,"").replace(/^\+/,"").trim(),t&&(n=n.replace(new RegExp(t+"$","i"),"").trim()),n}}.call(this),function(){FormRenderer.queryParams=function(e){return e.substring(1).split("&").filter(function(e){return""!==e}).reduce(function(e,t){return 2===(t=t.split("=")).length&&(e[t[0]]=t[1]),e},{})}}.call(this),function(){FormRenderer.toBoolean=function(e){return _.contains(["True","Yes","true","1",1,"yes",!0],e)}}.call(this),function(){FormRenderer.VERSION="1.3.12"}.call(this),function(){var e;e=["US","GB","CA"],FormRenderer.ORDERED_COUNTRIES=_.uniq(_.union(e,[void 0],_.keys(d))),FormRenderer.PROVINCES_CA=["Alberta","British Columbia","Labrador","Manitoba","New Brunswick","Newfoundland","Nova Scotia","Nunavut","Northwest Territories","Ontario","Prince Edward Island","Quebec","Saskatchewen","Yukon"],FormRenderer.PROVINCES_US=["Alabama","Alaska","American Samoa","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","District Of Columbia","Federated States Of Micronesia","Florida","Georgia","Guam","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Marshall Islands","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Northern Mariana Islands","Ohio","Oklahoma","Oregon","Palau","Pennsylvania","Puerto Rico","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virgin Islands","Virginia","Washington","West Virginia","Wisconsin","Wyoming"]}.call(this),function(){var i,o=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};i=["present","blank"],FormRenderer.ConditionChecker=function(){function e(e,t){var n;this.responseField=e,this.condition=t,this.value=(null!=(n=this.responseField)?n.toText():void 0)||""}return e.prototype.method_eq=function(){return this.value.toLowerCase()===this.condition.value.toLowerCase()},e.prototype.method_contains=function(){return-1<this.value.toLowerCase().indexOf(this.condition.value.toLowerCase())},e.prototype.method_not=function(){return!this.method_eq()},e.prototype.method_does_not_contain=function(){return!this.method_contains()},e.prototype.method_gt=function(){return parseFloat(this.value)>parseFloat(this.condition.value)},e.prototype.method_lt=function(){return parseFloat(this.value)<parseFloat(this.condition.value)},e.prototype.method_shorter=function(){return this.length()<parseInt(this.condition.value,10)},e.prototype.method_longer=function(){return this.length()>parseInt(this.condition.value,10)},e.prototype.method_present=function(){return!!this.value.match(/\S/)},e.prototype.method_blank=function(){return!this.method_present()},e.prototype.length=function(){return FormRenderer.getLength(this.responseField.getLengthValidationUnits(),this.value)},e.prototype.isValid=function(){var e,t;return this.responseField&&_.all(["response_field_id","method"],(t=this,function(e){return t.condition[e]}))&&(e=this.condition.method,0<=o.call(i,e)||this.condition.value)},e.prototype.isVisible=function(){var e,t,n,r;return!(null==(e=this.responseField)||null==(t=e.fr)||null==(n=t.options)||!n.skipConditions)||(!this.isValid()||(r=this.condition.method,0<=o.call(i,r)?this["method_"+this.condition.method]():this.method_present()&&this["method_"+this.condition.method]()))},e}()}.call(this),function(){FormRenderer.Models.BaseFormComponent=Backbone.DeepModel.extend({initialize:function(e,t,n){return this.fr=t,this.parent=n,this.calculateVisibility()},sync:function(){},validateComponent:function(){},setExistingValue:function(){},shouldPersistValue:function(){return this.isVisible&&(this.group||this.input_field)},getConditions:function(){return this.get("conditions")||[]},isRequired:function(){return this.get("required")},isConditional:function(){return 0<this.getConditions().length},parentGroupIsHidden:function(){return null!=this.parent.repeatingGroup&&!this.parent.repeatingGroup.isVisible},calculateVisibilityIsChanged:function(){var e;return e=!!this.isVisible,this.calculateVisibility(),e!==this.isVisible},calculateVisibility:function(){return this.isVisible=this._calculateIsVisible()},_calculateIsVisible:function(){return!this.renderingRespondentForm()||this.satisfiesConditions(this.parent.formComponents)},satisfiesConditions:function(t){return!this.isConditional()||_[this.conditionMethod()](this.getConditions(),function(e){return new FormRenderer.ConditionChecker(t.get(e.response_field_id),e).isVisible()})},conditionMethod:function(){return"any"===this.get("condition_method")?"any":"all"},renderingRespondentForm:function(){return!!this.fr}})}.call(this),function(){var n,r=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};n=function(e){return e&&(e.hasAttribute("data-fr-next-page")||e.hasAttribute("data-fr-previous-page"))},FormRenderer.Models.ResponseField=FormRenderer.Models.BaseFormComponent.extend({input_field:!0,wrapper:"label",field_type:void 0,validators:[],ignoreKeysWhenCheckingPresence:function(){return[]},initialize:function(){if(FormRenderer.Models.BaseFormComponent.prototype.initialize.apply(this,arguments),this.errors=[],this.hasLengthValidation())return this.listenTo(this,"change:value",this.calculateLength)},getError:function(){if(0<this.errors.length)return this.errors.join(" ")},calculateLength:function(){return this.set("currentLength",FormRenderer.getLength(this.getLengthValidationUnits(),this.get("value")))},getLengthValidationUnits:function(){return this.get("min_max_length_units")||"characters"},setExistingValue:function(e){if(e&&this.set("value",e),this.hasLengthValidation())return this.calculateLength()},getValue:function(){return this.get("value")||this.defaultValue()},defaultValue:function(){return"hash"===this.valueType?{}:"string"===this.valueType?"":void 0},toText:function(){return this.getValue()},hasValue:function(){return"hash"===this.valueType?_.some(this.get("value")||{},(n=this,function(e,t){return!(0<=r.call(n.ignoreKeysWhenCheckingPresence(),t)||!e)})):!!this.get("value");var n},getOptions:function(){return this.get("options")||[]},getColumns:function(){return this.get("columns")||[]},getSize:function(){return this.get("size")||"small"},sizeToHeaderTag:function(){return{large:"h2",medium:"h3",small:"h4"}[this.getSize()]}}),FormRenderer.Views.ResponseField=Backbone.View.extend({className:"fr_response_field",events:{"blur input, textarea, select":"_onBlur"},initialize:function(e){return this._sharedInitialize(e),this.listenTo(this.model,"afterValidate",this.render),this.listenTo(this.model,"change",this._onInput),this.listenTo(this.model,"change:currentLength",this.auditLength),this.listenTo(this.model,"change:error",this.toggleErrorModifier),this.$el.addClass("fr_response_field_"+this.model.field_type)},_onBlur:function(e){if(this.model.hasValue())return setTimeout((t=this,function(){var e;if(e=document.activeElement,!u.contains(t.el,e))return n(e)?u(document).one("mouseup",function(){return t.model.validateComponent()}):t.model.validateComponent()}),1);var t},_onInput:function(){if(0<this.model.errors.length)return this.model.validateComponent({clearOnly:!0})},focus:function(){return this.$el.find(":input:eq(0)").focus()},auditLength:function(){var e,t;if(this.model.hasLengthValidation()&&(e=this.$el.find(".fr_length_counter"))[0])return"short"===(t=this.model.validateLength())?e.addClass("is_short").removeClass("is_long"):"long"===t?e.addClass("is_long").removeClass("is_short"):e.removeClass("is_short is_long")},toggleErrorModifier:function(){return this.$el[this.model.getError()?"addClass":"removeClass"]("error")},partialName:function(){return this.model.input_field?"response_field":"non_input_response_field"},render:function(){var e;return this.$el.html(JST["partials/"+this.partialName()](this)),rivets.bind(this.$el,{model:this.model}),this.auditLength(),null!=(e=this.form_renderer)&&e.trigger("viewRendered",this),this}})}.call(this),function(){FormRenderer.Models.NonInputResponseField=FormRenderer.Models.ResponseField.extend({input_field:!1,validateComponent:function(){}})}.call(this),function(){FormRenderer.Models.ResponseFieldRepeatingGroup=FormRenderer.Models.BaseFormComponent.extend({group:!0,field_type:"repeating_group",initialize:function(){return FormRenderer.Models.BaseFormComponent.prototype.initialize.apply(this,arguments),this.entries=[]},validateComponent:function(){var e,t,n,r,i;for(i=[],t=0,n=(r=this.entries).length;t<n;t++)e=r[t],i.push(e.formComponents.invoke("validateComponent"));return i},setExistingValue:function(e){return this.isRequired()?e&&0!==e.length||(e=[{}]):e?_.isArray(e)&&_.isEmpty(e)&&this.set("skipped",!0):e=[{}],this.entries=_.map(e,(t=this,function(e){return new FormRenderer.Models.ResponseFieldRepeatingGroupEntry({value:e},t.fr,t)}));var t},addEntry:function(){return this.entries.push(new FormRenderer.Models.ResponseFieldRepeatingGroupEntry({},this.fr,this)),this.fr.responsesChanged()},removeEntry:function(e){return this.entries.splice(e,1),0===this.entries.length&&this.set("skipped",!0),this.fr.responsesChanged()},isSkipped:function(){return!!this.get("skipped")},getValue:function(){return this.isSkipped()?[]:_.invoke(this.entries,"getValue")},getTruncatedDescription:function(){var e;return 140,(e=this.get("description"))&&140<e.length&&(e=e.substr(0,140).trim()+"…"),e},maxEntries:function(){return this.get("maxentries")&&parseInt(this.get("maxentries"),10)||1/0},canAdd:function(){return this.entries.length<this.maxEntries()}}),FormRenderer.Models.ResponseFieldRepeatingGroupEntry=Backbone.Model.extend({field_type:"repeating_group_entry",initialize:function(e,t,n){var r;return this.fr=t,this.repeatingGroup=n,null==(r=this.repeatingGroup.get("children"))&&(r=[]),this.initFormComponents(r,this.get("value")||{})},reflectConditions:function(){return this.view.reflectConditions()},canRemove:function(){return 1<this.repeatingGroup.entries.length}}),FormRenderer.Views.ResponseFieldRepeatingGroup=Backbone.View.extend({className:"fr_response_field fr_response_field_group",events:{"click .js-remove-entry":"removeEntry","click .js-add-entry":"addEntry","click .js-skip":"toggleSkip"},initialize:function(e){var o,s;return this._sharedInitialize(e),this.on("shown",(o=this,function(){var e,t,n,r,i;for(r=[],e=0,t=(n=o.views).length;e<t;e++)i=n[e],r.push(i.trigger("shown"));return r})),this.on("hidden",(s=this,function(){var e,t,n,r,i;for(r=[],e=0,t=(n=s.views).length;e<t;e++)i=n[e],r.push(i.trigger("hidden"));return r}))},toggleSkip:function(){return this.model.set("skipped",!this.model.isSkipped()),this.model.isSkipped()||0!==this.model.entries.length||this.addEntry(),this.form_renderer.responsesChanged(),this.render()},addEntry:function(){return this.model.addEntry(),this.render(),_.last(this.views).focus()},removeEntry:function(e){var t;return t=this.$el.find(".js-remove-entry").index(e.target.closest(".js-remove-entry")),this.model.removeEntry(t),this.render()},render:function(){var e,t,n,r,i,o,s,a;for(this.views=[],e=u(),r=n=0,i=(o=this.model.entries||[]).length;n<i;r=++n)t=o[r],a=new FormRenderer.Views.ResponseFieldRepeatingGroupEntry({entry:t,form_renderer:this.form_renderer,idx:r}),t.view=a,e=e.add(a.render().el),this.views.push(a);return this.$el.html(JST["partials/repeating_group"](this)),this.$el.removeClass("is_truncated"),this.model.entries.length&&0<this.model.entries[0].formComponents.length&&this.$el.addClass("is_truncated"),rivets.bind(this.$el,{model:this.model}),this.$el.find(".fr_group_entries").append(e),null!=(s=this.form_renderer)&&s.trigger("viewRendered",this),this}}),FormRenderer.Views.ResponseFieldRepeatingGroupEntry=Backbone.View.extend({className:"fr_group_entry",initialize:function(e){var o,s;return this.entry=e.entry,this.form_renderer=e.form_renderer,this.idx=e.idx,this.views=[],this.on("shown",(o=this,function(){var e,t,n,r,i;for(r=[],e=0,t=(n=o.views).length;e<t;e++)i=n[e],r.push(i.trigger("shown"));return r})),this.on("hidden",(s=this,function(){var e,t,n,r,i;for(r=[],e=0,t=(n=s.views).length;e<t;e++)i=n[e],r.push(i.trigger("hidden"));return r}))},render:function(){var n,e,r;return this.$el.html(JST["partials/repeating_group_entry"](this)),null!=(e=this.form_renderer)&&e.trigger("viewRendered",this),n=this.$el.find(".fr_group_entry_fields"),this.entry.formComponents.each((r=this,function(e){var t;return t=FormRenderer.buildFormComponentView(e,r.form_renderer),n.append(t.render().el),t.reflectConditions(),r.views.push(t)})),this},reflectConditions:function(){var e,t,n,r,i;for(r=[],e=0,t=(n=this.views).length;e<t;e++)i=n[e],r.push(i.reflectConditions());return r},focus:function(){return this.views[0].focus()}})}.call(this),function(){FormRenderer.Models.ResponseFieldAddress=FormRenderer.Models.ResponseField.extend({wrapper:"fieldset",field_type:"address",valueType:"hash",ignoreKeysWhenCheckingPresence:function(){return"country"===this.get("address_format")?[]:["country"]},setExistingValue:function(e){if(FormRenderer.Models.ResponseField.prototype.setExistingValue.apply(this,arguments),!(null!=e?e.country:void 0))return this.set("value.country","US")},toText:function(){return _.values(_.pick(this.getValue(),"street","city","state","zipcode","country")).join(" ")}}),FormRenderer.Views.ResponseFieldAddress=FormRenderer.Views.ResponseField.extend({initialize:function(){return FormRenderer.Views.ResponseField.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:value.country",this.render)}})}.call(this),function(){FormRenderer.Models.ResponseFieldBlockOfText=FormRenderer.Models.NonInputResponseField.extend({field_type:"block_of_text"}),FormRenderer.Views.ResponseFieldBlockOfText=FormRenderer.Views.ResponseField.extend({field_type:"block_of_text"})}.call(this),function(){FormRenderer.Models.ResponseFieldCheckboxes=FormRenderer.Models.ResponseField.extend({field_type:"checkboxes",wrapper:"fieldset",setExistingValue:function(e){var t,n,r,i,o;if(null!=e)return FormRenderer.Models.ResponseField.prototype.setExistingValue.apply(this,arguments);for(t={checked:[]},n=0,r=(o=this.getOptions()).length;n<r;n++)i=o[n],FormRenderer.toBoolean(i.checked)&&t.checked.push(i.label);return this.set("value",t)},toText:function(){var e,t;return e=(null!=(t=this.get("value.checked"))?t.slice(0):void 0)||[],!0===this.get("value.other_checked")&&e.push(this.get("value.other_text")),e.join(" ")},hasValue:function(){var e;return 0<(null!=(e=this.get("value.checked"))?e.length:void 0)||this.get("value.other_checked")}}),FormRenderer.Views.ResponseFieldCheckboxes=FormRenderer.Views.ResponseField.extend({wrapper:"fieldset",field_type:"checkboxes"})}.call(this),function(){FormRenderer.Models.ResponseFieldConfirm=FormRenderer.Models.ResponseField.extend({field_type:"confirm",wrapper:"none",getValue:function(){return this.get("value")||!1},setExistingValue:function(e){return this.set("value",!!e)},toText:function(){return this.get("value")?"Yes":"No"}}),FormRenderer.Views.ResponseFieldConfirm=FormRenderer.Views.ResponseField.extend({wrapper:"none",field_type:"confirm"})}.call(this),function(){FormRenderer.Models.ResponseFieldDate=FormRenderer.Models.ResponseField.extend({wrapper:"fieldset",field_type:"date",valueType:"hash",toText:function(){return _.values(_.pick(this.getValue(),"month","day","year")).join("/")},validateType:function(){var e,t,n,r;if(r=this.get("disable_year")?2e3:parseInt(this.get("value.year"),10)||0,e=parseInt(this.get("value.day"),10)||0,n=parseInt(this.get("value.month"),10)||0,t=1===new Date(r,1,29).getMonth()?29:28,!(0<r&&0<n&&n<=12&&0<e&&e<=[31,t,31,30,31,30,31,31,30,31,30,31][n-1]))return"date"}}),FormRenderer.Views.ResponseFieldDate=FormRenderer.Views.ResponseField.extend({wrapper:"fieldset",field_type:"date"})}.call(this),function(){FormRenderer.Models.ResponseFieldDropdown=FormRenderer.Models.ResponseField.extend({field_type:"dropdown",setExistingValue:function(e){var t;return null!=e?FormRenderer.Models.ResponseField.prototype.setExistingValue.apply(this,arguments):((t=_.find(this.getOptions(),function(e){return FormRenderer.toBoolean(e.checked)}))||this.get("include_blank_option")||(t=_.first(this.getOptions())),t?this.set("value",t.label):this.unset("value"))}}),FormRenderer.Views.ResponseFieldDropdown=FormRenderer.Views.ResponseField.extend({field_type:"dropdown"})}.call(this),function(){FormRenderer.Models.ResponseFieldEmail=FormRenderer.Models.ResponseField.extend({valueType:"string",field_type:"email",validateType:function(){if(!this.get("value").match(FormRenderer.EMAIL_REGEX))return"email"}}),FormRenderer.Views.ResponseFieldEmail=FormRenderer.Views.ResponseField.extend({field_type:"email"})}.call(this),function(){FormRenderer.Models.ResponseFieldFile=FormRenderer.Models.ResponseField.extend({wrapper:"fieldset",field_type:"file",addFile:function(e,t){var n;return(n=this.getFiles().slice(0)).push({id:e,filename:t}),this.set("value",n)},removeFile:function(e){var t;return(t=this.getFiles().slice(0)).splice(e,1),this.set("value",t)},getFiles:function(){return this.get("value")||[]},canAddFile:function(){return this.getFiles().length<this.maxFiles()},toText:function(){return _.compact(_.pluck(this.getFiles(),"filename")).join(" ")},hasValue:function(){return _.any(this.getFiles(),function(e){return!!e.id})},getAcceptedExtensions:function(){var e;if(e=FormRenderer.FILE_TYPES[this.get("file_types")])return _.map(e,function(e){return"."+e})},getValue:function(){return this.getFiles()},maxFiles:function(){return this.get("allow_multiple_files")?10:1}}),FormRenderer.Views.ResponseFieldFile=FormRenderer.Views.ResponseField.extend({events:_.extend({},FormRenderer.Views.ResponseField.prototype.events,{"click [data-fr-remove-file]":"doRemove"}),render:function(){var t,r,n,e,i,o;return FormRenderer.Views.ResponseField.prototype.render.apply(this,arguments),this.$input=this.$el.find("input"),this.$label=this.$el.find(".fr_add_file label"),this.$error=this.$el.find(".fr_add_file .fr_error"),t=void 0,this.$label.on("click",function(e){if(u(this).hasClass("disabled"))return e.preventDefault()}),this.form_renderer&&this.$input.inlineFileUpload({method:"post",action:this.form_renderer.options.screendoorBase+"/api/form_renderer/file",ajaxOpts:{headers:this.form_renderer.serverHeaders},additionalParams:{project_id:this.form_renderer.options.project_id,response_field_id:this.model.get("id"),v:0},start:(o=this,function(e){return t=e.filename,o.$label.addClass("disabled"),o.$label.text(FormRenderer.t.uploading),o.form_renderer.requests+=1}),progress:(i=this,function(e){return i.$label.text(100===e.percent?FormRenderer.t.finishing_up:FormRenderer.t.uploading+" ("+e.percent+"%)")}),complete:(e=this,function(){return e.form_renderer.requests-=1}),success:(n=this,function(e){return n.model.addFile(e.data.file_id,t),n.render()}),error:(r=this,function(e){var t,n;return r.render(),t=null!=(n=e.xhr.responseJSON)?n.errors:void 0,r.$error.text(t||FormRenderer.t.error).show(),setTimeout(function(){return r.$error.hide()},2e3)})}),this},doRemove:function(e){var t;return t=this.$el.find("[data-fr-remove-file]").index(e.target),this.model.removeFile(t),this.render()}})}.call(this),function(){FormRenderer.Models.ResponseFieldIdentification=FormRenderer.Models.ResponseField.extend({field_type:"identification",valueType:"hash",isRequired:function(){return!0},validateType:function(){return this.get("value.email")&&this.get("value.name")?this.get("value.email").match(FormRenderer.EMAIL_REGEX)?void 0:"email":"identification"},shouldPersistValue:function(){var e;return(null==(e=this.fr)||!e.isRenderingFollowUpForm())&&FormRenderer.Models.ResponseField.prototype.shouldPersistValue.apply(this,arguments)},getValue:function(){var e;return(null!=(e=this.fr)?e.isRenderingFollowUpForm():void 0)?null:FormRenderer.Models.ResponseField.prototype.getValue.apply(this,arguments)}}),FormRenderer.Views.ResponseFieldIdentification=FormRenderer.Views.ResponseField.extend({field_type:"identification",disableInput:function(){return this.isInputDisabled=!0},dontRenderInputs:function(){var e;return!!this.isInputDisabled||(null!=(e=this.form_renderer)?e.isRenderingFollowUpForm():void 0)}})}.call(this),function(){FormRenderer.loadLeaflet=function(e){return null!=("undefined"!=typeof L&&null!==L?L.GeoJSON:void 0)?e():requireOnce(FormRenderer.MAPBOX_URL,e)},FormRenderer.initMap=function(e){return L.mapbox.accessToken="pk.eyJ1IjoiYWRhbWphY29iYmVja2VyIiwiYSI6Im1SVEQtSm8ifQ.ZgEOSXsv9eLfGQ-9yAmtIg",L.mapbox.map(e,"adamjacobbecker.ja7plkah")},FormRenderer.Models.ResponseFieldMapMarker=FormRenderer.Models.ResponseField.extend({field_type:"map_marker",latLng:function(){return this.get("value")},defaultLatLng:function(){var e,t;if((e=this.get("default_lat"))&&(t=this.get("default_lng")))return[e,t]}}),FormRenderer.Views.ResponseFieldMapMarker=FormRenderer.Views.ResponseField.extend({events:_.extend({},FormRenderer.Views.ResponseField.prototype.events,{"click .fr_map_cover":"enable","click [data-fr-clear-map]":"disable"}),initialize:function(){return FormRenderer.Views.ResponseField.prototype.initialize.apply(this,arguments),this.on("shown",function(){var e,t;return this.refreshing=!0,null!=(e=this.map)&&e._onResize(),setTimeout((t=this,function(){return t.refreshing=!1}),0)})},render:function(){var e;return FormRenderer.Views.ResponseField.prototype.render.apply(this,arguments),this.$cover=this.$el.find(".fr_map_cover"),FormRenderer.loadLeaflet((e=this,function(){if(e.initMap(),e.model.latLng())return e.enable()})),this},initMap:function(){return this.map=FormRenderer.initMap(this.$el.find(".fr_map_map")[0]),this.$el.find(".fr_map_map").data("map",this.map),this.map.setView(this.model.latLng()||this.model.defaultLatLng()||FormRenderer.DEFAULT_LAT_LNG,13),this.marker=L.marker([0,0]),this.map.on("move",u.proxy(this._onMove,this))},_onMove:function(){var e;if(!this.refreshing)return e=this.map.getCenter(),this.marker.setLatLng(e),this.model.set({value:[e.lat.toFixed(7),e.lng.toFixed(7)]}),this.model.trigger("change:value.0 change:value.1")},enable:function(){if(this.map)return this.map.addLayer(this.marker),this.$cover.hide(),this._onMove()},disable:function(e){return e.preventDefault(),this.map.removeLayer(this.marker),this.$el.find(".fr_map_cover").show(),this.model.unset("value")}})}.call(this),function(){FormRenderer.Models.ResponseFieldNumber=FormRenderer.Models.ResponseField.extend({field_type:"number",valueType:"string",validateType:function(){if(!FormRenderer.normalizeNumber(this.get("value"),this.get("units")).match(/^-?\d*(\.\d+)?$/))return"number"}}),FormRenderer.Views.ResponseFieldNumber=FormRenderer.Views.ResponseField.extend({calculateSize:function(){var e,t;return e=(t=parseInt(this.model.get("max"),10))?(""+t).length:6,this.model.get("integer_only")||(e+=2),6<e?"seven_plus":3<e?"four_six":"one_three"}})}.call(this),function(){FormRenderer.Models.ResponseFieldPageBreak=FormRenderer.Models.NonInputResponseField.extend({field_type:"page_break"}),FormRenderer.Views.ResponseFieldPageBreak=FormRenderer.Views.ResponseField.extend({field_type:"page_break"})}.call(this),function(){FormRenderer.Models.ResponseFieldParagraph=FormRenderer.Models.ResponseField.extend({field_type:"paragraph"}),FormRenderer.Views.ResponseFieldParagraph=FormRenderer.Views.ResponseField.extend({field_type:"paragraph"})}.call(this),function(){FormRenderer.Models.ResponseFieldPhone=FormRenderer.Models.ResponseField.extend({field_type:"phone",valueType:"string",validateType:function(){var e,t,n;if(t=(e="us"===this.get("phone_format"))?10:7,!(((null!=(n=this.get("value").match(/\d/g))?n.join(""):void 0)||"").length>=t))return e?"us_phone":"phone"}}),FormRenderer.Views.ResponseFieldPhone=FormRenderer.Views.ResponseField.extend({phonePlaceholder:function(){if("us"===this.model.get("phone_format"))return"(xxx) xxx-xxxx"}})}.call(this),function(){FormRenderer.Models.ResponseFieldPrice=FormRenderer.Models.ResponseField.extend({wrapper:"fieldset",field_type:"price",valueType:"hash",toText:function(){return(this.getValue().dollars||"0")+"."+(this.getValue().cents||"00")},validateType:function(){var e;if(e=[],this.get("value.dollars")&&e.push((""+this.get("value.dollars")).replace(/,/g,"").replace(/^\$/,"")),this.get("value.cents")&&e.push(""+this.get("value.cents")),!_.every(e,function(e){return e.match(/^-?\d+$/)}))return"price"}}),FormRenderer.Views.ResponseFieldPrice=FormRenderer.Views.ResponseField.extend({events:_.extend({},FormRenderer.Views.ResponseField.prototype.events,{'blur [data-rv-input="model.value.cents"]':"formatCents"}),formatCents:function(e){var t;if((t=u(e.target).val())&&t.match(/^\d$/))return this.model.set("value.cents","0"+t)}})}.call(this),function(){FormRenderer.Models.ResponseFieldRadio=FormRenderer.Models.ResponseFieldCheckboxes.extend({field_type:"radio",wrapper:"fieldset"}),FormRenderer.Views.ResponseFieldRadio=FormRenderer.Views.ResponseField.extend({wrapper:"fieldset",field_type:"radio"})}.call(this),function(){FormRenderer.Models.ResponseFieldSectionBreak=FormRenderer.Models.NonInputResponseField.extend({field_type:"section_break"}),FormRenderer.Views.ResponseFieldSectionBreak=FormRenderer.Views.ResponseField.extend({field_type:"section_break"})}.call(this),function(){FormRenderer.Models.ResponseFieldTable=FormRenderer.Models.ResponseField.extend({field_type:"table",initialize:function(){if(FormRenderer.Models.ResponseField.prototype.initialize.apply(this,arguments),this.get("column_totals"))return this.listenTo(this,"change:value.*",this.calculateColumnTotals)},canAddRows:function(){return this.numRows()<this.maxRows()},minRows:function(){return parseInt(this.get("minrows"),10)||0},maxRows:function(){return this.get("maxrows")&&parseInt(this.get("maxrows"),10)||1/0},setExistingValue:function(l){var u,e,c;return u=Math.max(this.minRows(),(null!=(e=_.values(l)[0])?e.length:void 0)||0,1),this.set("value",_.tap([],(c=this,function(e){var t,n,r,i,o,s,a;for(s=[],r=0,i=(o=c.getColumns()).length;r<i;r++)n=o[r],t=_.map(function(){a=[];for(var e=0,t=u-1;0<=t?e<=t:t<=e;0<=t?e++:e--)a.push(e);return a}.apply(this),function(e){var t;return c.getPresetValue(n.label,e)||(null!=l&&null!=(t=l[n.label])?t[e]:void 0)}),s.push(e.push(t));return s})))},numRows:function(){var e;return null!=(e=this.get("value"))&&e.length?Math.max(this.minRows(),e[0].length||0,1):0},hasValue:function(){return _.some(this.getValue(),(r=this,function(e,n){return _.some(e,function(e,t){return!r.getPresetValue(n,t)&&!!e})}));var r},getPresetValue:function(e,t){var n,r;return null!=(n=this.get("preset_values"))&&null!=(r=n[e])?r[t]:void 0},getValue:function(){return _.tap({},(l=this,function(r){var i,o,s,e,t,n,a;for(n=l.getColumns(),a=[],s=e=0,t=n.length;e<t;s=++e)i=n[s],r[i.label]=[],a.push(function(){var e,t,n;for(n=[],o=e=0,t=this.numRows()-1;0<=t?e<=t:t<=e;o=0<=t?++e:--e)n.push(r[i.label].push(this.get("value."+s+"."+o)||""));return n}.call(l));return a}));var l},toText:function(){return _.flatten(_.values(this.getValue())).join(" ")},calculateColumnTotals:function(){var e,t,n,r,i,o,s,a,l,u;for(u=[],r=i=0,s=(a=this.getColumns()).length;i<s;r=++i){for(a[r],t=[],n=o=0,l=this.numRows()-1;0<=l?o<=l:l<=o;n=0<=l?++o:--o)t.push(parseFloat((this.get("value."+r+"."+n)||"").replace(/\$?,?/g,"")));e=_.reduce(t,function(e,t){return _.isNaN(t)?e:e+t},0),u.push(this.set("columnTotals."+r,this.formatColumnSum(e)))}return u},formatColumnSum:function(e){var t,n,r;return 0<e?(n=(null!=(r=(""+(t=parseFloat(e.toFixed(10)))).split(".")[1])?r.length:void 0)||0,a.numberFormat(t,n,".",",")):""}}),FormRenderer.Views.ResponseFieldTable=FormRenderer.Views.ResponseField.extend({events:_.extend({},FormRenderer.Views.ResponseField.prototype.events,{"click .js-add-row":"addRow","click .js-remove-row":"removeRow"}),canRemoveRow:function(e){return Math.max(1,this.model.minRows())-1<e},addRow:function(e){var t,n,r,i;for(t in e.preventDefault(),n={},r=this.model.get("value"))i=r[t],n[t]=i.concat("");return this.model.set("value",n),this.render()},removeRow:function(e){var t,i,n,r,o;for(t in e.preventDefault(),i=u(e.currentTarget).closest("[data-row-index]").data("row-index"),n={},r=this.model.get("value"))o=r[t],n[t]=_.tap([],function(e){var t,n,r;for(t in n=[],o)r=o[t],parseInt(t,10)!==i?n.push(e.push(r)):n.push(void 0);return n});return this.model.set("value",n),this.render()}})}.call(this),function(){FormRenderer.Models.ResponseFieldText=FormRenderer.Models.ResponseField.extend({field_type:"text",valueType:"string"}),FormRenderer.Views.ResponseFieldText=FormRenderer.Views.ResponseField.extend({field_type:"text"})}.call(this),function(){FormRenderer.Models.ResponseFieldTime=FormRenderer.Models.ResponseField.extend({field_type:"time",wrapper:"fieldset",valueType:"hash",ignoreKeysWhenCheckingPresence:function(){return["am_pm"]},setExistingValue:function(e){if(FormRenderer.Models.ResponseField.prototype.setExistingValue.apply(this,arguments),!(null!=e?e.am_pm:void 0))return this.set("value.am_pm","AM")},toText:function(){return(this.getValue().hours||"00")+":"+(this.getValue().minutes||"00")+":"+(this.getValue().seconds||"00")+" "+this.getValue().am_pm},validateType:function(){var e,t,n;if(e=parseInt(this.get("value.hours"),10),t=parseInt(this.get("value.minutes"),10),n=parseInt(this.get("value.seconds"),10)||0,!(1<=e&&e<=12&&0<=t&&t<=59&&0<=n&&n<=59))return"time"}}),FormRenderer.Views.ResponseFieldTime=FormRenderer.Views.ResponseField.extend({wrapper:"fieldset",field_type:"time"})}.call(this),function(){FormRenderer.Models.ResponseFieldWebsite=FormRenderer.Models.ResponseField.extend({field_type:"website",valueType:"string"}),FormRenderer.Views.ResponseFieldWebsite=FormRenderer.Views.ResponseField.extend({field_type:"website"})}.call(this),function(){var e;e={validateType:function(){},validationFns:["validateType","validateInteger","validateLength","validateMinMax"],validateComponent:function(e){var t,n,r,i,o,s;if(null==e&&(e={}),r=this.get("error"),this.errors=[],this.isVisible&&!this.parentGroupIsHidden()){if(this.hasValue())for(i=0,o=(s=this.validationFns).length;i<o;i++)(n=this[s[i]]())&&this.errors.push(FormRenderer.t.errors[n]);else this.isRequired()&&this.errors.push(FormRenderer.t.errors.blank);return t=this.getError(),e.clearOnly&&r!==t?this.set("error",null):this.set("error",this.getError()),this.fr.trigger("afterValidate afterValidate:one",this)}},hasIntegerValidation:function(){return"number"===this.field_type&&this.get("integer_only")},validateInteger:function(){if(this.hasIntegerValidation())return FormRenderer.normalizeNumber(this.get("value"),this.get("units")).match(/^-?\d+$/)?void 0:"integer"},hasLengthValidation:function(){var e;return("text"===(e=this.field_type)||"paragraph"===e)&&(this.get("minlength")||this.get("maxlength"))},validateLength:function(){var e,t,n;if(this.hasLengthValidation())return n=parseInt(this.get("minlength"),10)||void 0,t=parseInt(this.get("maxlength"),10)||void 0,e=FormRenderer.getLength(this.getLengthValidationUnits(),this.get("value")),n&&e<n?"short":t&&t<e?"long":void 0},hasMinMaxValidation:function(){var e;return("number"===(e=this.field_type)||"price"===e)&&(this.get("min")||this.get("max"))},validateMinMax:function(){var e,t,n;if(this.hasMinMaxValidation())return t=this.get("min")&&parseFloat(this.get("min")),e=this.get("max")&&parseFloat(this.get("max")),n="price"===this.field_type?parseFloat((this.get("value.dollars")||0)+"."+(this.get("value.cents")||0)):parseFloat(this.get("value").replace(/,/g,"")),t&&n<t?"small":e&&e<n?"large":void 0}},_.extend(FormRenderer.Models.ResponseField.prototype,e)}.call(this),function(){var e;e={_sharedInitialize:function(e){return this.form_renderer=e.form_renderer,this.model=e.model,this.model.id&&this.$el.addClass("fr_response_field_"+this.model.id),this.showLabels=this.form_renderer?this.form_renderer.options.showLabels:this.showLabels=e.showLabels},reflectConditions:function(){return this.model.isVisible?this.$el.show():this.$el.hide()},domId:function(){return this.model.cid},getDomId:function(){return domId}},_.extend(FormRenderer.Views.ResponseFieldRepeatingGroup.prototype,e),_.extend(FormRenderer.Views.ResponseField.prototype,e)}.call(this),function(){var e;e={getValue:function(){return _.tap({},(e=this,function(t){return e.formComponents.each(function(e){if(e.shouldPersistValue())return t[e.get("id")]=e.getValue()})}));var e},initFormComponents:function(e,t){var n,r,i,o;for(this.formComponents=new Backbone.Collection,this.response_fields=this.formComponents,r=0,i=e.length;r<i;r++)n=e[r],(o=FormRenderer.buildFormComponentModel(n,this.fr,this)).setExistingValue(t[o.get("id")]),this.formComponents.add(o);return this.initConditions(),this.listenTo(this.formComponents,"change:value change:value.*",function(e){return this.runConditions(e),this.fr.responsesChanged()})},initConditions:function(){return this.allConditions=_.flatten(this.formComponents.map(function(t){return _.map(t.getConditions(),function(e){return _.extend({},e,{parent:t})})}))},conditionsForResponseField:function(t){return _.filter(this.allConditions,function(e){return""+e.response_field_id==""+t.id})},runConditions:function(e){var t;if(t=!1,_.each(this.conditionsForResponseField(e),function(e){if(e.parent.calculateVisibilityIsChanged())return t=!0}),t)return this.reflectConditions()}},_.extend(FormRenderer.prototype,e),_.extend(FormRenderer.Models.ResponseFieldRepeatingGroupEntry.prototype,e)}.call(this),function(){FormRenderer.Plugins.Base=function(e){this.fr=e}}.call(this),function(){var i={}.hasOwnProperty;FormRenderer.Plugins.Autosave=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,FormRenderer.Plugins.Base),t.prototype.afterFormLoad=function(){return setInterval((e=this,function(){if(e.fr.state.get("hasChanges"))return e.fr.save()}),5e3);var e},t}()}.call(this),function(){var n,r,i={}.hasOwnProperty;r="frDraft",n=function(e){var t,n;return n=j.location.href,e=e.replace(/[\[\]]/g,"\\$&"),(t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(n))?t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):"":null},FormRenderer.Plugins.BookmarkDraft=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,FormRenderer.Plugins.Base),t.prototype.beforeFormLoad=function(){var e;if(e=n(r))return this.fr.options.response.id=e},t.prototype.afterFormLoad=function(){return this.fr.subviews.bookmarkDraft=new FormRenderer.Plugins.BookmarkDraft.View({form_renderer:this.fr}),this.fr.$el.append(this.fr.subviews.bookmarkDraft.render().el)},t}(),FormRenderer.Plugins.BookmarkDraft.View=Backbone.View.extend({events:{"click .js-fr-bookmark":"requestBookmark"},initialize:function(e){return this.form_renderer=e.form_renderer},render:function(){return this.$el.html(JST["plugins/bookmark_draft"](this)),this.form_renderer.trigger("viewRendered",this),this},showBookmark:function(e){return prompt(FormRenderer.t.bookmark_hint,e)},getUrl:function(){var e;return(e=new Url).query[r]=this.form_renderer.options.response.id,e.toString()},requestBookmark:function(e){var t,n,r;return e.preventDefault(),t=function(){return n.render(),n.showBookmark(n.getUrl())},(n=this).form_renderer.options.response.id?t():(this.$el.find("a").text(FormRenderer.t.saving),this.form_renderer.waitForRequests((r=this,function(){return r.form_renderer.options.response.id?t():r.form_renderer.save({cb:t})})))}})}.call(this),function(){var i={}.hasOwnProperty;FormRenderer.Plugins.BottomBar=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,FormRenderer.Plugins.Base),t.prototype.afterFormLoad=function(){return this.fr.subviews.bottomBar=new FormRenderer.Plugins.BottomBar.View({form_renderer:this.fr}),this.fr.$el.append(this.fr.subviews.bottomBar.render().el)},t}(),FormRenderer.Plugins.BottomBar.View=Backbone.View.extend({events:{"click [data-fr-previous-page]":function(e){return e.preventDefault(),this.form_renderer.handlePreviousPage()},"click [data-fr-next-page]":function(e){return e.preventDefault(),this.form_renderer.handleNextPage()}},initialize:function(e){return this.form_renderer=e.form_renderer,this.listenTo(this.form_renderer.state,"change:activePage change:hasChanges change:submitting change:hasServerErrors",this.render)},render:function(){return this.$el.html(JST["plugins/bottom_bar"](this)),this.form_renderer.trigger("viewRendered",this),this}})}.call(this),function(){var i={}.hasOwnProperty;FormRenderer.Plugins.ErrorBar=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,FormRenderer.Plugins.Base),t.prototype.afterFormLoad=function(){return this.fr.subviews.errorBar=new FormRenderer.Plugins.ErrorBar.View({form_renderer:this.fr}),this.fr.$el.prepend(this.fr.subviews.errorBar.render().el)},t}(),FormRenderer.Plugins.ErrorBar.View=Backbone.View.extend({events:{"click a":function(e){return e.preventDefault(),this.form_renderer.focusFirstError()}},initialize:function(e){var t;return this.form_renderer=e.form_renderer,this.listenTo(this.form_renderer,"afterValidate:all",(t=this,function(){return t.render(),t.$el.find(".fr_error_alert_bar a").focus()})),this.listenTo(this.form_renderer,"afterValidate:one",function(){if(this.form_renderer.areAllPagesValid())return this.render()})},render:function(){return this.$el.html(JST["plugins/error_bar"](this)),this.form_renderer.trigger("viewRendered",this),this.form_renderer.areAllPagesValid()||j.scrollTo(0,this.$el.offset().top-this.form_renderer.options.scrollToPadding),this}})}.call(this),function(){var i={}.hasOwnProperty;FormRenderer.Plugins.PageState=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,FormRenderer.Plugins.Base),t.prototype.afterFormLoad=function(){var e,t,n;return(e=null!=(n=j.location.hash.match(/page([0-9]+)/))?n[1]:void 0)&&(t=parseInt(e,10),this.fr.isPageVisible(t)&&this.fr.activatePage(t)),this.fr.state.on("change:activePage",function(e,t){return j.location.hash="page"+t})},t}()}.call(this),function(){var i={}.hasOwnProperty;FormRenderer.Plugins.SavedSession=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,FormRenderer.Plugins.Base),t.prototype.beforeFormLoad=function(){var e,t,n;return n="project-"+this.fr.options.project_id+"-response-id",null==this.fr.options.response.id&&(t=Cookies.get(n)),null!=t&&(-1!==t.indexOf(",")?(e=this.fr.options.response).id||(e.id=t):Cookies.remove(n)),this.fr.on("afterSave",function(){if(!this.state.get("submitting"))return Cookies.set(n,this.options.response.id)}),this.fr.on("afterSubmit",function(){return Cookies.remove(n)}),this.fr.on("errorSaving",function(){return Cookies.remove(n)})},t}()}.call(this),function(){var i={}.hasOwnProperty;FormRenderer.Plugins.WarnBeforeUnload=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,FormRenderer.Plugins.Base),t.prototype.afterFormLoad=function(){return BeforeUnload.enable({if:(e=this,function(){return e.fr.state.get("hasChanges")})});var e},t}()}.call(this),function(){FormRenderer.Views.Page=Backbone.View.extend({className:"fr_page",initialize:function(e){return this.form_renderer=e.form_renderer,this.models=[],this.views=[]},render:function(){var e,t,n,r,i;for(this.hide(),e=0,t=(n=this.models).length;e<t;e++)r=n[e],i=FormRenderer.buildFormComponentView(r,this.form_renderer),this.$el.append(i.render().el),i.reflectConditions(),this.views.push(i);return this},hide:function(){var e,t,n,r,i;for(this.$el.hide(),r=[],e=0,t=(n=this.views).length;e<t;e++)i=n[e],r.push(i.trigger("hidden"));return r},show:function(){var e,t,n,r,i;for(this.$el.show(),r=[],e=0,t=(n=this.views).length;e<t;e++)i=n[e],r.push(i.trigger("shown"));return r},reflectConditions:function(){var e,t,n,r,i;for(r=[],e=0,t=(n=this.views).length;e<t;e++)i=n[e],r.push(i.reflectConditions());return r},validate:function(){var e,t,n,r,i;for(i=[],t=0,n=(r=this.models).length;t<n;t++)e=r[t],i.push(e.validateComponent());return i},fieldViews:function(){return _.tap([],(l=this,function(i){var o,s,e,t,n,r,a;for(r=[],e=0,t=(n=l.views).length;e<t;e++)(a=n[e]).model.group?a.model.isSkipped()?r.push(void 0):r.push(function(){var e,t,n,r;for(r=[],e=0,t=(n=a.model.entries).length;e<t;e++)o=n[e],r.push(function(){var e,t,n,r;for(r=[],e=0,t=(n=o.view.views).length;e<t;e++)s=n[e],r.push(i.push(s));return r}());return r}()):r.push(i.push(a));return r}));var l},firstViewWithError:function(){return _.find(this.fieldViews(),function(e){return 0<e.model.errors.length})},isVisible:function(){return _.any(this.models,function(e){return e.isVisible})},isValid:function(){return!this.firstViewWithError()}})}.call(this),function(){FormRenderer.Views.Pagination=Backbone.View.extend({events:{"click [data-activate-page]":function(e){return e.preventDefault(),this.form_renderer.activatePage(u(e.currentTarget).data("activate-page"))}},initialize:function(e){return this.form_renderer=e.form_renderer,this.listenTo(this.form_renderer.state,"change:activePage",this.render),this.listenTo(this.form_renderer,"afterValidate",this.render)},render:function(){return this.$el.html(JST["partials/pagination"](this)),this.form_renderer.trigger("viewRendered",this),this}})}.call(this),FormRenderer.FILE_TYPES={images:["bmp","gif","jpg","jpeg","png","psd","tif","tiff"],videos:["m4v","mp4","mov","mpg"],audio:["m4a","mp3","wav"],docs:["doc","docx","pdf","rtf","txt"],spreadsheets:["csv","xls","xlsx"],presentations:["ppt","pptx"],pdfs:["pdf"]};"undefined"!=typeof FormRenderer&&(FormRenderer.t={address:"Address",add_another:"Add another",answer:"Answer this question",back_to_page:"Back to page :num",blind:"Blind",bookmark_hint:"To finish your response later, copy the link below.",cents:"Cents",characters:"characters",choose_an_option:"Choose an option",city:"City",clear:"Clear",click_to_set:"Click to set location",coordinates:"Coordinates",country:"Country",dollars:"Dollars",email:"Email",enter_at_least:"Enter at least :min",enter_between:"Enter between :min and :max",enter_exactly:"Enter :num",enter_up_to:"Enter up to :max",error:"Error",errors:{blank:"This field can't be blank.",date:"Please enter a valid date.",email:"Please enter a valid email address.",identification:"Please enter your name and email address.",integer:"Please enter a whole number.",large:"Your answer is too large.",long:"Your answer is too long.",number:"Please enter a valid number.",phone:"Please enter a valid phone number.",price:"Please enter a valid price.",short:"Your answer is too short.",small:"Your answer is too small.",time:"Please enter a valid time.",us_phone:"Please enter a valid 10-digit phone number."},error_bar:{errors:"Your response has <a href='#'>validation errors</a>."},error_filename:"Error reading filename",error_loading:"Error loading form",error_saving:"Error saving",finishing_up:"Finishing up...",finish_later:"Finish this later",has_conditions:"Has conditions",hidden:"Hidden",loading_form:"Loading form...",na:"N/A",name:"Name",next_page:"Next page",not_supported:"Sorry, your browser does not support this embedded form. Please visit <a href=':url?fr_not_supported=t'>:url</a> to fill out this form.",other:"Other",postal_code:"Postal Code",province:"Province",remove:"Remove",saved:"Saved",saving:"Saving...",skip:"Skip this question",skipped:"This question is skipped.",state:"State",state_province_region:"State / Province / Region",submit:"Submit",submitting:"Submitting",thanks:"Thanks for submitting our form!",upload:"Upload a file",uploading:"Uploading...",upload_another:"Upload another file",we_accept:"We'll accept",words:"words",write_here:"Write your answer here",zip_code:"ZIP Code"}),j.JST||(j.JST={}),j.JST["fields/address"]=function(n){var c=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,u=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){var e,t,n,r,i,o,s,a,l;if(e=this.model.get("address_format"),u(c("\n\n")),"city_state"!==e&&"city_state_zip"!==e&&"country"!==e&&(u(c("\n  <div class='fr_grid'>\n    <div class='fr_full has_sub_label'>\n      <label class=\"fr_sub_label\" for='")),u(this.domId()),u(c("_street'>")),u(FormRenderer.t.address),u(c('</label>\n      <input type="text"\n             id="')),u(this.domId()),u(c("_street\"\n             data-rv-input='model.value.street' />\n    </div>\n  </div>\n"))),u(c("\n\n")),"country"!==e){if(u(c("\n  <div class='fr_grid'>\n    <div class='fr_half has_sub_label'>\n      <label class=\"fr_sub_label\" for='")),u(this.domId()),u(c("_city'>")),u(FormRenderer.t.city),u(c("</label>\n      <input type=\"text\"\n             data-rv-input='model.value.city'\n             id='")),u(this.domId()),u(c("_city' />\n    </div>\n\n    <div class='fr_half has_sub_label'>\n      <label class=\"fr_sub_label\" for='")),u(this.domId()),u(c("_state'>\n        ")),"US"===this.model.get("value.country")?(u(c("\n          ")),u(FormRenderer.t.state)):"CA"===this.model.get("value.country")?(u(c("\n          ")),u(FormRenderer.t.province)):(u(c("\n          ")),u(FormRenderer.t.state_province_region)),u(c("\n        ")),u(c("\n      </label>\n\n      ")),"US"===(o=this.model.get("value.country"))||"CA"===o){for(u(c("\n        <select data-rv-value='model.value.state' data-width='100%' id='")),u(this.domId()),u(c("_state'>\n          <option></option>\n          ")),t=0,r=(s=FormRenderer["PROVINCES_"+this.model.get("value.country")]).length;t<r;t++)l=s[t],u(c("\n            <option value='")),u(l),u(c("'>")),u(l),u(c("</option>\n          "));u(c("\n        </select>\n      "))}else u(c("\n        <input type=\"text\" data-rv-input='model.value.state' id='")),u(this.domId()),u(c("_state' />\n      "));u(c("\n    </div>\n  </div>\n"))}if(u(c("\n\n<div class='fr_grid'>\n  ")),"city_state"!==e&&"country"!==e&&(u(c("\n    <div class='fr_half has_sub_label'>\n      <label class=\"fr_sub_label\" for='")),u(this.domId()),u(c("_zipcode'>\n        ")),"US"===this.model.get("value.country")?(u(c("\n          ")),u(FormRenderer.t.zip_code)):(u(c("\n          ")),u(FormRenderer.t.postal_code)),u(c("\n        ")),u(c("\n      </label>\n      <input type=\"text\"\n             data-rv-input='model.value.zipcode'\n             id='")),u(this.domId()),u(c("_zipcode' />\n    </div>\n  "))),u(c("\n\n  ")),"city_state"!==e&&"city_state_zip"!==e){for(u(c("\n    <div class='fr_half has_sub_label'>\n      <label class=\"fr_sub_label\" for='")),u(this.domId()),u(c("_country'>")),u(FormRenderer.t.country),u(c("</label>\n      <select data-rv-value='model.value.country' data-width='100%' id='")),u(this.domId()),u(c("_country'>\n        ")),n=0,i=(a=FormRenderer.ORDERED_COUNTRIES).length;n<i;n++)l=a[n],u(c("\n          <option value='")),u(l),u(c("'>")),u(d[l]||"---"),u(c("</option>\n        "));u(c("\n      </select>\n    </div>\n  "))}u(c("\n</div>\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:c};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/block_of_text"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){e(r(JST["partials/labels"](this))),e(r("\n\n<div class='fr_text size_")),e(this.model.getSize()),e(r("'>\n  ")),e(this.safe(FormRenderer.formatAndSanitizeHTML(this.model.get("description")))),e(r("\n</div>\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/checkboxes"]=function(n){var o=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,i=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){var e,t,n,r;for(e=0,t=(r=this.model.getOptions()).length;e<t;e++)n=r[e],i(o("\n  <label class='fr_option control'>\n    <input type='checkbox' data-rv-checkedarray='model.value.checked' value=\"")),i(n.label),i(o('" />\n    ')),i(n.translated_label||n.label),i(o("\n  </label>\n"));i(o("\n\n")),this.model.get("include_other_option")&&(i(o("\n  <div class='fr_option fr_other_option'>\n    <label class='control'>\n      <input type='checkbox' data-rv-checked='model.value.other_checked' />\n      ")),i(FormRenderer.t.other),i(o("\n    </label>\n\n    <input type='text'\n           data-rv-show='model.value.other_checked'\n           data-rv-input='model.value.other_text'\n           placeholder='")),i(FormRenderer.t.write_here),i(o("' />\n  </div>\n"))),i(o("\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:o};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/confirm"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){e(r("<label class='fr_option control'>\n  <input type='checkbox' data-rv-checked='model.value' />\n  ")),e(this.model.get("label")),e(r(JST["partials/required"](this))),e(r("\n</label>\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/date"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){e(r("<div class='fr_grid'>\n  <div class='has_sub_label'>\n    <label class=\"fr_sub_label\" for=\"")),e(this.domId()),e(r('_month">MM</label>\n    <input type="text"\n           id="')),e(this.domId()),e(r("_month\"\n           data-rv-input='model.value.month'\n           maxlength='2'\n           size='2' />\n  </div>\n\n  <div class='fr_spacer'>/</div>\n\n  <div class='has_sub_label'>\n    <label class=\"fr_sub_label\" for=\"")),e(this.domId()),e(r("_day\">DD</label>\n    <input type=\"text\"\n           data-rv-input='model.value.day'\n           maxlength='2'\n           size='2'\n           id=\"")),e(this.domId()),e(r('_day" />\n  </div>\n\n  ')),this.model.get("disable_year")||(e(r("\n    <div class='fr_spacer'>/</div>\n\n    <div class='has_sub_label'>\n      <label class=\"fr_sub_label\" for=\"")),e(this.domId()),e(r("_year\">YYYY</label>\n      <input type=\"text\"\n             data-rv-input='model.value.year'\n             maxlength='4'\n             size='4'\n             id=\"")),e(this.domId()),e(r('_year" />\n    </div>\n  '))),e(r("\n</div>\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/dropdown"]=function(n){var o=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,i=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){var e,t,n,r;for(i(o('<select id="')),i(this.domId()),i(o("\" data-rv-value='model.value'>\n  ")),this.model.get("include_blank_option")&&(i(o('\n    <option selected value="">\n      ')),i(FormRenderer.t.choose_an_option),i(o("\n    </option>\n  "))),i(o("\n\n  ")),e=0,t=(r=this.model.getOptions()).length;e<t;e++)n=r[e],i(o('\n    <option value="')),i(n.label),i(o('">\n      ')),i(n.translated_label||n.label),i(o("\n    </option>\n  "));i(o("\n</select>\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:o};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/email"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){e(r('<input type="text" inputmode="email"\n       id="')),e(this.domId()),e(r("\"\n       data-rv-input='model.value' />\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/file"]=function(n){var s=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,o=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){var e,t,n,r,i;for(o(s("<div class='fr_files'>\n  ")),n=0,r=(i=this.model.getFiles()).length;n<r;n++)e=i[n],o(s("\n    <div class='fr_file'>\n      <span>")),o(e.filename),o(s("</span>\n      <button data-fr-remove-file class='")),o(FormRenderer.BUTTON_CLASS),o(s("'>")),o(FormRenderer.t.remove),o(s("</button>\n    </div>\n  "));o(s("\n</div>\n\n")),this.model.canAddFile()&&(o(s("\n  <div class='fr_add_file'>\n    <label for='")),o(this.domId()),o(s("' class='")),o(FormRenderer.BUTTON_CLASS),o(s("'>\n      ")),o(this.model.getFiles().length?FormRenderer.t.upload_another:FormRenderer.t.upload),o(s("\n    </label>\n\n    <input type='file'\n           id='")),o(this.domId()),o(s("'\n           ")),(t=this.model.getAcceptedExtensions())&&(o(s("\n            accept='")),o(t.join(",")),o(s("'\n           "))),o(s("\n           />\n\n    <span class='fr_error' style='display:none'></span>\n\n    ")),(t=this.model.getAcceptedExtensions())&&(o(s("\n      <div class='fr_description'>\n        ")),o(FormRenderer.t.we_accept),o(s(" ")),o(a.toSentence(t)),o(s("\n      </div>\n    "))),o(s("\n  </div>\n"))),o(s("\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:s};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/identification"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){e(r("<div class='fr_grid'>\n  <div class='fr_half'>\n    <label for='")),e(this.domId()),e(r("-name'>\n      ")),e(FormRenderer.t.name),e(r("\n\n      ")),this.dontRenderInputs()||e(r("\n        <abbr class='fr_required' title='required'>*</abbr>\n      ")),e(r("\n    </label>\n\n    ")),this.dontRenderInputs()?(e(r("\n      <span>")),e(this.model.get("value.name")),e(r("</span>\n    "))):(e(r("\n      <input type='text'\n             id='")),e(this.domId()),e(r("-name'\n             data-rv-input='model.value.name' />\n    "))),e(r("\n  </div>\n\n  <div class='fr_half'>\n    <label for='")),e(this.domId()),e(r("-email'>\n      ")),e(FormRenderer.t.email),e(r("\n      ")),this.dontRenderInputs()||e(r("\n        <abbr class='fr_required' title='required'>*</abbr>\n      ")),e(r("\n    </label>\n\n    ")),this.dontRenderInputs()?(e(r("\n      <span>")),e(this.model.get("value.email")),e(r("</span>\n    "))):(e(r('\n      <input type="text"\n             id=\'')),e(this.domId()),e(r("-email'\n             data-rv-input='model.value.email' />\n    "))),e(r("\n  </div>\n</div>\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/map_marker"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){e(r("<div class='fr_map_wrapper'>\n  <div class='fr_map_map' />\n\n  <div class='fr_map_cover'>\n    ")),e(FormRenderer.t.click_to_set),e(r("\n  </div>\n\n  <div class='fr_map_toolbar'>\n    <div class='fr_map_coord'>\n      <strong>")),e(FormRenderer.t.coordinates),e(r(":</strong>\n      <span data-rv-show='model.value'>\n        <span data-rv-text='model.value.0' />,\n        <span data-rv-text='model.value.1' />\n      </span>\n      <span data-rv-hide='model.value' class='fr_map_no_location'>")),e(FormRenderer.t.na),e(r("</span>\n    </div>\n    <a class='fr_map_clear' data-fr-clear-map data-rv-show='model.value' href='#'>")),e(FormRenderer.t.clear),e(r("</a>\n  </div>\n</div>\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/number"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){e(r('<input type="text"\n       id="')),e(this.domId()),e(r("\"\n       data-rv-input='model.value'\n       class=\"size_")),e(this.calculateSize()),e(r('" />\n\n')),this.model.get("units")&&(e(r("\n  <span class='fr_units'>\n    ")),e(this.model.get("units")),e(r("\n  </span>\n"))),e(r("\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/page_break"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this;return function(){var e;void 0!==(e=r("<div class='fr_page_break_inner'>\n  Page break\n</div>\n"))&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/paragraph"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){e(r('<textarea\n   id="')),e(this.domId()),e(r('"\n   class="size_')),e(this.model.getSize()),e(r("\"\n   data-rv-input='model.value' />\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/phone"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){e(r('<input type="text"\n       inputmode="tel"\n       id="')),e(this.domId()),e(r("\"\n       data-rv-input='model.value'\n       placeholder=\"")),e(this.phonePlaceholder()),e(r('" />\n'))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/price"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){e(r("<div class='fr_grid'>\n  <div class='fr_spacer'>$</div>\n\n  <div class='has_sub_label'>\n    <label class=\"fr_sub_label\" for=\"")),e(this.domId()),e(r('_dollars">')),e(FormRenderer.t.dollars),e(r('</label>\n    <input type="text"\n           id="')),e(this.domId()),e(r("_dollars\"\n           data-rv-input='model.value.dollars'\n           size='6' />\n  </div>\n\n  ")),this.model.get("disable_cents")||(e(r("\n    <div class='fr_spacer'>.</div>\n    <div class='has_sub_label'>\n      <label class=\"fr_sub_label\" for=\"")),e(this.domId()),e(r('_cents">')),e(FormRenderer.t.cents),e(r("</label>\n      <input type=\"text\"\n             data-rv-input='model.value.cents'\n             maxlength='2'\n             size='2'\n             id=\"")),e(this.domId()),e(r('_cents" />\n    </div>\n  '))),e(r("\n</div>\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/radio"]=function(n){var o=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,i=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){var e,t,n,r;for(e=0,t=(r=this.model.getOptions()).length;e<t;e++)n=r[e],i(o("\n  <label class='fr_option control'>\n    <input type='radio'\n           data-rv-dobtradiogroup='model.value.checked'\n           value=\"")),i(n.label),i(o('"\n    />\n    ')),i(n.translated_label||n.label),i(o("\n  </label>\n"));i(o("\n\n")),this.model.get("include_other_option")&&(i(o("\n  <div class='fr_option fr_other_option'>\n    <label class='control'>\n      <input type='radio'\n             data-rv-dobtradiogroup='model.value.checked'\n             class=\"js_other_option\"\n      />\n      ")),i(FormRenderer.t.other),i(o("\n    </label>\n\n    <input type='text'\n           data-rv-show='model.value.other_checked'\n           data-rv-input='model.value.other_text'\n           placeholder='")),i(FormRenderer.t.write_here),i(o("'\n    />\n  </div>\n"))),i(o("\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:o};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/section_break"]=function(n){var i=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,r=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){var e;r(i(JST["partials/labels"](this))),r(i("\n\n")),e=FormRenderer.formatAndSanitizeHTML(this.model.get("description")),r(i("\n<")),r(this.model.sizeToHeaderTag()),r(i(">")),r(this.model.get("label")),r(i("</")),r(this.model.sizeToHeaderTag()),r(i(">\n")),e&&(r(i("\n  <div class='fr_text size_")),r(this.model.getSize()),r(i("'>\n    ")),r(this.safe(e)),r(i("\n  </div>\n"))),r(i("\n\n<hr />\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:i};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/table"]=function(n){var m=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,p=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){var e,t,n,r,i,o,s,a,l,u,c,d,h,f;for(p(m("<table class='fr_table'>\n  <thead>\n    <tr>\n      ")),r=0,o=(c=this.model.getColumns()).length;r<o;r++)e=c[r],p(m("\n        <th>")),p(e.translated_label||e.label),p(m("</th>\n      "));for(p(m("\n\n      <th class='fr_table_col_remove'></th>\n    </tr>\n  </thead>\n\n  <tbody>\n    ")),t=i=0,d=this.model.numRows()-1;0<=d?i<=d:d<=i;t=0<=d?++i:--i){for(p(m('\n      <tr data-row-index="')),p(t),p(m('">\n        ')),n=l=0,s=(h=this.model.getColumns()).length;l<s;n=++l)e=h[n],p(m("\n          ")),this.model.getPresetValue(e.label,t)?(p(m("\n            <td class='fr_table_preset'>\n              <span data-rv-text='model.value.")),p(n),p(m(".")),p(t),p(m("'></span>\n          "))):(p(m("\n            <td>\n              <textarea data-rv-input='model.value.")),p(n),p(m(".")),p(t),p(m("'\n                        rows='1'\n                        aria-label=\"")),p(e.translated_label||e.label),p(m(" #")),p(t+1),p(m('"\n                        ')),0===n&&0===t&&(p(m("id='")),p(this.domId()),p(m("'"))),p(m(" />\n          "))),p(m("\n          </td>\n        "));p(m("\n\n        <td class='fr_table_col_remove'>\n          ")),this.canRemoveRow(t)&&(p(m("\n            <a class='js-remove-row' href='#'>\n              ")),p(m(FormRenderer.REMOVE_ROW_ICON)),p(m("\n            </a>\n          "))),p(m("\n        </td>\n      </tr>\n    "))}if(p(m("\n  </tbody>\n\n  ")),this.model.get("column_totals")){for(p(m("\n    <tfoot>\n      <tr>\n        ")),n=u=0,a=(f=this.model.getColumns()).length;u<a;n=++u)e=f[n],p(m("\n          <td data-rv-text='model.columnTotals.")),p(n),p(m("'></td>\n        "));p(m('\n        <td class="fr_table_col_remove"></td>\n      </tr>\n    </tfoot>\n  '))}p(m("\n</table>\n\n<div class='fr_table_add_row_wrapper'>\n  ")),this.model.canAddRows()&&(p(m("\n    <a class='js-add-row' href='#'>\n      ")),p(m(FormRenderer.ADD_ROW_ICON)),p(m("\n      ")),p(FormRenderer.t.add_another),p(m("\n    </a>\n  "))),p(m("\n</div>\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:m};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/text"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){e(r('<input type="text"\n       id="')),e(this.domId()),e(r('"\n       class="size_')),e(this.model.getSize()),e(r("\"\n       data-rv-input='model.value' />\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/time"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){e(r("<div class='fr_grid'>\n  <div class='has_sub_label'>\n    <label class=\"fr_sub_label\" for=\"")),e(this.domId()),e(r('_hours">HH</label>\n    <input type="text"\n           id="')),e(this.domId()),e(r("_hours\"\n           data-rv-input='model.value.hours'\n           maxlength='2'\n           size='2' />\n  </div>\n\n  <div class='fr_spacer'>:</div>\n\n  <div class='has_sub_label'>\n    <label class=\"fr_sub_label\" for=\"")),e(this.domId()),e(r("_minutes\">MM</label>\n    <input type=\"text\"\n           data-rv-input='model.value.minutes'\n           maxlength='2'\n           size='2'\n           id=\"")),e(this.domId()),e(r('_minutes" />\n  </div>\n\n  ')),this.model.get("disable_seconds")||(e(r("\n    <div class='fr_spacer'>:</div>\n\n    <div class='has_sub_label'>\n      <label class=\"fr_sub_label\" for=\"")),e(this.domId()),e(r("_seconds\">SS</label>\n      <input type=\"text\"\n             data-rv-input='model.value.seconds'\n             maxlength='2'\n             size='2'\n             id=\"")),e(this.domId()),e(r('_seconds" />\n    </div>\n  '))),e(r("\n\n  <div class='has_sub_label'>\n    <select data-rv-value='model.value.am_pm' data-width='auto' aria-label='AM/PM'>\n      <option value='AM'>AM</option>\n      <option value='PM'>PM</option>\n    </select>\n  </div>\n</div>\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["fields/website"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){e(r('<input type="text" inputmode="url"\n       id="')),e(this.domId()),e(r("\"\n       data-rv-input='model.value'\n       placeholder='http://' />\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST.main=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){e(r("<div class='fr_loading'>\n  ")),e(FormRenderer.t.loading_form),e(r("\n</div>\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["partials/description"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){this.model.get("description")&&(e(r("\n  <div class='fr_description'>\n    ")),e(this.safe(FormRenderer.formatAndSanitizeHTML(this.model.get("description")))),e(r("\n  </div>\n"))),e(r("\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["partials/error"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this;return function(){var e;void 0!==(e=r("<div class='fr_error' data-rv-show='model.error' data-rv-text='model.error'></div>\n"))&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["partials/label"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){e(r("<label ")),this.model.group||"fieldset"===this.model.wrapper?e(r('aria-hidden="true"')):(e(r('for="')),e(this.domId()),e(r('"'))),e(r(">\n  ")),e(this.model.get("label")),e(r(JST["partials/required"](this))),e(r("\n  ")),e(r(JST["partials/labels"](this))),e(r("\n</label>\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["partials/labels"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){this.showLabels&&(e(r("\n  ")),this.model.get("admin_only")&&(e(r("\n    <span class='label label_fb'><i class='fa fa-lock'></i>")),e(FormRenderer.t.hidden),e(r("</span>\n  "))),e(r("\n  ")),this.model.get("blind")&&(e(r("\n    <span class='label label_fb'><i class='fa fa-eye-slash'></i> ")),e(FormRenderer.t.blind),e(r("</span>\n  "))),e(r("\n  ")),this.model.isConditional()&&(e(r("\n    <span class='label label_fb'><i class='fa fa-code-fork'></i>")),e(FormRenderer.t.has_conditions),e(r("</span>\n  "))),e(r("\n"))),e(r("\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["partials/length_counter"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this;return function(){var e;void 0!==(e=r("<span class='fr_length_counter' data-rv-text='model.currentLength'></span>\n"))&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["partials/length_validations"]=function(n){var i=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,r=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){var e,t,n;t=this.model.get("minlength"),r(i("\n")),e=this.model.get("maxlength"),r(i("\n")),n=this.model.getLengthValidationUnits(),r(i("\n\n")),this.model.hasLengthValidation()&&(r(i("\n  <div class='fr_min_max'>\n    <span class='fr_min_max_guide'>\n      ")),t&&e?(r(i("\n        ")),t===e?(r(i("\n          ")),r(FormRenderer.t.enter_exactly.replace(":num",t))):(r(i("\n          ")),r(FormRenderer.t.enter_between.replace(":min",t).replace(":max",e))),r(i(" ")),r(FormRenderer.t[n]),r(i(".\n        ")),r(i("\n      "))):t?(r(i("\n        ")),r(FormRenderer.t.enter_at_least.replace(":min",t)),r(i(" ")),r(FormRenderer.t[n]),r(i(".\n      "))):e&&(r(i("\n        ")),r(FormRenderer.t.enter_up_to.replace(":max",e)),r(i(" ")),r(FormRenderer.t[n]),r(i(".\n      "))),r(i("\n    </span>\n\n    ")),r(i(JST["partials/length_counter"](this))),r(i("\n  </div>\n"))),r(i("\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:i};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["partials/min_max_validations"]=function(n){var i=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,r=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){var e,t;this.model.hasMinMaxValidation()&&(r(i("\n  ")),t=this.model.get("min"),r(i("\n  ")),e=this.model.get("max"),r(i("\n\n  <div class='fr_min_max'>\n    ")),t&&e?(r(i("\n      ")),r(FormRenderer.t.enter_between.replace(":min",t).replace(":max",e)),r(i(".\n    "))):t?(r(i("\n      ")),r(FormRenderer.t.enter_at_least.replace(":min",t)),r(i(".\n    "))):e&&(r(i("\n      ")),r(FormRenderer.t.enter_up_to.replace(":max",e)),r(i(".\n    "))),r(i("\n  </div>\n"))),r(i("\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:i};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["partials/non_input_response_field"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){e(r(JST["fields/"+this.model.field_type](this))),e(r("\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["partials/pagination"]=function(n){var s=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,o=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){var e,t,n,r,i;if(1<this.form_renderer.visiblePages().length){for(o(s("\n  <ul class='fr_pagination'>\n    ")),t=n=0,r=(i=this.form_renderer.visiblePages()).length;n<r;t=++n)e=i[t],o(s("\n      <li class='")),this.form_renderer.isPageValid(e)||o(s("has_errors")),o(s("'>\n        ")),e===this.form_renderer.state.get("activePage")?(o(s("\n          <span>")),o(t+1),o(s("</span>\n        </li>\n        "))):(o(s('\n          <a data-activate-page="')),o(e),o(s("\" href='#'>\n            ")),o(t+1),o(s("\n          </a>\n        "))),o(s("\n      </li>\n    "));o(s("\n  </ul>\n"))}o(s("\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:s};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["partials/repeating_group_entry"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){e(r("<div class='fr_group_entry_idx'><span>")),e(this.idx+1),e(r("</span></div>\n\n<div class='fr_group_entry_fields'>\n</div>\n\n")),this.entry.canRemove()&&(e(r("\n  <a href='#' class='js-remove-entry ")),e(r(FormRenderer.REMOVE_ENTRY_LINK_CLASS)),e(r("'>")),e(r(FormRenderer.REMOVE_ENTRY_LINK_HTML)),e(r("</a>\n"))),e(r("\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["partials/repeating_group"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){e(r("<fieldset class='fr_fieldset'>\n  <legend>")),e(this.model.get("label")),e(r("</legend>\n\n  ")),e(r(JST["partials/label"](this))),e(r('\n\n  <div class="fr_description">\n    ')),this.model.renderingRespondentForm()?(e(r("\n      ")),e(this.model.get("description"))):(e(r("\n      ")),e(this.model.getTruncatedDescription())),e(r("\n    ")),e(r("\n  </div>\n\n  ")),this.model.isSkipped()?(e(r("\n    <a href='#' class='js-skip fr_group_answer'>")),e(FormRenderer.t.answer),e(r("</a>\n    <div class='fr_group_skipped' style='clear: both'>")),e(FormRenderer.t.skipped),e(r("</div>\n  "))):(e(r("\n    ")),this.model.isRequired()||(e(r("\n      <a href='#' class='js-skip fr_group_skip'>")),e(FormRenderer.t.skip),e(r("</a>\n    "))),e(r("\n\n    <div class='fr_group_entries'>\n    </div>\n\n    ")),this.model.canAdd()&&(e(r("\n      <a href='#' class='js-add-entry ")),e(FormRenderer.BUTTON_CLASS),e(r("'>")),e(FormRenderer.t.add_another),e(r("</a>\n    "))),e(r("\n  "))),e(r("\n</fieldset>\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["partials/required"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){this.model.get("required")&&e(r("&nbsp;<abbr class='fr_required' title='required'>*</abbr>")),e(r("\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["partials/response_field"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){"fieldset"===this.model.wrapper?(e(r("\n  <fieldset class='fr_fieldset'>\n    <legend>")),e(this.model.get("label")),e(r("</legend>\n    ")),e(r(JST["partials/label"](this))),e(r("\n    <div class='fr_field_wrapper'>\n      ")),e(r(JST["fields/"+this.model.field_type](this))),e(r("\n    </div>\n  </fieldset>\n"))):("label"===this.model.wrapper&&(e(r("\n  ")),e(r(JST["partials/label"](this)))),e(r("\n  <div class='fr_field_wrapper'>\n    ")),e(r(JST["fields/"+this.model.field_type](this))),e(r("\n  </div>\n"))),e(r("\n\n")),e(r(JST["partials/length_validations"](this))),e(r("\n")),e(r(JST["partials/min_max_validations"](this))),e(r("\n")),e(r(JST["partials/error"](this))),e(r("\n")),e(r(JST["partials/description"](this))),e(r("\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["plugins/bookmark_draft"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){e(r("<div class='fr_bookmark'>\n  <a href='#' class='js-fr-bookmark'>")),e(FormRenderer.t.finish_later),e(r("</a>\n</div>\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["plugins/bottom_bar"]=function(n){var i=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,r=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};r(i("<div class='fr_bottom'>\n  ")),0<=e.call(this.form_renderer.options.plugins,"Autosave")&&(r(i("\n    <div class='fr_bottom_l'>\n      ")),this.form_renderer.state.get("hasServerErrors")?(r(i("\n        ")),r(this.form_renderer.state.get("serverErrorText")||FormRenderer.t.error_saving)):this.form_renderer.state.get("hasChanges")?(r(i("\n        ")),r(FormRenderer.t.saving)):(r(i("\n        ")),r(FormRenderer.t.saved)),r(i("\n      ")),r(i("\n    </div>\n  "))),r(i("\n\n  <div class='fr_bottom_r'>\n    ")),this.form_renderer.isFirstPage()||(r(i("\n      <button data-fr-previous-page class='")),r(FormRenderer.BUTTON_CLASS),r(i("'>\n        ")),r(FormRenderer.t.back_to_page.replace(":num",this.form_renderer.previousPage())),r(i("\n      </button>\n    "))),r(i("\n\n    ")),this.form_renderer.state.get("submitting")?(r(i("\n      <button disabled class='")),r(FormRenderer.BUTTON_CLASS),r(i("'>\n        ")),r(FormRenderer.t.submitting)):(r(i("\n      <button data-fr-next-page class='")),r(FormRenderer.BUTTON_CLASS),r(i("'>\n        ")),this.form_renderer.isLastPage()||!this.form_renderer.options.enablePages?r(FormRenderer.t.submit):r(FormRenderer.t.next_page)),r(i("\n      </button>\n    ")),r(i("\n  </div>\n</div>\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:i};for(e in n)t[e]=n[e];return t}())},j.JST||(j.JST={}),j.JST["plugins/error_bar"]=function(n){var r=function(e){void 0===e&&null==e&&(e="");var t=new String(e);return t.ecoSafe=!0,t};return function(){var t=[],n=this,e=function(e){void 0!==e&&null!=e&&t.push(e.ecoSafe?e:n.escape(e))};return function(){this.form_renderer.areAllPagesValid()||(e(r("\n  <div class='fr_error_alert_bar' role='alert'>\n    ")),e(r(FormRenderer.t.error_bar.errors)),e(r("\n  </div>\n"))),e(r("\n"))}.call(this),t.join("")}.call(function(){var e,t={escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:r};for(e in n)t[e]=n[e];return t}())}}(window);