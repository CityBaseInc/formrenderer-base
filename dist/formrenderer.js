!function(a){!function(b){"function"==typeof define&&define.amd?define(["jquery"],b):b("undefined"!=typeof jQuery?jQuery:a.Zepto)}(function(b){"use strict";function c(a){var c=a.data;a.isDefaultPrevented()||(a.preventDefault(),b(a.target).ajaxSubmit(c))}function d(a){var c=a.target,d=b(c);if(!d.is("[type=submit],[type=image]")){var e=d.closest("[type=submit]");if(0===e.length)return;c=e[0]}var f=this;if(f.clk=c,"image"==c.type)if(void 0!==a.offsetX)f.clk_x=a.offsetX,f.clk_y=a.offsetY;else if("function"==typeof b.fn.offset){var g=d.offset();f.clk_x=a.pageX-g.left,f.clk_y=a.pageY-g.top}else f.clk_x=a.pageX-c.offsetLeft,f.clk_y=a.pageY-c.offsetTop;setTimeout(function(){f.clk=f.clk_x=f.clk_y=null},100)}function e(){if(b.fn.ajaxSubmit.debug){var c="[jquery.form] "+Array.prototype.join.call(arguments,"");a.console&&a.console.log?a.console.log(c):a.opera&&a.opera.postError&&a.opera.postError(c)}}var f={};f.fileapi=void 0!==b("<input type='file'/>").get(0).files,f.formdata=void 0!==a.FormData;var g=!!b.fn.prop;b.fn.attr2=function(){if(!g)return this.attr.apply(this,arguments);var a=this.prop.apply(this,arguments);return a&&a.jquery||"string"==typeof a?a:this.attr.apply(this,arguments)},b.fn.ajaxSubmit=function(c){function d(a){var d,e,f=b.param(a,c.traditional).split("&"),g=f.length,h=[];for(d=0;d<g;d++)f[d]=f[d].replace(/\+/g," "),e=f[d].split("="),h.push([decodeURIComponent(e[0]),decodeURIComponent(e[1])]);return h}function h(a){for(var e=new FormData,f=0;f<a.length;f++)e.append(a[f].name,a[f].value);if(c.extraData){var g=d(c.extraData);for(f=0;f<g.length;f++)g[f]&&e.append(g[f][0],g[f][1])}c.data=null;var h=b.extend(!0,{},b.ajaxSettings,c,{contentType:!1,processData:!1,cache:!1,type:j||"POST"});c.uploadProgress&&(h.xhr=function(){var a=b.ajaxSettings.xhr();return a.upload&&a.upload.addEventListener("progress",function(a){var b=0,d=a.loaded||a.position,e=a.total;a.lengthComputable&&(b=Math.ceil(d/e*100)),c.uploadProgress(a,d,e,b)},!1),a}),h.data=null;var i=h.beforeSend;return h.beforeSend=function(a,b){c.formData?b.data=c.formData:b.data=e,i&&i.call(this,a,b)},b.ajax(h)}function i(d){function f(a){var b=null;try{a.contentWindow&&(b=a.contentWindow.document)}catch(a){e("cannot get iframe.contentWindow document: "+a)}if(b)return b;try{b=a.contentDocument?a.contentDocument:a.document}catch(c){e("cannot get iframe.contentDocument: "+c),b=a.document}return b}function h(){function a(){try{var b=f(s).readyState;e("state = "+b),b&&"uninitialized"==b.toLowerCase()&&setTimeout(a,50)}catch(a){e("Server abort: ",a," (",a.name,")"),i(B),x&&clearTimeout(x),x=void 0}}var c=m.attr2("target"),d=m.attr2("action");y.setAttribute("target",p),j&&!/post/i.test(j)||y.setAttribute("method","POST"),d!=n.url&&y.setAttribute("action",n.url),n.skipEncodingOverride||j&&!/post/i.test(j)||m.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),n.timeout&&(x=setTimeout(function(){w=!0,i(A)},n.timeout));var g=[];try{if(n.extraData)for(var h in n.extraData)n.extraData.hasOwnProperty(h)&&(b.isPlainObject(n.extraData[h])&&n.extraData[h].hasOwnProperty("name")&&n.extraData[h].hasOwnProperty("value")?g.push(b('<input type="hidden" name="'+n.extraData[h].name+'">').val(n.extraData[h].value).appendTo(y)[0]):g.push(b('<input type="hidden" name="'+h+'">').val(n.extraData[h]).appendTo(y)[0]));n.iframeTarget||r.appendTo("body"),s.attachEvent?s.attachEvent("onload",i):s.addEventListener("load",i,!1),setTimeout(a,15);try{y.submit()}catch(a){var k=document.createElement("form").submit;k.apply(y)}}finally{y.setAttribute("action",d),c?y.setAttribute("target",c):m.removeAttr("target"),b(g).remove()}}function i(c){if(!t.aborted&&!G){if(F=f(s),F||(e("cannot access response document"),c=B),c===A&&t)return t.abort("timeout"),void z.reject(t,"timeout");if(c==B&&t)return t.abort("server abort"),void z.reject(t,"error","server abort");if(F&&F.location.href!=n.iframeSrc||w){s.detachEvent?s.detachEvent("onload",i):s.removeEventListener("load",i,!1);var d,g="success";try{if(w)throw"timeout";var h="xml"==n.dataType||F.XMLDocument||b.isXMLDoc(F);if(e("isXml="+h),!h&&a.opera&&(null===F.body||!F.body.innerHTML)&&--H)return e("requeing onLoad callback, DOM not available"),void setTimeout(i,250);var j=F.body?F.body:F.documentElement;t.responseText=j?j.innerHTML:null,t.responseXML=F.XMLDocument?F.XMLDocument:F,h&&(n.dataType="xml"),t.getResponseHeader=function(a){return{"content-type":n.dataType}[a.toLowerCase()]},j&&(t.status=Number(j.getAttribute("status"))||t.status,t.statusText=j.getAttribute("statusText")||t.statusText);var k=(n.dataType||"").toLowerCase(),l=/(json|script|text)/.test(k);if(l||n.textarea){var m=F.getElementsByTagName("textarea")[0];if(m)t.responseText=m.value,t.status=Number(m.getAttribute("status"))||t.status,t.statusText=m.getAttribute("statusText")||t.statusText;else if(l){var p=F.getElementsByTagName("pre")[0],q=F.getElementsByTagName("body")[0];p?t.responseText=p.textContent?p.textContent:p.innerText:q&&(t.responseText=q.textContent?q.textContent:q.innerText)}}else"xml"==k&&!t.responseXML&&t.responseText&&(t.responseXML=I(t.responseText));try{E=K(t,k,n)}catch(a){g="parsererror",t.error=d=a||g}}catch(a){e("error caught: ",a),g="error",t.error=d=a||g}t.aborted&&(e("upload aborted"),g=null),t.status&&(g=t.status>=200&&t.status<300||304===t.status?"success":"error"),"success"===g?(n.success&&n.success.call(n.context,E,"success",t),z.resolve(t.responseText,"success",t),o&&b.event.trigger("ajaxSuccess",[t,n])):g&&(void 0===d&&(d=t.statusText),n.error&&n.error.call(n.context,t,g,d),z.reject(t,"error",d),o&&b.event.trigger("ajaxError",[t,n,d])),o&&b.event.trigger("ajaxComplete",[t,n]),o&&!--b.active&&b.event.trigger("ajaxStop"),n.complete&&n.complete.call(n.context,t,g),G=!0,n.timeout&&clearTimeout(x),setTimeout(function(){n.iframeTarget?r.attr("src",n.iframeSrc):r.remove(),t.responseXML=null},100)}}}var k,l,n,o,p,r,s,t,u,v,w,x,y=m[0],z=b.Deferred();if(z.abort=function(a){t.abort(a)},d)for(l=0;l<q.length;l++)k=b(q[l]),g?k.prop("disabled",!1):k.removeAttr("disabled");if(n=b.extend(!0,{},b.ajaxSettings,c),n.context=n.context||n,p="jqFormIO"+(new Date).getTime(),n.iframeTarget?(r=b(n.iframeTarget),v=r.attr2("name"),v?p=v:r.attr2("name",p)):(r=b('<iframe name="'+p+'" src="'+n.iframeSrc+'" />'),r.css({position:"absolute",top:"-1000px",left:"-1000px"})),s=r[0],t={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(a){var c="timeout"===a?"timeout":"aborted";e("aborting upload... "+c),this.aborted=1;try{s.contentWindow.document.execCommand&&s.contentWindow.document.execCommand("Stop")}catch(a){}r.attr("src",n.iframeSrc),t.error=c,n.error&&n.error.call(n.context,t,c,a),o&&b.event.trigger("ajaxError",[t,n,c]),n.complete&&n.complete.call(n.context,t,c)}},o=n.global,o&&0==b.active++&&b.event.trigger("ajaxStart"),o&&b.event.trigger("ajaxSend",[t,n]),n.beforeSend&&!1===n.beforeSend.call(n.context,t,n))return n.global&&b.active--,z.reject(),z;if(t.aborted)return z.reject(),z;(u=y.clk)&&(v=u.name)&&!u.disabled&&(n.extraData=n.extraData||{},n.extraData[v]=u.value,"image"==u.type&&(n.extraData[v+".x"]=y.clk_x,n.extraData[v+".y"]=y.clk_y));var A=1,B=2,C=b("meta[name=csrf-token]").attr("content"),D=b("meta[name=csrf-param]").attr("content");D&&C&&(n.extraData=n.extraData||{},n.extraData[D]=C),n.forceSync?h():setTimeout(h,10);var E,F,G,H=50,I=b.parseXML||function(b,c){return a.ActiveXObject?(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(b)):c=(new DOMParser).parseFromString(b,"text/xml"),c&&c.documentElement&&"parsererror"!=c.documentElement.nodeName?c:null},J=b.parseJSON||function(b){return a.eval("("+b+")")},K=function(a,c,d){var e=a.getResponseHeader("content-type")||"",f="xml"===c||!c&&e.indexOf("xml")>=0,g=f?a.responseXML:a.responseText;return f&&"parsererror"===g.documentElement.nodeName&&b.error&&b.error("parsererror"),d&&d.dataFilter&&(g=d.dataFilter(g,c)),"string"==typeof g&&("json"===c||!c&&e.indexOf("json")>=0?g=J(g):("script"===c||!c&&e.indexOf("javascript")>=0)&&b.globalEval(g)),g};return z}if(!this.length)return e("ajaxSubmit: skipping submit process - no element selected"),this;var j,k,l,m=this;"function"==typeof c?c={success:c}:void 0===c&&(c={}),j=c.type||this.attr2("method"),k=c.url||this.attr2("action"),l="string"==typeof k?b.trim(k):"",l=l||a.location.href||"",l&&(l=(l.match(/^([^#]+)/)||[])[1]),c=b.extend(!0,{url:l,success:b.ajaxSettings.success,type:j||b.ajaxSettings.type,iframeSrc:/^https/i.test(a.location.href||"")?"javascript:false":"about:blank"},c);var n={};if(this.trigger("form-pre-serialize",[this,c,n]),n.veto)return e("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(c.beforeSerialize&&!1===c.beforeSerialize(this,c))return e("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var o=c.traditional;void 0===o&&(o=b.ajaxSettings.traditional);var p,q=[],r=this.formToArray(c.semantic,q);if(c.data&&(c.extraData=c.data,p=b.param(c.data,o)),c.beforeSubmit&&!1===c.beforeSubmit(r,this,c))return e("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[r,this,c,n]),n.veto)return e("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var s=b.param(r,o);p&&(s=s?s+"&"+p:p),"GET"==c.type.toUpperCase()?(c.url+=(c.url.indexOf("?")>=0?"&":"?")+s,c.data=null):c.data=s;var t=[];if(c.resetForm&&t.push(function(){m.resetForm()}),c.clearForm&&t.push(function(){m.clearForm(c.includeHidden)}),!c.dataType&&c.target){var u=c.success||function(){};t.push(function(a){var d=c.replaceTarget?"replaceWith":"html";b(c.target)[d](a).each(u,arguments)})}else c.success&&t.push(c.success);if(c.success=function(a,b,d){for(var e=c.context||this,f=0,g=t.length;f<g;f++)t[f].apply(e,[a,b,d||m,m])},c.error){var v=c.error;c.error=function(a,b,d){var e=c.context||this;v.apply(e,[a,b,d,m])}}if(c.complete){var w=c.complete;c.complete=function(a,b){var d=c.context||this;w.apply(d,[a,b,m])}}var x=b("input[type=file]:enabled",this).filter(function(){return""!==b(this).val()}),y=x.length>0,z="multipart/form-data",A=m.attr("enctype")==z||m.attr("encoding")==z,B=f.fileapi&&f.formdata;e("fileAPI :"+B);var C,D=(y||A)&&!B;!1!==c.iframe&&(c.iframe||D)?c.closeKeepAlive?b.get(c.closeKeepAlive,function(){C=i(r)}):C=i(r):C=(y||A)&&B?h(r):b.ajax(c),m.removeData("jqxhr").data("jqxhr",C);for(var E=0;E<q.length;E++)q[E]=null;return this.trigger("form-submit-notify",[this,c]),this},b.fn.ajaxForm=function(a){if(a=a||{},a.delegation=a.delegation&&b.isFunction(b.fn.on),!a.delegation&&0===this.length){var f={s:this.selector,c:this.context};return!b.isReady&&f.s?(e("DOM not ready, queuing ajaxForm"),b(function(){b(f.s,f.c).ajaxForm(a)}),this):(e("terminating; zero elements found by selector"+(b.isReady?"":" (DOM not ready)")),this)}return a.delegation?(b(document).off("submit.form-plugin",this.selector,c).off("click.form-plugin",this.selector,d).on("submit.form-plugin",this.selector,a,c).on("click.form-plugin",this.selector,a,d),this):this.ajaxFormUnbind().bind("submit.form-plugin",a,c).bind("click.form-plugin",a,d)},b.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},b.fn.formToArray=function(a,c){var d=[];if(0===this.length)return d;var e=this[0],g=a?e.getElementsByTagName("*"):e.elements;if(!g)return d;var h,i,j,k,l,m,n;for(h=0,m=g.length;h<m;h++)if(l=g[h],(j=l.name)&&!l.disabled)if(a&&e.clk&&"image"==l.type)e.clk==l&&(d.push({name:j,value:b(l).val(),type:l.type}),d.push({name:j+".x",value:e.clk_x},{name:j+".y",value:e.clk_y}));else if((k=b.fieldValue(l,!0))&&k.constructor==Array)for(c&&c.push(l),i=0,n=k.length;i<n;i++)d.push({name:j,value:k[i]});else if(f.fileapi&&"file"==l.type){c&&c.push(l);var o=l.files;if(o.length)for(i=0;i<o.length;i++)d.push({name:j,value:o[i],type:l.type});else d.push({name:j,value:"",type:l.type})}else null!==k&&void 0!==k&&(c&&c.push(l),d.push({name:j,value:k,type:l.type,required:l.required}));if(!a&&e.clk){var p=b(e.clk),q=p[0];j=q.name,j&&!q.disabled&&"image"==q.type&&(d.push({name:j,value:p.val()}),d.push({name:j+".x",value:e.clk_x},{name:j+".y",value:e.clk_y}))}return d},b.fn.formSerialize=function(a){return b.param(this.formToArray(a))},b.fn.fieldSerialize=function(a){var c=[];return this.each(function(){var d=this.name;if(d){var e=b.fieldValue(this,a);if(e&&e.constructor==Array)for(var f=0,g=e.length;f<g;f++)c.push({name:d,value:e[f]});else null!==e&&void 0!==e&&c.push({name:this.name,value:e})}}),b.param(c)},b.fn.fieldValue=function(a){for(var c=[],d=0,e=this.length;d<e;d++){var f=this[d],g=b.fieldValue(f,a);null===g||void 0===g||g.constructor==Array&&!g.length||(g.constructor==Array?b.merge(c,g):c.push(g))}return c},b.fieldValue=function(a,c){var d=a.name,e=a.type,f=a.tagName.toLowerCase();if(void 0===c&&(c=!0),c&&(!d||a.disabled||"reset"==e||"button"==e||("checkbox"==e||"radio"==e)&&!a.checked||("submit"==e||"image"==e)&&a.form&&a.form.clk!=a||"select"==f&&-1==a.selectedIndex))return null;if("select"==f){var g=a.selectedIndex;if(g<0)return null;for(var h=[],i=a.options,j="select-one"==e,k=j?g+1:i.length,l=j?g:0;l<k;l++){var m=i[l];if(m.selected){var n=m.value;if(n||(n=m.attributes&&m.attributes.value&&!m.attributes.value.specified?m.text:m.value),j)return n;h.push(n)}}return h}return b(a).val()},b.fn.clearForm=function(a){return this.each(function(){b("input,select,textarea",this).clearFields(a)})},b.fn.clearFields=b.fn.clearInputs=function(a){var c=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var d=this.type,e=this.tagName.toLowerCase();c.test(d)||"textarea"==e?this.value="":"checkbox"==d||"radio"==d?this.checked=!1:"select"==e?this.selectedIndex=-1:"file"==d?/MSIE/.test(navigator.userAgent)?b(this).replaceWith(b(this).clone(!0)):b(this).val(""):a&&(!0===a&&/hidden/.test(d)||"string"==typeof a&&b(this).is(a))&&(this.value="")})},b.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},b.fn.enable=function(a){return void 0===a&&(a=!0),this.each(function(){this.disabled=!a})},b.fn.selected=function(a){return void 0===a&&(a=!0),this.each(function(){var c=this.type;if("checkbox"==c||"radio"==c)this.checked=a;else if("option"==this.tagName.toLowerCase()){var d=b(this).parent("select");a&&d[0]&&"select-one"==d[0].type&&d.find("option").selected(!1),this.selected=a}})},b.fn.ajaxSubmit.debug=!1});var b=[].slice;!function(a,c){var d;d=function(){function b(b,c){var d,e,f;this.$input=b,this.options=a.extend({},this.defaults,c,this.$input.data("ifu-options")),d=this.$input.closest("form"),(e=this.options).action||(e.action=d.attr("action")),(f=this.options).method||(f.method=d.find("[name=_method]").val()||d.attr("method")),this._bindInputChange()}return b.prototype.defaults={name:"file",action:void 0,method:void 0,additionalParams:{},ajaxOpts:{}},b.prototype._baseParams=function(){return a.extend({inline_file_upload:!0},this.options.additionalParams)},b.prototype._ajaxUpload=function(){var b;return b=this._createTemporaryForm(),b.ajaxSubmit(a.extend({dataType:"json",data:this._baseParams(),uploadProgress:function(a){return function(b,c,d,e){var f,g;return g={percent:e},"function"==typeof(f=a.options).progress&&f.progress(g),a.$input.trigger("inline_file_upload:progress",g)}}(this),success:function(a){return function(b){var c,d;return d={data:b},"function"==typeof(c=a.options).success&&c.success(d),a.$input.trigger("inline_file_upload:success",d)}}(this),error:function(a){return function(b){var c,d;return d={xhr:b},"function"==typeof(c=a.options).error&&c.error(d),a.$input.trigger("inline_file_upload:error",d)}}(this),complete:function(a){return function(c){var d,e;return b.remove(),e={xhr:c},"function"==typeof(d=a.options).complete&&d.complete(e),a.$input.trigger("inline_file_upload:complete",e)}}(this)},this.options.ajaxOpts))},b.prototype._createTemporaryForm=function(){var b,c;return c=a("<form action='"+this.options.action+"' method='post' style='position:fixed;left:-9999px;'>\n  <input type='hidden' name='_method' value='"+this.options.method+"' />\n</form>"),b=this.$input,this.$input=b.clone().val("").insertBefore(b),this._bindInputChange(),b.appendTo(c),b.attr("name",this.options.name),c.insertBefore(this.$input),c},b.prototype._eventToFilename=function(a){return null!=a.target.files?a.target.files[0].name:a.target.value?a.target.value.replace(/^.+\\/,""):void 0},b.prototype._onChange=function(a){var b,c;if(this.$input.val())return c={filename:this._eventToFilename(a)},"function"==typeof(b=this.options).start&&b.start(c),this.$input.trigger("inline_file_upload:start",c),this._ajaxUpload()},b.prototype._bindInputChange=function(){return this.$input.on("change",a.proxy(this._onChange,this))},b}(),a.fn.extend({inlineFileUpload:function(){var c,e;return e=arguments[0],c=2<=arguments.length?b.call(arguments,1):[],this.each(function(){var b;if(b=a(this).data("inline-file-upload"),b||a(this).data("inline-file-upload",b=new d(a(this),e)),"string"==typeof e)return b[e].apply(b,c)})}})}(a.jQuery),function(b){var c=!1;if("function"==typeof define&&define.amd&&(define(b),c=!0),"object"==typeof exports&&(module.exports=b(),c=!0),!c){var d=a.Cookies,e=a.Cookies=b();e.noConflict=function(){return a.Cookies=d,e}}}(function(){function a(){for(var a=0,b={};a<arguments.length;a++){var c=arguments[a];for(var d in c)b[d]=c[d]}return b}function b(c){function d(b,e,f){var g;if("undefined"!=typeof document){if(arguments.length>1){if(f=a({path:"/"},d.defaults,f),"number"==typeof f.expires){var h=new Date;h.setMilliseconds(h.getMilliseconds()+864e5*f.expires),f.expires=h}try{g=JSON.stringify(e),/^[\{\[]/.test(g)&&(e=g)}catch(a){}return e=c.write?c.write(e,b):encodeURIComponent(String(e)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),b=encodeURIComponent(String(b)),b=b.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),b=b.replace(/[\(\)]/g,escape),document.cookie=[b,"=",e,f.expires?"; expires="+f.expires.toUTCString():"",f.path?"; path="+f.path:"",f.domain?"; domain="+f.domain:"",f.secure?"; secure":""].join("")}b||(g={});for(var i=document.cookie?document.cookie.split("; "):[],j=/(%[0-9A-Z]{2})+/g,k=0;k<i.length;k++){var l=i[k].split("="),m=l.slice(1).join("=");'"'===m.charAt(0)&&(m=m.slice(1,-1));try{var n=l[0].replace(j,decodeURIComponent);if(m=c.read?c.read(m,n):c(m,n)||m.replace(j,decodeURIComponent),this.json)try{m=JSON.parse(m)}catch(a){}if(b===n){g=m;break}b||(g[n]=m)}catch(a){}}return g}}return d.set=d,d.get=function(a){return d.call(d,a)},d.getJSON=function(){return d.apply({json:!0},[].slice.call(arguments))},d.defaults={},d.remove=function(b,c){d(b,"",a(c,{expires:-1}))},d.withConverter=b,d}return b(function(){})}),function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?void(this._wrapped=a):new x(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.6.0";var y=x.each=x.forEach=function(a,b,d){if(null==a)return a;if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g=x.keys(a),e=0,f=g.length;e<f;e++)if(b.call(d,a[g[e]],g[e],a)===c)return;return a};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){if(!(e=e&&b.call(d,a,f,g)))return c}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){if(e||(e=b.call(d,a,f,g)))return c}),!!e)};x.contains=x.include=function(a,b){return null!=a&&(s&&a.indexOf===s?-1!=a.indexOf(b):A(a,function(a){return a===b}))},x.invoke=function(a,b){var c=h.call(arguments,2),d=x.isFunction(b);return x.map(a,function(a){return(d?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,x.property(b))},x.where=function(a,b){return x.filter(a,x.matches(b))},x.findWhere=function(a,b){return x.find(a,x.matches(b))},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);var d=-1/0,e=-1/0;return y(a,function(a,f,g){var h=b?b.call(c,a,f,g):a;h>e&&(d=a,e=h)}),d},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);var d=1/0,e=1/0;return y(a,function(a,f,g){var h=b?b.call(c,a,f,g):a;h<e&&(d=a,e=h)}),d},x.shuffle=function(a){var b,c=0,d=[];return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d},x.sample=function(a,b,c){return null==b||c?(a.length!==+a.length&&(a=x.values(a)),a[x.random(a.length-1)]):x.shuffle(a).slice(0,Math.max(0,b))};var B=function(a){return null==a?x.identity:x.isFunction(a)?a:x.property(a)};x.sortBy=function(a,b,c){return b=B(b),x.pluck(x.map(a,function(a,d,e){return{value:a,index:d,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(c<d||void 0===d)return-1}return a.index-b.index}),"value")};var C=function(a){return function(b,c,d){var e={};return c=B(c),y(b,function(f,g){var h=c.call(d,f,g,b);a(e,h,f)}),e}};x.groupBy=C(function(a,b,c){x.has(a,b)?a[b].push(c):a[b]=[c]}),x.indexBy=C(function(a,b,c){a[b]=c}),x.countBy=C(function(a,b){x.has(a,b)?a[b]++:a[b]=1}),x.sortedIndex=function(a,b,c,d){c=B(c);for(var e=c.call(d,b),f=0,g=a.length;f<g;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){if(null!=a)return null==b||c?a[0]:b<0?[]:h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){if(null!=a)return null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){return b&&x.every(a,x.isArray)?i.apply(c,a):(y(a,function(a){x.isArray(a)||x.isArguments(a)?b?g.apply(c,a):D(a,b,c):c.push(a)}),c)};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.partition=function(a,b){var c=[],d=[];return y(a,function(a){(b(a)?c:d).push(a)}),[c,d]},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))}),f},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.contains(b,a)})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){for(var a=x.max(x.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;c<a;c++)b[c]=x.pluck(arguments,""+c);return b},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;d<e;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;d=c<0?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;d<e;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);e<d;)f[e++]=a,a+=c;return f};var E=function(){};x.bind=function(a,b){var c,d;if(w&&a.bind===w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return c=h.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));E.prototype=a.prototype;var e=new E;E.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));return Object(f)===f?f:e}},x.partial=function(a){var b=h.call(arguments,1);return function(){for(var c=0,d=b.slice(),e=0,f=d.length;e<f;e++)d[e]===x&&(d[e]=arguments[c++]);for(;c<arguments.length;)d.push(arguments[c++]);return a.apply(this,d)}},x.bindAll=function(a){var b=h.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=!1===c.leading?0:x.now(),g=null,f=a.apply(d,e),d=e=null};return function(){var j=x.now();h||!1!==c.leading||(h=j);var k=b-(j-h);return d=this,e=arguments,k<=0?(clearTimeout(g),g=null,h=j,f=a.apply(d,e),d=e=null):g||!1===c.trailing||(g=setTimeout(i,k)),f}},x.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=x.now()-g;j<b?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),f=e=null))};return function(){f=this,e=arguments,g=x.now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return x.partial(b,a)},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return function(){if(--a<1)return b.apply(this,arguments)}},x.keys=function(a){if(!x.isObject(a))return[];if(v)return v(a);var b=[];for(var c in a)x.has(a,c)&&b.push(c);return b},x.values=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;e<c;e++)d[e]=a[b[e]];return d},x.pairs=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;e<c;e++)d[e]=[b[e],a[b[e]]];return d},x.invert=function(a){for(var b={},c=x.keys(a),d=0,e=c.length;d<e;d++)b[a[c[d]]]=c[d];return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a};var F=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(x.isFunction(g)&&g instanceof g&&x.isFunction(h)&&h instanceof h)&&"constructor"in a&&"constructor"in b)return!1;c.push(a),d.push(b);var i=0,k=!0;if("[object Array]"==e){if(i=a.length,k=i==b.length)for(;i--&&(k=F(a[i],b[i],c,d)););}else{for(var l in a)if(x.has(a,l)&&(i++,!(k=x.has(b,l)&&F(a[l],b[l],c,d))))break;if(k){for(l in b)if(x.has(b,l)&&!i--)break;k=!i}}return c.pop(),d.pop(),k};x.isEqual=function(a,b){return F(a,b,[],[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!==a.nodeType)},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(a){return"function"==typeof a}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.constant=function(a){return function(){return a}},x.property=function(a){return function(b){return b[a]}},x.matches=function(a){return function(b){if(b===a)return!0;for(var c in a)if(a[c]!==b[c])return!1;return!0}},x.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;e<a;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},x.now=Date.now||function(){return(new Date).getTime()};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};G.unescape=x.invert(G.escape);var H={escape:new RegExp("["+x.keys(G.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(G.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(H[a],function(b){return G[a][b]})}}),x.result=function(a,b){if(null!=a){var c=a[b];return x.isFunction(c)?c.call(a):c}},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),M.call(this,c.apply(x,a))}})};var I=0;x.uniqueId=function(a){var b=++I+"";return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(a,b,c){var d;c=x.defaults({},c,x.templateSettings);var e=new RegExp([(c.escape||J).source,(c.interpolate||J).source,(c.evaluate||J).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(L,function(a){return"\\"+K[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(a){throw a.source=g,a}if(b)return d(b,x);var h=function(a){return d.call(this,a,x)};return h.source="function("+(c.variable||"obj")+"){\n"+g+"}",h},x.chain=function(a){return x(a).chain()};var M=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],M.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return M.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return x})}.call(this),function(a,b){if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(c,d,e){a.Backbone=b(a,e,c,d)});else if("undefined"!=typeof exports){var c=require("underscore");b(a,exports,c)}else a.Backbone=b(a,{},a._,a.jQuery||a.Zepto||a.ender||a.$)}(this,function(b,c,d,e){var f=b.Backbone,g=[],h=(g.push,g.slice);g.splice;c.VERSION="1.1.2",c.$=e,c.noConflict=function(){return b.Backbone=f,this},c.emulateHTTP=!1,c.emulateJSON=!1;var i=c.Events={on:function(a,b,c){return k(this,"on",a,[b,c])&&b?(this._events||(this._events={}),(this._events[a]||(this._events[a]=[])).push({callback:b,context:c,ctx:c||this}),this):this},once:function(a,b,c){if(!k(this,"once",a,[b,c])||!b)return this;var e=this,f=d.once(function(){e.off(a,f),b.apply(this,arguments)});return f._callback=b,this.on(a,f,c)},off:function(a,b,c){var e,f,g,h,i,j,l,m;if(!this._events||!k(this,"off",a,[b,c]))return this;if(!a&&!b&&!c)return this._events=void 0,this;for(h=a?[a]:d.keys(this._events),i=0,j=h.length;i<j;i++)if(a=h[i],g=this._events[a]){if(this._events[a]=e=[],b||c)for(l=0,m=g.length;l<m;l++)f=g[l],(b&&b!==f.callback&&b!==f.callback._callback||c&&c!==f.context)&&e.push(f);e.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=h.call(arguments,1);if(!k(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&l(c,b),d&&l(d,arguments),this},stopListening:function(a,b,c){var e=this._listeningTo;if(!e)return this;var f=!b&&!c;c||"object"!=typeof b||(c=this),a&&((e={})[a._listenId]=a);for(var g in e)a=e[g],a.off(b,c,this),(f||d.isEmpty(a._events))&&delete this._listeningTo[g];return this}},j=/\s+/,k=function(a,b,c,d){if(!c)return!0;if("object"==typeof c){for(var e in c)a[b].apply(a,[e,c[e]].concat(d));return!1}if(j.test(c)){for(var f=c.split(j),g=0,h=f.length;g<h;g++)a[b].apply(a,[f[g]].concat(d));return!1}return!0},l=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b);return}},m={listenTo:"on",listenToOnce:"once"};d.each(m,function(a,b){i[b]=function(b,c,e){return(this._listeningTo||(this._listeningTo={}))[b._listenId||(b._listenId=d.uniqueId("l"))]=b,e||"object"!=typeof c||(e=this),b[a](c,e,this),this}}),i.bind=i.on,i.unbind=i.off,d.extend(c,i);var n=c.Model=function(a,b){var c=a||{};b||(b={}),this.cid=d.uniqueId("c"),this.attributes={},b.collection&&(this.collection=b.collection),b.parse&&(c=this.parse(c,b)||{}),c=d.defaults({},c,d.result(this,"defaults")),this.set(c,b),this.changed={},this.initialize.apply(this,arguments)};d.extend(n.prototype,i,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(a){return d.clone(this.attributes)},sync:function(){return c.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return d.escape(this.get(a))},has:function(a){return null!=this.get(a)},set:function(a,b,c){var e,f,g,h,i,j,k,l;if(null==a)return this;if("object"==typeof a?(f=a,c=b):(f={})[a]=b,c||(c={}),!this._validate(f,c))return!1;g=c.unset,i=c.silent,h=[],j=this._changing,this._changing=!0,j||(this._previousAttributes=d.clone(this.attributes),this.changed={}),l=this.attributes,k=this._previousAttributes,this.idAttribute in f&&(this.id=f[this.idAttribute]);for(e in f)b=f[e],d.isEqual(l[e],b)||h.push(e),d.isEqual(k[e],b)?delete this.changed[e]:this.changed[e]=b,g?delete l[e]:l[e]=b;if(!i){h.length&&(this._pending=c);for(var m=0,n=h.length;m<n;m++)this.trigger("change:"+h[m],this,l[h[m]],c)}if(j)return this;if(!i)for(;this._pending;)c=this._pending,this._pending=!1,this.trigger("change",this,c);return this._pending=!1,this._changing=!1,this},unset:function(a,b){return this.set(a,void 0,d.extend({},b,{unset:!0}))},clear:function(a){var b={};for(var c in this.attributes)b[c]=void 0;return this.set(b,d.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!d.isEmpty(this.changed):d.has(this.changed,a)},changedAttributes:function(a){if(!a)return!!this.hasChanged()&&d.clone(this.changed);var b,c=!1,e=this._changing?this._previousAttributes:this.attributes;for(var f in a)d.isEqual(e[f],b=a[f])||((c||(c={}))[f]=b);return c},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return d.clone(this._previousAttributes)},fetch:function(a){a=a?d.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;return a.success=function(d){if(!b.set(b.parse(d,a),a))return!1;c&&c(b,d,a),b.trigger("sync",b,d,a)},M(this,a),this.sync("read",this,a)},save:function(a,b,c){var e,f,g,h=this.attributes;if(null==a||"object"==typeof a?(e=a,c=b):(e={})[a]=b,c=d.extend({validate:!0},c),e&&!c.wait){if(!this.set(e,c))return!1}else if(!this._validate(e,c))return!1;e&&c.wait&&(this.attributes=d.extend({},h,e)),void 0===c.parse&&(c.parse=!0);var i=this,j=c.success;return c.success=function(a){i.attributes=h;var b=i.parse(a,c);if(c.wait&&(b=d.extend(e||{},b)),d.isObject(b)&&!i.set(b,c))return!1;j&&j(i,a,c),i.trigger("sync",i,a,c)},M(this,c),f=this.isNew()?"create":c.patch?"patch":"update","patch"===f&&(c.attrs=e),g=this.sync(f,this,c),e&&c.wait&&(this.attributes=h),g},destroy:function(a){a=a?d.clone(a):{};var b=this,c=a.success,e=function(){b.trigger("destroy",b,b.collection,a)};if(a.success=function(d){(a.wait||b.isNew())&&e(),c&&c(b,d,a),b.isNew()||b.trigger("sync",b,d,a)},this.isNew())return a.success(),!1;M(this,a);var f=this.sync("delete",this,a);return a.wait||e(),f},url:function(){var a=d.result(this,"urlRoot")||d.result(this.collection,"url")||L();return this.isNew()?a:a.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(a,b){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(a){return this._validate({},d.extend(a||{},{validate:!0}))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=d.extend({},this.attributes,a);var c=this.validationError=this.validate(a,b)||null;return!c||(this.trigger("invalid",this,c,d.extend(b,{validationError:c})),!1)}});var o=["keys","values","pairs","invert","pick","omit"];d.each(o,function(a){n.prototype[a]=function(){var b=h.call(arguments);return b.unshift(this.attributes),d[a].apply(d,b)}});var p=c.Collection=function(a,b){b||(b={}),b.model&&(this.model=b.model),void 0!==b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,d.extend({silent:!0},b))},q={add:!0,remove:!0,merge:!0},r={add:!0,remove:!1};d.extend(p.prototype,i,{model:n,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return c.sync.apply(this,arguments)},add:function(a,b){return this.set(a,d.extend({merge:!1},b,r))},remove:function(a,b){var c=!d.isArray(a);a=c?[a]:d.clone(a),b||(b={});var e,f,g,h;for(e=0,f=a.length;e<f;e++)(h=a[e]=this.get(a[e]))&&(delete this._byId[h.id],delete this._byId[h.cid],g=this.indexOf(h),this.models.splice(g,1),this.length--,b.silent||(b.index=g,h.trigger("remove",h,this,b)),this._removeReference(h,b));return c?a[0]:a},set:function(a,b){b=d.defaults({},b,q),b.parse&&(a=this.parse(a,b));var c=!d.isArray(a);a=c?a?[a]:[]:d.clone(a);var e,f,g,h,i,j,k,l=b.at,m=this.model,o=this.comparator&&null==l&&!1!==b.sort,p=d.isString(this.comparator)?this.comparator:null,r=[],s=[],t={},u=b.add,v=b.merge,w=b.remove,x=!(o||!u||!w)&&[];for(e=0,f=a.length;e<f;e++){if(i=a[e]||{},g=i instanceof n?h=i:i[m.prototype.idAttribute||"id"],j=this.get(g))w&&(t[j.cid]=!0),v&&(i=i===h?h.attributes:i,b.parse&&(i=j.parse(i,b)),j.set(i,b),o&&!k&&j.hasChanged(p)&&(k=!0)),a[e]=j;else if(u){if(!(h=a[e]=this._prepareModel(i,b)))continue;r.push(h),this._addReference(h,b)}h=j||h,!x||!h.isNew()&&t[h.id]||x.push(h),t[h.id]=!0}if(w){for(e=0,f=this.length;e<f;++e)t[(h=this.models[e]).cid]||s.push(h);s.length&&this.remove(s,b)}if(r.length||x&&x.length)if(o&&(k=!0),this.length+=r.length,null!=l)for(e=0,f=r.length;e<f;e++)this.models.splice(l+e,0,r[e]);else{x&&(this.models.length=0);var y=x||r;for(e=0,f=y.length;e<f;e++)this.models.push(y[e])}if(k&&this.sort({silent:!0}),!b.silent){for(e=0,f=r.length;e<f;e++)(h=r[e]).trigger("add",h,this,b);(k||x&&x.length)&&this.trigger("sort",this,b)}return c?a[0]:a},reset:function(a,b){b||(b={});for(var c=0,e=this.models.length;c<e;c++)this._removeReference(this.models[c],b);return b.previousModels=this.models,this._reset(),a=this.add(a,d.extend({silent:!0},b)),b.silent||this.trigger("reset",this,b),a},push:function(a,b){return this.add(a,d.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a),b},unshift:function(a,b){return this.add(a,d.extend({at:0},b))},shift:function(a){var b=this.at(0);return this.remove(b,a),b},slice:function(){return h.apply(this.models,arguments)},get:function(a){if(null!=a)return this._byId[a]||this._byId[a.id]||this._byId[a.cid]},at:function(a){return this.models[a]},where:function(a,b){return d.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return a||(a={}),d.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(d.bind(this.comparator,this)),a.silent||this.trigger("sort",this,a),this},pluck:function(a){return d.invoke(this.models,"get",a)},fetch:function(a){a=a?d.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=a.success,c=this;return a.success=function(d){var e=a.reset?"reset":"set";c[e](d,a),b&&b(c,d,a),c.trigger("sync",c,d,a)},M(this,a),this.sync("read",this,a)},create:function(a,b){if(b=b?d.clone(b):{},!(a=this._prepareModel(a,b)))return!1;b.wait||this.add(a,b);var c=this,e=b.success;return b.success=function(a,d){b.wait&&c.add(a,b),e&&e(a,d,b)},a.save(null,b),a},parse:function(a,b){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(a,b){if(a instanceof n)return a;b=b?d.clone(b):{},b.collection=this;var c=new this.model(a,b);return c.validationError?(this.trigger("invalid",this,c.validationError,b),!1):c},_addReference:function(a,b){this._byId[a.cid]=a,null!=a.id&&(this._byId[a.id]=a),a.collection||(a.collection=this),a.on("all",this._onModelEvent,this)},_removeReference:function(a,b){this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"!==a&&"remove"!==a||c===this)&&("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}});var s=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];d.each(s,function(a){p.prototype[a]=function(){var b=h.call(arguments);return b.unshift(this.models),d[a].apply(d,b)}});var t=["groupBy","countBy","sortBy","indexBy"];d.each(t,function(a){p.prototype[a]=function(b,c){var e=d.isFunction(b)?b:function(a){return a.get(b)};return d[a](this.models,e,c)}});var u=c.View=function(a){this.cid=d.uniqueId("view"),a||(a={}),d.extend(this,d.pick(a,w)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},v=/^(\S+)\s*(.*)$/,w=["model","collection","el","id","attributes","className","tagName","events"];d.extend(u.prototype,i,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(a,b){return this.$el&&this.undelegateEvents(),this.$el=a instanceof c.$?a:c.$(a),this.el=this.$el[0],!1!==b&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=d.result(this,"events")))return this;this.undelegateEvents();for(var b in a){var c=a[b];if(d.isFunction(c)||(c=this[a[b]]),c){var e=b.match(v),f=e[1],g=e[2];c=d.bind(c,this),f+=".delegateEvents"+this.cid,""===g?this.$el.on(f,c):this.$el.on(f,g,c)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(d.result(this,"el"),!1);else{var a=d.extend({},d.result(this,"attributes"));this.id&&(a.id=d.result(this,"id")),this.className&&(a.class=d.result(this,"className"));var b=c.$("<"+d.result(this,"tagName")+">").attr(a);this.setElement(b,!1)}}}),c.sync=function(a,b,e){var f=y[a];d.defaults(e||(e={}),{emulateHTTP:c.emulateHTTP,emulateJSON:c.emulateJSON});var g={type:f,dataType:"json"};if(e.url||(g.url=d.result(b,"url")||L()),null!=e.data||!b||"create"!==a&&"update"!==a&&"patch"!==a||(g.contentType="application/json",g.data=JSON.stringify(e.attrs||b.toJSON(e))),e.emulateJSON&&(g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{}),e.emulateHTTP&&("PUT"===f||"DELETE"===f||"PATCH"===f)){g.type="POST",e.emulateJSON&&(g.data._method=f);var h=e.beforeSend;e.beforeSend=function(a){if(a.setRequestHeader("X-HTTP-Method-Override",f),h)return h.apply(this,arguments)}}"GET"===g.type||e.emulateJSON||(g.processData=!1),"PATCH"===g.type&&x&&(g.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var i=e.xhr=c.ajax(d.extend(g,e));return b.trigger("request",b,i,e),i};var x=!(void 0===a||!a.ActiveXObject||a.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),y={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};c.ajax=function(){return c.$.ajax.apply(c.$,arguments)};var z=c.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},A=/\((.*?)\)/g,B=/(\(\?)?:\w+/g,C=/\*\w+/g,D=/[\-{}\[\]+?.,\\\^$|#\s]/g;d.extend(z.prototype,i,{initialize:function(){},route:function(a,b,e){d.isRegExp(a)||(a=this._routeToRegExp(a)),d.isFunction(b)&&(e=b,b=""),e||(e=this[b]);var f=this;return c.history.route(a,function(d){var g=f._extractParameters(a,d);f.execute(e,g),f.trigger.apply(f,["route:"+b].concat(g)),f.trigger("route",b,g),c.history.trigger("route",f,b,g)}),this},execute:function(a,b){a&&a.apply(this,b)},navigate:function(a,b){return c.history.navigate(a,b),this},_bindRoutes:function(){if(this.routes){this.routes=d.result(this,"routes");for(var a,b=d.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){return a=a.replace(D,"\\$&").replace(A,"(?:$1)?").replace(B,function(a,b){return b?a:"([^/?]+)"}).replace(C,"([^?]*?)"),new RegExp("^"+a+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(a,b){var c=a.exec(b).slice(1);return d.map(c,function(a,b){return b===c.length-1?a||null:a?decodeURIComponent(a):null})}});var E=c.History=function(){this.handlers=[],d.bindAll(this,"checkUrl"),void 0!==a&&(this.location=a.location,this.history=a.history)},F=/^[#\/]|\s+$/g,G=/^\/+|\/+$/g,H=/msie [\w.]+/,I=/\/$/,J=/#.*$/;E.started=!1,d.extend(E.prototype,i,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=decodeURI(this.location.pathname+this.location.search);var c=this.root.replace(I,"");a.indexOf(c)||(a=a.slice(c.length))}else a=this.getHash();return a.replace(F,"")},start:function(b){if(E.started)throw new Error("Backbone.history has already been started");E.started=!0,this.options=d.extend({root:"/"},this.options,b),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var e=this.getFragment(),f=document.documentMode,g=H.exec(navigator.userAgent.toLowerCase())&&(!f||f<=7);if(this.root=("/"+this.root+"/").replace(G,"/"),g&&this._wantsHashChange){var h=c.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=h.hide().appendTo("body")[0].contentWindow,this.navigate(e)}this._hasPushState?c.$(a).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in a&&!g?c.$(a).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=e;var i=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&i.hash&&(this.fragment=this.getHash().replace(F,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){c.$(a).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),E.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();if(b===this.fragment&&this.iframe&&(b=this.getFragment(this.getHash(this.iframe))),b===this.fragment)return!1;this.iframe&&this.navigate(b),this.loadUrl()},loadUrl:function(a){return a=this.fragment=this.getFragment(a),d.any(this.handlers,function(b){if(b.route.test(a))return b.callback(a),!0})},navigate:function(a,b){if(!E.started)return!1;b&&!0!==b||(b={trigger:!!b});var c=this.root+(a=this.getFragment(a||""));if(a=a.replace(J,""),this.fragment!==a){if(this.fragment=a,""===a&&"/"!==c&&(c=c.slice(0,-1)),this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else{if(!this._wantsHashChange)return this.location.assign(c);this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}return b.trigger?this.loadUrl(a):void 0}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),c.history=new E;var K=function(a,b){var c,e=this;c=a&&d.has(a,"constructor")?a.constructor:function(){return e.apply(this,arguments)},d.extend(c,e,b);var f=function(){this.constructor=c};return f.prototype=e.prototype,c.prototype=new f,a&&d.extend(c.prototype,a),c.__super__=e.prototype,c};n.extend=p.extend=z.extend=u.extend=E.extend=K;var L=function(){throw new Error('A "url" property or function must be specified')},M=function(a,b){var c=b.error;b.error=function(d){c&&c(a,d,b),a.trigger("error",a,d,b)}};return c}),function(a,b){"use strict";function c(a,b){var c,d,e=a.toLowerCase();for(b=[].concat(b),c=0;b.length>c;c+=1)if(d=b[c]){if(d.test&&d.test(a))return!0;if(d.toLowerCase()===e)return!0}}var d=b.prototype.trim,e=b.prototype.trimRight,f=b.prototype.trimLeft,g=function(a){return 1*a||0},h=function(a,b){if(1>b)return"";for(var c="";b>0;)1&b&&(c+=a),b>>=1,a+=a;return c},i=[].slice,j=function(a){return null==a?"\\s":a.source?a.source:"["+o.escapeRegExp(a)+"]"},k={lt:"<",gt:">",quot:'"',amp:"&",apos:"'"},l={};for(var m in k)l[k[m]]=m;l["'"]="#39";var n=function(){function a(a){return Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}var c=h,d=function(){return d.cache.hasOwnProperty(arguments[0])||(d.cache[arguments[0]]=d.parse(arguments[0])),d.format.call(null,d.cache[arguments[0]],arguments)};return d.format=function(d,e){var f,g,h,i,j,k,l,m=1,o=d.length,p="",q=[];for(g=0;o>g;g++)if("string"===(p=a(d[g])))q.push(d[g]);else if("array"===p){if(i=d[g],i[2])for(f=e[m],h=0;i[2].length>h;h++){if(!f.hasOwnProperty(i[2][h]))throw new Error(n('[_.sprintf] property "%s" does not exist',i[2][h]));f=f[i[2][h]]}else f=i[1]?e[i[1]]:e[m++];if(/[^s]/.test(i[8])&&"number"!=a(f))throw new Error(n("[_.sprintf] expecting number but found %s",a(f)));switch(i[8]){case"b":f=f.toString(2);break;case"c":f=b.fromCharCode(f);break;case"d":f=parseInt(f,10);break;case"e":f=i[7]?f.toExponential(i[7]):f.toExponential();break;case"f":f=i[7]?parseFloat(f).toFixed(i[7]):parseFloat(f);break;case"o":f=f.toString(8);break;case"s":f=(f=b(f))&&i[7]?f.substring(0,i[7]):f;break;case"u":f=Math.abs(f);break;case"x":f=f.toString(16);break;case"X":f=f.toString(16).toUpperCase()}f=/[def]/.test(i[8])&&i[3]&&f>=0?"+"+f:f,k=i[4]?"0"==i[4]?"0":i[4].charAt(1):" ",l=i[6]-b(f).length,j=i[6]?c(k,l):"",q.push(i[5]?f+j:j+f)}return q.join("")},d.cache={},d.parse=function(a){for(var b=a,c=[],d=[],e=0;b;){if(null!==(c=/^[^\x25]+/.exec(b)))d.push(c[0]);else if(null!==(c=/^\x25{2}/.exec(b)))d.push("%");else{if(null===(c=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(b)))throw new Error("[_.sprintf] huh?");if(c[2]){e|=1;var f=[],g=c[2],h=[];if(null===(h=/^([a-z_][a-z_\d]*)/i.exec(g)))throw new Error("[_.sprintf] huh?");for(f.push(h[1]);""!==(g=g.substring(h[0].length));)if(null!==(h=/^\.([a-z_][a-z_\d]*)/i.exec(g)))f.push(h[1]);else{if(null===(h=/^\[(\d+)\]/.exec(g)))throw new Error("[_.sprintf] huh?");f.push(h[1])}c[2]=f}else e|=2;if(3===e)throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");d.push(c)}b=b.substring(c[0].length)}return d},d}(),o={VERSION:"2.3.0",isBlank:function(a){return null==a&&(a=""),/^\s*$/.test(a)},stripTags:function(a){return null==a?"":b(a).replace(/<\/?[^>]+>/g,"")},capitalize:function(a){return a=null==a?"":b(a),a.charAt(0).toUpperCase()+a.slice(1)},chop:function(a,c){return null==a?[]:(a=b(a),c=~~c,c>0?a.match(new RegExp(".{1,"+c+"}","g")):[a])},clean:function(a){return o.strip(a).replace(/\s+/g," ")},count:function(a,c){if(null==a||null==c)return 0;a=b(a),c=b(c);for(var d=0,e=0,f=c.length;-1!==(e=a.indexOf(c,e));)d++,e+=f;return d},chars:function(a){return null==a?[]:b(a).split("")},swapCase:function(a){return null==a?"":b(a).replace(/\S/g,function(a){return a===a.toUpperCase()?a.toLowerCase():a.toUpperCase()})},escapeHTML:function(a){return null==a?"":b(a).replace(/[&<>"']/g,function(a){return"&"+l[a]+";"})},unescapeHTML:function(a){return null==a?"":b(a).replace(/\&([^;]+);/g,function(a,c){var d;return c in k?k[c]:(d=c.match(/^#x([\da-fA-F]+)$/))?b.fromCharCode(parseInt(d[1],16)):(d=c.match(/^#(\d+)$/))?b.fromCharCode(~~d[1]):a})},escapeRegExp:function(a){return null==a?"":b(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},splice:function(a,b,c,d){var e=o.chars(a);return e.splice(~~b,~~c,d),e.join("")},insert:function(a,b,c){return o.splice(a,b,0,c)},include:function(a,c){return""===c||null!=a&&-1!==b(a).indexOf(c)},join:function(){var a=i.call(arguments),b=a.shift();return null==b&&(b=""),a.join(b)},lines:function(a){return null==a?[]:b(a).split("\n")},reverse:function(a){return o.chars(a).reverse().join("")},startsWith:function(a,c){return""===c||null!=a&&null!=c&&(a=b(a),c=b(c),a.length>=c.length&&a.slice(0,c.length)===c)},endsWith:function(a,c){return""===c||null!=a&&null!=c&&(a=b(a),c=b(c),a.length>=c.length&&a.slice(a.length-c.length)===c)},succ:function(a){return null==a?"":(a=b(a),a.slice(0,-1)+b.fromCharCode(a.charCodeAt(a.length-1)+1))},titleize:function(a){return null==a?"":(a=b(a).toLowerCase(),a.replace(/(?:^|\s|-)\S/g,function(a){return a.toUpperCase()}))},camelize:function(a){return o.trim(a).replace(/[-_\s]+(.)?/g,function(a,b){return b?b.toUpperCase():""})},underscored:function(a){return o.trim(a).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},dasherize:function(a){return o.trim(a).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},classify:function(a){return o.titleize(b(a).replace(/[\W_]/g," ")).replace(/\s/g,"")},humanize:function(a){return o.capitalize(o.underscored(a).replace(/_id$/,"").replace(/_/g," "))},trim:function(a,c){return null==a?"":!c&&d?d.call(a):(c=j(c),b(a).replace(new RegExp("^"+c+"+|"+c+"+$","g"),""))},ltrim:function(a,c){return null==a?"":!c&&f?f.call(a):(c=j(c),b(a).replace(new RegExp("^"+c+"+"),""))},rtrim:function(a,c){return null==a?"":!c&&e?e.call(a):(c=j(c),b(a).replace(new RegExp(c+"+$"),""))},truncate:function(a,c,d){return null==a?"":(a=b(a),d=d||"...",c=~~c,a.length>c?a.slice(0,c)+d:a)},prune:function(a,c,d){if(null==a)return"";if(a=b(a),c=~~c,d=null!=d?b(d):"...",c>=a.length)return a;var e=function(a){return a.toUpperCase()!==a.toLowerCase()?"A":" "},f=a.slice(0,c+1).replace(/.(?=\W*\w*$)/g,e);return f=f.slice(f.length-2).match(/\w\w/)?f.replace(/\s*\S+$/,""):o.rtrim(f.slice(0,f.length-1)),(f+d).length>a.length?a:a.slice(0,f.length)+d},words:function(a,b){return o.isBlank(a)?[]:o.trim(a,b).split(b||/\s+/)},pad:function(a,c,d,e){a=null==a?"":b(a),c=~~c;var f=0;switch(d?d.length>1&&(d=d.charAt(0)):d=" ",e){case"right":return f=c-a.length,a+h(d,f);case"both":return f=c-a.length,h(d,Math.ceil(f/2))+a+h(d,Math.floor(f/2));default:return f=c-a.length,h(d,f)+a}},lpad:function(a,b,c){return o.pad(a,b,c)},rpad:function(a,b,c){return o.pad(a,b,c,"right")},lrpad:function(a,b,c){return o.pad(a,b,c,"both")},sprintf:n,vsprintf:function(a,b){return b.unshift(a),n.apply(null,b)},toNumber:function(a,b){return a?(a=o.trim(a),a.match(/^-?\d+(?:\.\d+)?$/)?g(g(a).toFixed(~~b)):NaN):0},numberFormat:function(a,b,c,d){if(isNaN(a)||null==a)return"";a=a.toFixed(~~b),d="string"==typeof d?d:",";var e=a.split("."),f=e[0],g=e[1]?(c||".")+e[1]:"";return f.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+d)+g},strRight:function(a,c){if(null==a)return"";a=b(a),c=null!=c?b(c):c;var d=c?a.indexOf(c):-1;return~d?a.slice(d+c.length,a.length):a},strRightBack:function(a,c){if(null==a)return"";a=b(a),c=null!=c?b(c):c;var d=c?a.lastIndexOf(c):-1;return~d?a.slice(d+c.length,a.length):a},strLeft:function(a,c){if(null==a)return"";a=b(a),c=null!=c?b(c):c;var d=c?a.indexOf(c):-1;return~d?a.slice(0,d):a},strLeftBack:function(a,b){if(null==a)return"";a+="",b=null!=b?""+b:b;var c=a.lastIndexOf(b);return~c?a.slice(0,c):a},toSentence:function(a,b,c,d){b=b||", ",c=c||" and ";var e=a.slice(),f=e.pop();return a.length>2&&d&&(c=o.rtrim(b)+c),e.length?e.join(b)+c+f:f},toSentenceSerial:function(){var a=i.call(arguments);return a[3]=!0,o.toSentence.apply(o,a)},slugify:function(a){if(null==a)return"";var c="",d=new RegExp(j(c),"g");return a=b(a).toLowerCase().replace(d,function(a){return"aaaaaaaaaceeeeeiiiilnoooooosstuuuunczz".charAt(c.indexOf(a))||"-"}),o.dasherize(a.replace(/[^\w\s-]/g,""))},surround:function(a,b){return[b,a,b].join("")},quote:function(a,b){return o.surround(a,b||'"')},unquote:function(a,b){return b=b||'"',a[0]===b&&a[a.length-1]===b?a.slice(1,a.length-1):a},exports:function(){var a={};for(var b in this)this.hasOwnProperty(b)&&!b.match(/^(?:include|contains|reverse)$/)&&(a[b]=this[b]);return a},repeat:function(a,c,d){if(null==a)return"";if(c=~~c,null==d)return h(b(a),c);for(var e=[];c>0;e[--c]=a);return e.join(d)},naturalCmp:function(a,c){if(a==c)return 0;if(!a)return-1;if(!c)return 1;for(var d=/(\.\d+)|(\d+)|(\D+)/g,e=b(a).toLowerCase().match(d),f=b(c).toLowerCase().match(d),g=Math.min(e.length,f.length),h=0;g>h;h++){var i=e[h],j=f[h];if(i!==j){var k=parseInt(i,10);if(!isNaN(k)){var l=parseInt(j,10);if(!isNaN(l)&&k-l)return k-l}return j>i?-1:1}}return e.length===f.length?e.length-f.length:c>a?-1:1},levenshtein:function(a,c){if(null==a&&null==c)return 0;if(null==a)return b(c).length;if(null==c)return b(a).length;a=b(a),c=b(c);for(var d,e,f=[],g=0;c.length>=g;g++)for(var h=0;a.length>=h;h++)e=g&&h?a.charAt(h-1)===c.charAt(g-1)?d:Math.min(f[h],f[h-1],d)+1:g+h,d=f[h],f[h]=e;return f.pop()},toBoolean:function(a,b,d){return"number"==typeof a&&(a=""+a),"string"!=typeof a?!!a:(a=o.trim(a),!!c(a,b||["true","1"])||!c(a,d||["false","0"])&&void 0)}};o.strip=o.trim,o.lstrip=o.ltrim,o.rstrip=o.rtrim,o.center=o.lrpad,o.rjust=o.lpad,o.ljust=o.rpad,o.contains=o.include,o.q=o.quote,o.toBool=o.toBoolean,"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(module.exports=o),exports._s=o),"function"==typeof define&&define.amd&&define("underscore.string",[],function(){return o}),a._=a._||{},a._.string=a._.str=o}(this,String),function(){var b;b=function(){function b(){}return b.footerText="Are you sure you want to leave this page?",b.defaults={if:function(){return!0},message:"You have unsaved changes."},b.enable=function(b){return this.opts={if:b.if||this.defaults.if,message:b.message||this.defaults.message,cb:b.cb},this._onTurbolinksUnload=function(a){return function(b){return a._willPrevent()?a.opts.cb&&!1!==a.opts.cb(b.data.url)?b.preventDefault():confirm(a.opts.message+"\n\n"+a.footerText)?a.disable():b.preventDefault():a.disable()}}(this),document.body.beforeunload=this,a.onbeforeunload=function(a){return function(){return a._willPrevent()?a.opts.message:void 0}}(this),document.addEventListener("page:before-change",this._onTurbolinksUnload,!1)},b.disable=function(){return a.onbeforeunload=null,document.removeEventListener("page:before-change",this._onTurbolinksUnload)},b._willPrevent=function(){return document.body.beforeunload===this&&this.opts.if()},b}(),a.BeforeUnload=b}.call(this),function(){var a,b,c,d,e,f,g=[].slice;c=function(a){var b,d;return!_.isObject(a)||_.isFunction(a)?a:a instanceof Backbone.Collection||a instanceof Backbone.Model?a:_.isDate(a)?new Date(a.getTime()):_.isRegExp(a)?new RegExp(a.source,a.toString().replace(/.*\//,"")):(d=_.isArray(a||_.isArguments(a)),b=function(a,b,e){return d?a.push(c(b)):a[e]=c(b),a},_.reduce(a,b,d?[]:{}))},f=function(a){return null!=a&&((a.prototype==={}.prototype||a.prototype===Object.prototype)&&_.isObject(a)&&!_.isArray(a)&&!_.isFunction(a)&&!_.isDate(a)&&!_.isRegExp(a)&&!_.isArguments(a))},b=function(a){return _.filter(_.keys(a),function(b){return f(a[b])})},a=function(a){return _.filter(_.keys(a),function(b){return _.isArray(a[b])})},e=function(c,d,f){var g,h,i,j,k,l,m,n,o,p;if(null==f&&(f=20),f<=0)return console.warn("_.deepExtend(): Maximum depth of recursion hit."),_.extend(c,d);for(l=_.intersection(b(c),b(d)),h=function(a){return d[a]=e(c[a],d[a],f-1)},m=0,o=l.length;m<o;m++)k=l[m],h(k);for(j=_.intersection(a(c),a(d)),g=function(a){return d[a]=_.union(c[a],d[a])},n=0,p=j.length;n<p;n++)i=j[n],g(i);return _.extend(c,d)},d=function(){var a,b,d,f;if(d=2<=arguments.length?g.call(arguments,0,f=arguments.length-1):(f=0,[]),b=arguments[f++],_.isNumber(b)||(d.push(b),b=20),d.length<=1)return d[0];if(b<=0)return _.extend.apply(this,d);for(a=d.shift();d.length>0;)a=e(a,c(d.shift()),b);return a},_.mixin({deepClone:c,isBasicObject:f,basicObjects:b,arrays:a,deepExtend:d})}.call(this),function(a){"function"==typeof define&&define.amd?define(["underscore","backbone"],a):a(_,Backbone)}(function(a,b){function c(b){var d={},e=g.keyPathSeparator;for(var f in b){var h=b[f];if(h&&h.constructor===Object&&!a.isEmpty(h)){var i=c(h);for(var j in i){var k=i[j];d[f+e+j]=k}}else d[f]=h}return d}function d(b,c,d){for(var e=g.keyPathSeparator,f=c.split(e),h=b,i=0,j=f.length;i<j;i++){if(d&&!a.has(h,f[i]))return!1;if(h=h[f[i]],null==h&&i<j-1&&(h={}),void 0===h)return!!d||h}return!!d||h}function e(b,c,d,e){e=e||{};for(var f=g.keyPathSeparator,h=c.split(f),i=b,j=0,k=h.length;j<k&&void 0!==i;j++){var l=h[j];j===k-1?e.unset?delete i[l]:i[l]=d:(void 0!==i[l]&&a.isObject(i[l])||(i[l]={}),i=i[l])}}function f(a,b){e(a,b,null,{unset:!0})}var g=b.Model.extend({constructor:function(b,c){var d,e=b||{};this.cid=a.uniqueId("c"),this.attributes={},c&&c.collection&&(this.collection=c.collection),c&&c.parse&&(e=this.parse(e,c)||{}),(d=a.result(this,"defaults"))&&(e=a.deepExtend({},d,e)),this.set(e,c),this.changed={},this.initialize.apply(this,arguments)},toJSON:function(b){return a.deepClone(this.attributes)},get:function(a){return d(this.attributes,a)},set:function(b,h,i){var j,k,l,m,n,o,p,q;if(null==b)return this;if("object"==typeof b?(k=b,i=h||{}):(k={})[b]=h,i||(i={}),!this._validate(k,i))return!1;l=i.unset,n=i.silent,m=[],o=this._changing,this._changing=!0,o||(this._previousAttributes=a.deepClone(this.attributes),this.changed={}),q=this.attributes,p=this._previousAttributes,this.idAttribute in k&&(this.id=k[this.idAttribute]),k=c(k);for(j in k)h=k[j],a.isEqual(d(q,j),h)||m.push(j),a.isEqual(d(p,j),h)?f(this.changed,j):e(this.changed,j,h),l?f(q,j):e(q,j,h);if(!n){m.length&&(this._pending=!0);for(var r=g.keyPathSeparator,s=0,t=m.length;s<t;s++){var b=m[s];this.trigger("change:"+b,this,d(q,b),i);for(var u=b.split(r),v=u.length-1;v>0;v--){var w=a.first(u,v).join(r),x=w+r+"*";this.trigger("change:"+x,this,d(q,w),i)}}}if(o)return this;if(!n)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},clear:function(b){var d={},e=c(this.attributes);for(var f in e)d[f]=void 0;return this.set(d,a.extend({},b,{unset:!0}))},hasChanged:function(b){return null==b?!a.isEmpty(this.changed):void 0!==d(this.changed,b)},changedAttributes:function(b){if(!b)return!!this.hasChanged()&&c(this.changed);var d=this._changing?this._previousAttributes:this.attributes;b=c(b),d=c(d);var e,f=!1;for(var g in b)a.isEqual(d[g],e=b[g])||((f||(f={}))[g]=e);return f},previous:function(a){return null!=a&&this._previousAttributes?d(this._previousAttributes,a):null},previousAttributes:function(){return a.deepClone(this._previousAttributes)}});return g.keyPathSeparator=".",b.DeepModel=g,"undefined"!=typeof module&&(module.exports=g),b}),function(){var b,c=function(a,b){return function(){return a.apply(b,arguments)}},d=[].slice,e=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};b={},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),b.Binding=function(){function a(a,b,d,e,f,g){var h,i,j,k;if(this.view=a,this.el=b,this.type=d,this.key=e,this.keypath=f,this.options=null!=g?g:{},this.update=c(this.update,this),this.unbind=c(this.unbind,this),this.bind=c(this.bind,this),this.publish=c(this.publish,this),this.sync=c(this.sync,this),this.set=c(this.set,this),this.formattedValue=c(this.formattedValue,this),!(this.binder=this.view.binders[this.type])){k=this.view.binders;for(h in k)j=k[h],"*"!==h&&-1!==h.indexOf("*")&&(i=new RegExp("^"+h.replace("*",".+")+"$"),i.test(this.type)&&(this.binder=j,this.args=new RegExp("^"+h.replace("*","(.+)")+"$").exec(this.type),this.args.shift()))}this.binder||(this.binder=this.view.binders["*"]),this.binder instanceof Function&&(this.binder={routine:this.binder}),this.formatters=this.options.formatters||[],this.model=this.view.models[this.key]}return a.prototype.formattedValue=function(a){var b,c,e,f,g,h;for(h=this.formatters,f=0,g=h.length;f<g;f++)c=h[f],b=c.split(/\s+/),e=b.shift(),c=this.model[e]instanceof Function?this.model[e]:this.view.formatters[e],(null!=c?c.read:void 0)instanceof Function?a=c.read.apply(c,[a].concat(d.call(b))):c instanceof Function&&(a=c.apply(null,[a].concat(d.call(b))));return a},a.prototype.set=function(a){var b;return a=a instanceof Function&&!this.binder.function?this.formattedValue(a.call(this.model)):this.formattedValue(a),null!=(b=this.binder.routine)?b.call(this,this.el,a):void 0},a.prototype.sync=function(){return this.set(this.options.bypass?this.model[this.keypath]:this.view.config.adapter.read(this.model,this.keypath))},a.prototype.publish=function(){var a,c,e,f,g,h,i,j,k;for(f=b.Util.getInputValue(this.el),i=this.formatters.slice(0).reverse(),g=0,h=i.length;g<h;g++)c=i[g],a=c.split(/\s+/),e=a.shift(),(null!=(j=this.view.formatters[e])?j.publish:void 0)&&(f=(k=this.view.formatters[e]).publish.apply(k,[f].concat(d.call(a))));return this.view.config.adapter.publish(this.model,this.keypath,f)},a.prototype.bind=function(){var a,b,c,d,e,f,g,h,i;if(null!=(f=this.binder.bind)&&f.call(this,this.el),this.options.bypass?this.sync():(this.view.config.adapter.subscribe(this.model,this.keypath,this.sync),this.view.config.preloadData&&this.sync()),null!=(g=this.options.dependencies)?g.length:void 0){for(h=this.options.dependencies,i=[],d=0,e=h.length;d<e;d++)a=h[d],/^\./.test(a)?(c=this.model,b=a.substr(1)):(a=a.split("."),c=this.view.models[a.shift()],b=a.join(".")),i.push(this.view.config.adapter.subscribe(c,b,this.sync));return i}},a.prototype.unbind=function(){var a,b,c,d,e,f,g,h,i;if(null!=(f=this.binder.unbind)&&f.call(this,this.el),this.options.bypass||this.view.config.adapter.unsubscribe(this.model,this.keypath,this.sync),null!=(g=this.options.dependencies)?g.length:void 0){for(h=this.options.dependencies,i=[],d=0,e=h.length;d<e;d++)a=h[d],/^\./.test(a)?(c=this.model,b=a.substr(1)):(a=a.split("."),c=this.view.models[a.shift()],b=a.join(".")),i.push(this.view.config.adapter.unsubscribe(c,b,this.sync));return i}},a.prototype.update=function(){return this.unbind(),this.model=this.view.models[this.key],this.bind()},a}(),b.View=function(){function a(a,d,e){var f,g,h,i,j,k,l,m,n;for(this.els=a,this.models=d,this.options=null!=e?e:{},this.update=c(this.update,this),this.publish=c(this.publish,this),this.sync=c(this.sync,this),this.unbind=c(this.unbind,this),this.bind=c(this.bind,this),this.select=c(this.select,this),this.build=c(this.build,this),this.bindingRegExp=c(this.bindingRegExp,this),this.els.jquery||this.els instanceof Array||(this.els=[this.els]),l=["config","binders","formatters"],j=0,k=l.length;j<k;j++){if(g=l[j],this[g]={},this.options[g]){m=this.options[g];for(f in m)h=m[f],this[g][f]=h}n=b[g];for(f in n)h=n[f],null==(i=this[g])[f]&&(i[f]=h)}this.build()}return a.prototype.bindingRegExp=function(){var a;return a=this.config.prefix,a?new RegExp("^data-"+a+"-"):/^data-/},a.prototype.build=function(){var a,c,d,f,g,h,i,j,k,l,m,n=this;for(this.bindings=[],g=[],a=this.bindingRegExp(),f=function(c){var d,f,h,i,j,k,l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;if(e.call(g,c)<0){for(E=c.attributes,y=0,B=E.length;y<B;y++)if(d=E[y],a.test(d.name)){if(w=d.name.replace(a,""),!(h=n.binders[w])){F=n.binders;for(l in F)x=F[l],"*"!==l&&-1!==l.indexOf("*")&&(u=new RegExp("^"+l.replace("*",".+")+"$"),u.test(w)&&(h=x))}if(h||(h=n.binders["*"]),h.block){for(G=c.getElementsByTagName("*"),z=0,C=G.length;z<C;z++)p=G[z],g.push(p);f=[d]}}for(H=f||c.attributes,A=0,D=H.length;A<D;A++)d=H[A],a.test(d.name)&&(q={},w=d.name.replace(a,""),t=function(){var a,b,c,e;for(c=d.value.split("|"),e=[],a=0,b=c.length;a<b;a++)s=c[a],e.push(s.trim());return e}(),i=function(){var a,b,c,d;for(c=t.shift().split("<"),d=[],a=0,b=c.length;a<b;a++)j=c[a],d.push(j.trim());return d}(),r=i.shift(),v=r.split(/\.|:/),q.formatters=t,q.bypass=-1!==r.indexOf(":"),v[0]?m=v.shift():(m=null,v.shift()),o=v.join("."),null!=n.models[m]&&((k=i.shift())&&(q.dependencies=k.split(/\s+/)),n.bindings.push(new b.Binding(n,c,w,m,o,q))));f&&(f=null)}},l=this.els,h=0,j=l.length;h<j;h++)for(c=l[h],f(c),m=c.getElementsByTagName("*"),i=0,k=m.length;i<k;i++)d=m[i],null!=d.attributes&&f(d)},a.prototype.select=function(a){var b,c,d,e,f;for(e=this.bindings,f=[],c=0,d=e.length;c<d;c++)b=e[c],a(b)&&f.push(b);return f},a.prototype.bind=function(){var a,b,c,d,e;for(d=this.bindings,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(a.bind());return e},a.prototype.unbind=function(){var a,b,c,d,e;for(d=this.bindings,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(a.unbind());return e},a.prototype.sync=function(){var a,b,c,d,e;for(d=this.bindings,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(a.sync());return e},a.prototype.publish=function(){var a,b,c,d,e;for(d=this.select(function(a){return a.binder.publishes}),e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(a.publish());return e},a.prototype.update=function(a){var b,c,d,e;null==a&&(a={}),e=[];for(c in a)d=a[c],this.models[c]=d,e.push(function(){var a,d,e,f;for(e=this.select(function(a){return a.key===c}),f=[],a=0,d=e.length;a<d;a++)b=e[a],f.push(b.update());return f}.call(this));return e},a}(),b.Util={bindEvent:function(b,c,d,e){var f;return f=function(a){return d.call(this,a,e)},null!=a.jQuery?(b=jQuery(b),null!=b.on?b.on(c,f):b.bind(c,f)):null!=a.addEventListener?b.addEventListener(c,f,!1):(c="on"+c,b.attachEvent(c,f)),f},unbindEvent:function(b,c,d){return null!=a.jQuery?(b=jQuery(b),null!=b.off?b.off(c,d):b.unbind(c,d)):a.removeEventListener?b.removeEventListener(c,d,!1):(c="on"+c,b.detachEvent(c,d))},getInputValue:function(b){var c,d,e,f;if(null!=a.jQuery)switch(b=jQuery(b),b[0].type){case"checkbox":return b.is(":checked");default:return b.val()}else switch(b.type){case"checkbox":return b.checked;case"select-multiple":for(f=[],d=0,e=b.length;d<e;d++)c=b[d],c.selected&&f.push(c.value);return f;default:return b.value}}},b.binders={enabled:function(a,b){return a.disabled=!b},disabled:function(a,b){return a.disabled=!!b},checked:{publishes:!0,bind:function(a){return this.currentListener=b.Util.bindEvent(a,"change",this.publish)},unbind:function(a){return b.Util.unbindEvent(a,"change",this.currentListener)},routine:function(a,b){var c;return"radio"===a.type?a.checked=(null!=(c=a.value)?c.toString():void 0)===(null!=b?b.toString():void 0):a.checked=!!b}},unchecked:{publishes:!0,bind:function(a){return this.currentListener=b.Util.bindEvent(a,"change",this.publish)},unbind:function(a){return b.Util.unbindEvent(a,"change",this.currentListener)},routine:function(a,b){var c;return"radio"===a.type?a.checked=(null!=(c=a.value)?c.toString():void 0)!==(null!=b?b.toString():void 0):a.checked=!b}},show:function(a,b){return a.style.display=b?"":"none"},hide:function(a,b){return a.style.display=b?"none":""},html:function(a,b){return a.innerHTML=null!=b?b:""},value:{publishes:!0,bind:function(a){return this.currentListener=b.Util.bindEvent(a,"change",this.publish)},unbind:function(a){return b.Util.unbindEvent(a,"change",this.currentListener)},routine:function(b,c){var d,f,g,h,i,j,k;if(null!=a.jQuery){if(b=jQuery(b),(null!=c?c.toString():void 0)!==(null!=(h=b.val())?h.toString():void 0))return b.val(null!=c?c:"")}else if("select-multiple"===b.type){if(null!=c){for(k=[],f=0,g=b.length;f<g;f++)d=b[f],k.push(d.selected=(i=d.value,e.call(c,i)>=0));return k}}else if((null!=c?c.toString():void 0)!==(null!=(j=b.value)?j.toString():void 0))return b.value=null!=c?c:""}},text:function(a,b){return null!=a.innerText?a.innerText=null!=b?b:"":a.textContent=null!=b?b:""},"on-*":{function:!0,routine:function(a,c){return this.currentListener&&b.Util.unbindEvent(a,this.args[0],this.currentListener),this.currentListener=b.Util.bindEvent(a,this.args[0],c,this.view)}},"each-*":{block:!0,bind:function(a,b){return a.removeAttribute(["data",this.view.config.prefix,this.type].join("-").replace("--","-"))},unbind:function(a,b){var c,d,e,f,g;if(null!=this.iterated){for(f=this.iterated,g=[],d=0,e=f.length;d<e;d++)c=f[d],g.push(c.unbind());return g}},routine:function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;if(null!=this.iterated)for(u=this.iterated,o=0,r=u.length;o<r;o++)for(n=u[o],n.unbind(),v=n.els,p=0,s=v.length;p<s;p++)e=v[p],e.parentNode.removeChild(e);else this.marker=document.createComment(" rivets: "+this.type+" "),a.parentNode.insertBefore(this.marker,a),a.parentNode.removeChild(a);if(this.iterated=[],c){for(z=[],q=0,t=c.length;q<t;q++){f=c[q],d={},w=this.view.models;for(j in w)i=w[j],d[j]=i;if(d[this.args[0]]=f,g=a.cloneNode(!0),l=this.iterated.length?this.iterated[this.iterated.length-1].els[0]:this.marker,this.marker.parentNode.insertBefore(g,null!=(x=l.nextSibling)?x:null),k={binders:this.view.options.binders,formatters:this.view.options.binders,config:{}},this.view.options.config){y=this.view.options.config;for(h in y)m=y[h],k.config[h]=m}k.config.preloadData=!0,n=new b.View(g,d,k),n.bind(),z.push(this.iterated.push(n))}return z}}},"class-*":function(a,b){var c;if(c=" "+a.className+" ",!b==(-1!==c.indexOf(" "+this.args[0]+" ")))return a.className=b?a.className+" "+this.args[0]:c.replace(" "+this.args[0]+" "," ").trim()},"*":function(a,b){return b?a.setAttribute(this.type,b):a.removeAttribute(this.type)}},b.config={preloadData:!0},b.formatters={},b.factory=function(a){return a.binders=b.binders,a.formatters=b.formatters,a.config=b.config,a.configure=function(a){var c,d;null==a&&(a={});for(c in a)d=a[c],b.config[c]=d},a.bind=function(a,c,d){var e;return null==c&&(c={}),null==d&&(d={}),e=new b.View(a,c,d),e.bind(),e}},"object"==typeof exports?b.factory(exports):"function"==typeof define&&define.amd?define(["exports"],function(a){return b.factory(this.rivets=a),a}):b.factory(this.rivets={})}.call(this);var c,d={AF:"Afghanistan",AX:"land Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia, Plurinational State of",BQ:"Bonaire, Sint Eustatius and Saba",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, the Democratic Republic of the",CK:"Cook Islands",CR:"Costa Rica",CI:"Cte d'Ivoire",HR:"Croatia",CU:"Cuba",CW:"Curaao",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and McDonald Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran, Islamic Republic of",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KP:"Korea, Democratic People's Republic of",KR:"Korea, Republic of",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia, the Former Yugoslav Republic of",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States of",MD:"Moldova, Republic of",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine, State of",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Runion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthlemy",SH:"Saint Helena, Ascension and Tristan da Cunha",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",MF:"Saint Martin (French part)",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome and Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SX:"Sint Maarten (Dutch part)",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",SS:"South Sudan",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan, Province of China",TJ:"Tajikistan",TZ:"Tanzania, United Republic of",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Minor Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela, Bolivarian Republic of",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"};c={},a.requireOnce=function(a,b){return void 0===c[a]?(c[a]=[],null!=b&&c[a].push(b),e.getScript(a,function(){var d,e,f;for(f=c[a],d=0,e=f.length;e>d;d++)(b=f[d])();return c[a]=!0})):!0===c[a]?"function"==typeof b?b():void 0:null!=b?c[a].push(b):void 0},function(b){"use strict";function c(a){var b={path:!0,query:!0,hash:!0};return a?(/^[a-z]+:/.test(a)&&(b.protocol=!0,b.host=!0,/[-a-z0-9]+(\.[-a-z0-9])*:\d+/i.test(a)&&(b.port=!0),/\/\/(.*?)(?::(.*?))?@/.test(a)&&(b.user=!0,b.pass=!0)),b):b}function d(a,b,d){var e,m,n,o=i?"file://"+(process.platform.match(/^win/i)?"/":"")+j("fs").realpathSync("."):document.location.href;b||(b=o),i?e=j("url").parse(b):(e=document.createElement("a"),e.href=b);var p=c(b);n=b.match(/\/\/(.*?)(?::(.*?))?@/)||[];for(m in k)a[m]=p[m]?e[k[m]]||"":"";if(a.protocol=a.protocol.replace(/:$/,""),a.query=a.query.replace(/^\?/,""),a.hash=f(a.hash.replace(/^#/,"")),a.user=f(n[1]||""),a.pass=f(n[2]||""),a.port=l[a.protocol]==a.port||0==a.port?"":a.port,!p.protocol&&/[^\/#?]/.test(b.charAt(0))&&(a.path=b.split("?")[0].split("#")[0]),!p.protocol&&d){var q=new h(o.match(/(.*\/)/)[0]),r=q.path.split("/"),s=a.path.split("/"),t=["protocol","user","pass","host","port"],u=t.length;for(r.pop(),m=0;u>m;m++)a[t[m]]=q[t[m]];for(;".."===s[0];)r.pop(),s.shift();a.path=("/"!==b.charAt(0)?r.join("/"):"")+"/"+s.join("/")}a.path=a.path.replace(/^\/{2,}/,"/"),a.paths(("/"===a.path.charAt(0)?a.path.slice(1):a.path).split("/")),a.query=new g(a.query)}function e(a){return encodeURIComponent(a).replace(/'/g,"%27")}function f(a){return a=a.replace(/\+/g," "),a=a.replace(/%([ef][0-9a-f])%([89ab][0-9a-f])%([89ab][0-9a-f])/gi,function(a,b,c,d){var e=parseInt(b,16)-224,f=parseInt(c,16)-128;if(0===e&&32>f)return a;var g=parseInt(d,16)-128,h=(e<<12)+(f<<6)+g;return h>65535?a:String.fromCharCode(h)}),a=a.replace(/%([cd][0-9a-f])%([89ab][0-9a-f])/gi,function(a,b,c){var d=parseInt(b,16)-192;if(2>d)return a;var e=parseInt(c,16)-128;return String.fromCharCode((d<<6)+e)}),a.replace(/%([0-7][0-9a-f])/gi,function(a,b){return String.fromCharCode(parseInt(b,16))})}function g(a){for(var b,c=/([^=&]+)(=([^&]*))?/g;b=c.exec(a);){var d=decodeURIComponent(b[1].replace(/\+/g," ")),e=b[3]?f(b[3]):"";void 0!==this[d]&&null!==this[d]?(this[d]instanceof Array||(this[d]=[this[d]]),this[d].push(e)):this[d]=e}}function h(a,b){d(this,a,!b)}var i=void 0===a&&"undefined"!=typeof global&&"function"==typeof require,j=i?b.require:null,k={protocol:"protocol",host:"hostname",port:"port",path:"pathname",query:"search",hash:"hash"},l={ftp:21,gopher:70,http:80,https:443,ws:80,wss:443};g.prototype.toString=function(){var a,b,c="",d=e;for(a in this)if(!(this[a]instanceof Function||null===this[a]))if(this[a]instanceof Array){var f=this[a].length;if(f)for(b=0;f>b;b++)c+=c?"&":"",c+=d(a)+"="+d(this[a][b]);else c+=(c?"&":"")+d(a)+"="}else c+=c?"&":"",c+=d(a)+"="+d(this[a]);return c},h.prototype.clearQuery=function(){for(var a in this.query)this.query[a]instanceof Function||delete this.query[a];return this},h.prototype.queryLength=function(){var a,b=0;for(a in this)this[a]instanceof Function||b++;return b},h.prototype.isEmptyQuery=function(){return 0===this.queryLength()},h.prototype.paths=function(a){var b,c="",d=0;if(a&&a.length&&a+""!==a){for(this.isAbsolute()&&(c="/"),b=a.length;b>d;d++)a[d]=!d&&a[d].match(/^\w:$/)?a[d]:e(a[d]);this.path=c+a.join("/")}for(a=("/"===this.path.charAt(0)?this.path.slice(1):this.path).split("/"),d=0,b=a.length;b>d;d++)a[d]=f(a[d]);return a},h.prototype.encode=e,h.prototype.decode=f,h.prototype.isAbsolute=function(){return this.protocol||"/"===this.path.charAt(0)},h.prototype.toString=function(){return(this.protocol&&this.protocol+"://")+(this.user&&e(this.user)+(this.pass&&":"+e(this.pass))+"@")+(this.host&&this.host)+(this.port&&":"+this.port)+(this.path&&this.path)+(this.query.toString()&&"?"+this.query)+(this.hash&&"#"+e(this.hash))},b[b.exports?"exports":"Url"]=h}("undefined"!=typeof module&&module.exports?module:a),function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.DOMPurify=b()}(this,function(){"use strict";function b(a,b){for(var c=b.length;c--;)"string"==typeof b[c]&&(b[c]=b[c].toLowerCase()),a[b[c]]=!0;return a}function c(a){var b={},c=void 0;for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b}function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function e(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p(),q=function(a){return e(a)};if(q.version="1.0.2",q.removed=[],!a||!a.document||9!==a.document.nodeType)return q.isSupported=!1,q;var r=a.document,s=!1,t=!1,u=a.document,v=a.DocumentFragment,w=a.HTMLTemplateElement,x=a.Node,y=a.NodeFilter,z=a.NamedNodeMap,A=void 0===z?a.NamedNodeMap||a.MozNamedAttrMap:z,B=a.Text,C=a.Comment,D=a.DOMParser,E=a.XMLHttpRequest,F=void 0===E?a.XMLHttpRequest:E,G=a.encodeURI,H=void 0===G?a.encodeURI:G;if("function"==typeof w){var I=u.createElement("template");I.content&&I.content.ownerDocument&&(u=I.content.ownerDocument)}var J=u,K=J.implementation,L=J.createNodeIterator,M=J.getElementsByTagName,N=J.createDocumentFragment,O=r.importNode,P={};q.isSupported=K&&void 0!==K.createHTMLDocument&&9!==u.documentMode;var Q=null,R=b({},[].concat(d(f),d(g),d(h),d(i),d(j))),S=null,T=b({},[].concat(d(k),d(l),d(m),d(n))),U=null,V=null,W=!0,X=!0,Y=!1,Z=!1,$=!1,_=/\{\{[\s\S]*|[\s\S]*\}\}/gm,aa=/<%[\s\S]*|[\s\S]*%>/gm,ba=!1,ca=!1,da=!1,ea=!1,fa=!1,ga=!1,ha=!0,ia=!0,ja={},ka=b({},["audio","head","math","script","style","template","svg","video"]),la=b({},["audio","video","img","source","image"]),ma=b({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),na=null,oa=u.createElement("form"),pa=function(a){"object"!==(void 0===a?"undefined":o(a))&&(a={}),Q="ALLOWED_TAGS"in a?b({},a.ALLOWED_TAGS):R,S="ALLOWED_ATTR"in a?b({},a.ALLOWED_ATTR):T,U="FORBID_TAGS"in a?b({},a.FORBID_TAGS):{},V="FORBID_ATTR"in a?b({},a.FORBID_ATTR):{},ja="USE_PROFILES"in a&&a.USE_PROFILES,W=!1!==a.ALLOW_ARIA_ATTR,X=!1!==a.ALLOW_DATA_ATTR,Y=a.ALLOW_UNKNOWN_PROTOCOLS||!1,Z=a.SAFE_FOR_JQUERY||!1,$=a.SAFE_FOR_TEMPLATES||!1,ba=a.WHOLE_DOCUMENT||!1,ea=a.RETURN_DOM||!1,fa=a.RETURN_DOM_FRAGMENT||!1,ga=a.RETURN_DOM_IMPORT||!1,da=a.FORCE_BODY||!1,ha=!1!==a.SANITIZE_DOM,ia=!1!==a.KEEP_CONTENT,$&&(X=!1),fa&&(ea=!0),ja&&(Q=b({},[].concat(d(j))),S=[],!0===ja.html&&(b(Q,f),b(S,k)),!0===ja.svg&&(b(Q,g),b(S,l),b(S,n)),!0===ja.svgFilters&&(b(Q,h),b(S,l),b(S,n)),!0===ja.mathMl&&(b(Q,i),b(S,m),b(S,n))),a.ADD_TAGS&&(Q===R&&(Q=c(Q)),b(Q,a.ADD_TAGS)),a.ADD_ATTR&&(S===T&&(S=c(S)),b(S,a.ADD_ATTR)),a.ADD_URI_SAFE_ATTR&&b(ma,a.ADD_URI_SAFE_ATTR),ia&&(Q["#text"]=!0),Object&&"freeze"in Object&&Object.freeze(a),na=a},qa=function(a){q.removed.push({element:a});try{a.parentNode.removeChild(a)}catch(b){a.outerHTML=""}},ra=function(a,b){q.removed.push({attribute:b.getAttributeNode(a),from:b}),b.removeAttribute(a)},sa=function(a){var b=void 0,c=void 0;if(da&&(a="<remove></remove>"+a),t){try{a=H(a)}catch(a){}var d=new F;d.responseType="document",d.open("GET","data:text/html;charset=utf-8,"+a,!1),d.send(null),b=d.response}if(s)try{b=(new D).parseFromString(a,"text/html")}catch(a){}return b&&b.documentElement||((c=(b=K.createHTMLDocument("")).body).parentNode.removeChild(c.parentNode.firstElementChild),c.outerHTML=a),M.call(b,ba?"html":"body")[0]};q.isSupported&&function(){var a=sa('<svg><g onload="this.parentNode.remove()"></g></svg>');a.querySelector("svg")||(t=!0);try{(a=sa('<svg><p><style><img src="</style><img src=x onerror=alert(1)//">')).querySelector("svg img")&&(s=!0)}catch(a){}}();var ta=function(a){return L.call(a.ownerDocument||a,a,y.SHOW_ELEMENT|y.SHOW_COMMENT|y.SHOW_TEXT,function(){return y.FILTER_ACCEPT},!1)},ua=function(a){return!(a instanceof B||a instanceof C||"string"==typeof a.nodeName&&"string"==typeof a.textContent&&"function"==typeof a.removeChild&&a.attributes instanceof A&&"function"==typeof a.removeAttribute&&"function"==typeof a.setAttribute)},va=function(a){return"object"===(void 0===x?"undefined":o(x))?a instanceof x:a&&"object"===(void 0===a?"undefined":o(a))&&"number"==typeof a.nodeType&&"string"==typeof a.nodeName},wa=function(a,b,c){P[a]&&P[a].forEach(function(a){a.call(q,b,c,na)})},xa=function(a){var b=void 0;if(wa("beforeSanitizeElements",a,null),ua(a))return qa(a),!0;var c=a.nodeName.toLowerCase();if(wa("uponSanitizeElement",a,{tagName:c,allowedTags:Q}),!Q[c]||U[c]){if(ia&&!ka[c]&&"function"==typeof a.insertAdjacentHTML)try{a.insertAdjacentHTML("AfterEnd",a.innerHTML)}catch(a){}return qa(a),!0}return!Z||a.firstElementChild||a.content&&a.content.firstElementChild||!/</g.test(a.textContent)||(q.removed.push({element:a.cloneNode()}),a.innerHTML=a.textContent.replace(/</g,"&lt;")),$&&3===a.nodeType&&(b=(b=(b=a.textContent).replace(_," ")).replace(aa," "),a.textContent!==b&&(q.removed.push({element:a.cloneNode()}),a.textContent=b)),wa("afterSanitizeElements",a,null),!1},ya=/^data-[\-\w.\u00B7-\uFFFF]/,za=/^aria-[\-\w]+$/,Aa=/^(?:(?:(?:f|ht)tps?|mailto|tel):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Ba=/^(?:\w+script|data):/i,Ca=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Da=function(b){var c=void 0,d=void 0,e=void 0,f=void 0,g=void 0,h=void 0,i=void 0;if(wa("beforeSanitizeAttributes",b,null),h=b.attributes){var j={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:S};for(i=h.length;i--;){if(c=h[i],d=c.name,e=c.value.trim(),f=d.toLowerCase(),j.attrName=f,j.attrValue=e,j.keepAttr=!0,wa("uponSanitizeAttribute",b,j),e=j.attrValue,"name"===f&&"IMG"===b.nodeName&&h.id)g=h.id,h=Array.prototype.slice.apply(h),ra("id",b),ra(d,b),h.indexOf(g)>i&&b.setAttribute("id",g.value);else{if("INPUT"===b.nodeName&&"type"===f&&"file"===e&&(S[f]||!V[f]))continue;"id"===d&&b.setAttribute(d,""),ra(d,b)}if(j.keepAttr&&(!ha||"id"!==f&&"name"!==f||!(e in a||e in u||e in oa))){if($&&(e=(e=e.replace(_," ")).replace(aa," ")),X&&ya.test(f));else if(W&&za.test(f));else{if(!S[f]||V[f])continue;if(ma[f]);else if(Aa.test(e.replace(Ca,"")));else if("src"!==f&&"xlink:href"!==f||0!==e.indexOf("data:")||!la[b.nodeName.toLowerCase()])if(Y&&!Ba.test(e.replace(Ca,"")));else if(e)continue}try{b.setAttribute(d,e),q.removed.pop()}catch(b){}}}wa("afterSanitizeAttributes",b,null)}},Ea=function a(b){var c=void 0,d=ta(b);for(wa("beforeSanitizeShadowDOM",b,null);c=d.nextNode();)wa("uponSanitizeShadowNode",c,null),xa(c)||(c.content instanceof v&&a(c.content),Da(c));wa("afterSanitizeShadowDOM",b,null)};return q.sanitize=function(b,c){var d=void 0,e=void 0,f=void 0,g=void 0,h=void 0;if(b||(b="\x3c!--\x3e"),"string"!=typeof b&&!va(b)){if("function"!=typeof b.toString)throw new TypeError("toString is not a function");b=b.toString()}if(!q.isSupported){if("object"===o(a.toStaticHTML)||"function"==typeof a.toStaticHTML){if("string"==typeof b)return a.toStaticHTML(b);if(va(b))return a.toStaticHTML(b.outerHTML)}return b}if(ca||pa(c),q.removed=[],b instanceof x)1===(e=(d=sa("\x3c!--\x3e")).ownerDocument.importNode(b,!0)).nodeType&&"BODY"===e.nodeName?d=e:d.appendChild(e);else{if(!ea&&!ba&&-1===b.indexOf("<"))return b;if(!(d=sa(b)))return ea?null:""}da&&qa(d.firstChild);for(var i=ta(d);f=i.nextNode();)3===f.nodeType&&f===g||xa(f)||(f.content instanceof v&&Ea(f.content),Da(f),g=f);if(ea){if(fa)for(h=N.call(d.ownerDocument);d.firstChild;)h.appendChild(d.firstChild);else h=d;return ga&&(h=O.call(r,h,!0)),h}return ba?d.outerHTML:d.innerHTML},q.setConfig=function(a){pa(a),ca=!0},q.clearConfig=function(){na=null,ca=!1},q.addHook=function(a,b){"function"==typeof b&&(P[a]=P[a]||[],P[a].push(b))},q.removeHook=function(a){P[a]&&P[a].pop()},q.removeHooks=function(a){P[a]&&(P[a]=[])},q.removeAllHooks=function(){P={}},q}var f=["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"],g=["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","audio","canvas","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","video","view","vkern"],h=["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence"],i=["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmuliscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mpspace","msqrt","mystyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"],j=["#text"],k=["accept","action","align","alt","autocomplete","background","bgcolor","border","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","coords","datetime","default","dir","disabled","download","enctype","face","for","headers","height","hidden","high","href","hreflang","id","ismap","label","lang","list","loop","low","max","maxlength","media","method","min","multiple","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","span","srclang","start","src","step","style","summary","tabindex","title","type","usemap","valign","value","width","xmlns"],l=["accent-height","accumulate","additivive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"],m=["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"],n=["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"],o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},p=function(){return void 0===a?null:a};return e()});var e,f;e=jQuery,f=_.str,rivets.inputEvent=document.addEventListener?"input":"keyup",rivets.binders.input={publishes:!0,routine:rivets.binders.value.routine,bind:function(a){return e(a).bind(rivets.inputEvent+".rivets",this.publish)},unbind:function(a){return e(a).unbind(rivets.inputEvent+".rivets")}},rivets.binders.checkedarray={publishes:!0,routine:function(a,b){return a.checked=_.contains(b,a.value)},bind:function(a){return e(a).bind("change.rivets",function(b){return function(){var c,d;return d=b.model.get(b.keypath)||[],c=a.checked?_.uniq(d.concat(a.value)):_.without(d,a.value),b.model.set(b.keypath,c)}}(this))},unbind:function(a){return e(a).unbind("change.rivets")}},rivets.binders.dobtradiogroup={publishes:!0,routine:function(a,b){return a.checked=e(a).hasClass("js_other_option")?this.model.get("value.other_checked"):_.contains(b,a.value)},bind:function(a){return e(a).bind("change.rivets",function(b){return function(){return e(a).hasClass("js_other_option")?(b.model.set("value.other_checked",!0),b.model.set(b.keypath,[])):(b.model.unset("value.other_checked"),b.model.unset("value.other_text"),b.model.set(b.keypath,[a.value]))}}(this))}},rivets.configure({prefix:"rv",adapter:{subscribe:function(a,b,c){return c.wrapped=function(a,b){return c(b)},a.on("change:"+b,c.wrapped)},unsubscribe:function(a,b,c){return a.off("change:"+b,c.wrapped)},read:function(a,b){return"cid"===b?a.cid:a.get(b)},publish:function(a,b,c){return a.cid?a.set(b,c):a[b]=c}}}),function(){var b;a.FormRenderer=b=Backbone.View.extend({defaults:{enablePages:!0,screendoorBase:"https://screendoor.dobt.co",target:"[data-formrenderer]",validateImmediately:!1,response:{},responderLanguage:void 0,preview:!1,skipValidation:void 0,saveParams:{},showLabels:!1,scrollToPadding:0,plugins:["Autosave","WarnBeforeUnload","BottomBar","ErrorBar","SavedSession"]},constructor:function(a){var c,d,f,g;for(this.fr=this,this.options=e.extend({},this.defaults,a),this.requests=0,this.state=new Backbone.Model({hasChanges:!1}),this.setElement(e(this.options.target)),this.$el.addClass("fr_form"),this.$el.data("formrenderer-instance",this),this.subviews={pages:{}},this.serverHeaders={"X-FR-Version":b.VERSION,"X-FR-URL":document.URL},this.plugins=_.map(this.options.plugins,function(a){return function(c){return new b.Plugins[c](a)}}(this)),g=this.plugins,d=0,f=g.length;d<f;d++)c=g[d],"function"==typeof c.beforeFormLoad&&c.beforeFormLoad();return this.$el.html(JST.main(this)),this.trigger("viewRendered",this),this.loadFromServer(function(a){return function(){var b,d,e,f;for(a.$el.find(".fr_loading").remove(),a.initFormComponents(a.options.response_fields,a.options.response.responses),a.initPages(),a.options.enablePages?a.initPagination():a.initNoPagination(),f=a.plugins,d=0,e=f.length;d<e;d++)c=f[d],"function"==typeof c.afterFormLoad&&c.afterFormLoad();return a.options.validateImmediately&&a.validate(),a.trigger("ready"),"function"==typeof(b=a.options).onReady?b.onReady():void 0}}(this)),this.$el.on("submit",function(a){return a.preventDefault()}),this},corsSupported:function(){return"withCredentials"in new XMLHttpRequest},projectUrl:function(){return this.options.screendoorBase+"/projects/"+this.options.project_id},loadFromServer:function(a){return null!=this.options.response_fields&&null!=this.options.response.responses?a():e.ajax({url:this.options.screendoorBase+"/api/form_renderer/load",type:"get",dataType:"json",data:this.loadParams(),headers:this.serverHeaders,success:function(c){return function(d){var e,f,g,h;return c.options.response.id=null!=(g=d.response)?g.id:void 0,(e=c.options).response_fields||(e.response_fields=d.project.response_fields),(f=c.options.response).responses||(f.responses=(null!=(h=d.response)?h.responses:void 0)||{}),null==c.options.afterSubmit&&(c.options.afterSubmit={method:"page",html:d.project.after_response_page_html||"<p>"+b.t.thanks+"</p>"}),a()}}(this),error:function(a){return function(c){var d;return a.corsSupported()?(a.$el.find(".fr_loading").text(b.t.error_loading+': "'+((null!=(d=c.responseJSON)?d.error:void 0)||"Unknown")+'"'),a.trigger("errorSaving",c)):a.$el.find(".fr_loading").html(b.t.not_supported.replace(/\:url/g,a.projectUrl()))}}(this)})},initPages:function(){var a,c,d,e,f,g;a=function(a){return function(){return a.subviews.pages[c]=new b.Views.Page({form_renderer:a})}}(this),this.numPages=this.formComponents.where({field_type:"page_break"}).length+1,this.state.set("activePage",1),c=1,a(),this.formComponents.each(function(b){return function(d){return"page_break"===d.get("field_type")?(c++,a()):b.subviews.pages[c].models.push(d)}}(this)),f=this.subviews.pages,g=[];for(e in f)d=f[e],g.push(this.$el.append(d.render().el));return g},initPagination:function(){return this.subviews.pagination=new b.Views.Pagination({form_renderer:this}),this.$el.prepend(this.subviews.pagination.render().el),this.subviews.pages[this.state.get("activePage")].show()},initNoPagination:function(){var a,b,c,d;c=this.subviews.pages,d=[];for(b in c)a=c[b],d.push(a.show());return d},activatePage:function(b){return this.subviews.pages[this.state.get("activePage")].hide(),this.subviews.pages[b].show(),a.scrollTo(0,this.options.scrollToPadding),this.state.set("activePage",b)},validate:function(){var a,b,c;c=this.subviews.pages;for(b in c)a=c[b],a.validate();return this.trigger("afterValidate afterValidate:all"),this.areAllPagesValid()},isPageVisible:function(a){var b;return null!=(b=this.subviews.pages[a])?b.isVisible():void 0},isPageValid:function(a){var b;return null!=(b=this.subviews.pages[a])?b.isValid():void 0},focusFirstError:function(){var b,c;return b=this.invalidPages()[0],this.activatePage(b),c=this.subviews.pages[b].firstViewWithError(),a.scrollTo(0,c.$el.offset().top-this.options.scrollToPadding),c.focus()},invalidPages:function(){var a;return _.filter(function(){a=[];for(var b=1,c=this.numPages;1<=c?b<=c:b>=c;1<=c?b++:b--)a.push(b);return a}.apply(this),function(a){return function(b){return!1===a.isPageValid(b)}}(this))},areAllPagesValid:function(){return 0===this.invalidPages().length},visiblePages:function(){return _.tap([],function(a){return function(b){var c,d,e;d=a.subviews.pages,e=[];for(c in d)d[c],a.isPageVisible(c)?e.push(b.push(parseInt(c,10))):e.push(void 0);return e}}(this))},isFirstPage:function(){var a;return!(a=this.visiblePages()[0])||this.state.get("activePage")===a},isLastPage:function(){var a;return!(a=_.last(this.visiblePages()))||this.state.get("activePage")===a},previousPage:function(){return this.visiblePages()[_.indexOf(this.visiblePages(),this.state.get("activePage"))-1]},nextPage:function(){return this.visiblePages()[_.indexOf(this.visiblePages(),this.state.get("activePage"))+1]},handlePreviousPage:function(){return this.activatePage(this.previousPage())},handleNextPage:function(){return this.isLastPage()||!this.options.enablePages?this.submit():this.activatePage(this.nextPage())},loadParams:function(){return{v:0,response_id:this.options.response.id,project_id:this.options.project_id,responder_language:this.options.responderLanguage}},saveParams:function(){return _.extend(this.loadParams(),{skip_validation:this.options.skipValidation},this.options.saveParams)},responsesChanged:function(){if(this.state.set("hasChanges",!0),this.isSaving)return this.changedWhileSaving=!0},save:function(a){if(null==a&&(a={}),!this.isSaving)return this.requests+=1,this.isSaving=!0,this.changedWhileSaving=!1,e.ajax({url:this.options.screendoorBase+"/api/form_renderer/save",type:"post",contentType:"application/json",dataType:"json",data:JSON.stringify(_.extend(this.saveParams(),{raw_responses:this.getValue(),submit:!!a.submit||void 0})),headers:this.serverHeaders,complete:function(a){return function(){return a.requests-=1,a.isSaving=!1,a.trigger("afterSave")}}(this),success:function(b){return function(c){var d;return b.state.set({hasChanges:b.changedWhileSaving,hasServerErrors:!1}),b.options.response.id=c.response_id,null!=(d=a.cb)?d.apply(b,arguments):void 0}}(this),error:function(a){return function(b){var c,d;return a.state.set({hasServerErrors:!0,serverErrorText:null!=(c=b.responseJSON)?c.error:void 0,serverErrorKey:null!=(d=b.responseJSON)?d.error_key:void 0,submitting:!1})}}(this)})},waitForRequests:function(a){return this.requests>0?setTimeout(function(b){return function(){return b.waitForRequests(a)}}(this),100):a()},submit:function(a){if(null==a&&(a={}),a.skipValidation||this.options.skipValidation||this.validate())return this.state.set("submitting",!0),this.waitForRequests(function(a){return function(){return a.options.preview?a._preview():a.save({submit:!0,cb:function(){return a.trigger("afterSubmit"),a._afterSubmit()}})}}(this))},_afterSubmit:function(){var b,c;return c=this.options.afterSubmit,"function"==typeof c?c.call(this):"string"==typeof c?a.location=c.replace(":id",this.options.response.id.split(",")[0]):"object"==typeof c&&"page"===c.method?(b=e("<div class='fr_after_submit_page'>"+c.html+"</div>"),this.$el.replaceWith(b)):console.log("[FormRenderer] Not sure what to do...")},_preview:function(){var b;return b=function(b){return function(){return a.location=b.options.preview.replace(":id",b.options.response.id.split(",")[0])}}(this),!this.state.get("hasChanges")&&this.options.response.id?b():this.save({cb:b})},reflectConditions:function(){var a,b,c,d;c=this.subviews.pages;for(b in c)a=c[b],a.reflectConditions();return null!=(d=this.subviews.pagination)?d.render():void 0}}),b.BUTTON_CLASS="fr_button",b.DEFAULT_LAT_LNG=[40.7700118,-73.9800453],b.MAPBOX_URL="https://api.tiles.mapbox.com/mapbox.js/v2.1.4/mapbox.js",b.EMAIL_REGEX=/^\s*([^@\s]{1,64})@((?:[-a-z0-9]+\.)+[a-z]{2,})\s*$/i,b.ADD_ROW_ICON="+",b.REMOVE_ROW_ICON="-",b.REMOVE_ENTRY_LINK_CLASS="fr_group_entry_remove",b.REMOVE_ENTRY_LINK_HTML="Remove",b.Views={},b.Models={},b.Plugins={},b.Validators={EmailValidator:{VALID_REGEX:b.EMAIL_REGEX}},b.addPlugin=function(a){return this.prototype.defaults.plugins.push(a)},b.removePlugin=function(a){return this.prototype.defaults.plugins=_.without(this.prototype.defaults.plugins,a)}}.call(this),function(){FormRenderer.formComponentViewClass=function(a){var b;return a.group?FormRenderer.Views.ResponseFieldRepeatingGroup:(b=FormRenderer.Views["ResponseField"+f.classify(a.field_type)])?b:FormRenderer.Views.ResponseField},FormRenderer.buildFormComponentView=function(a,b){return new(FormRenderer.formComponentViewClass(a))({model:a,form_renderer:b})},FormRenderer.formComponentModelClass=function(a){return FormRenderer.Models["ResponseField"+f.classify(a.field_type)]},FormRenderer.buildFormComponentModel=function(a,b,c){return new(FormRenderer.formComponentModelClass(a))(a,b,c)}}.call(this),function(){var a,b,c,d,e;b=["a","p","br","b","strong","em","i"],a=["href","target"],c=function(a){var b;return b=/(^|[\s\n]|<br\/?>)((?:https?|ftp):\/\/[\-A-Z0-9+\u0026\u2019@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~()_|])/gi,a.replace(b,"$1<a href='$2' target='_blank'>$2</a>")},e=function(a){return null==a&&(a=""),(""+a).replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br />$2")},d=function(c){return DOMPurify.sanitize(c,{ALLOWED_TAGS:b,ALLOWED_ATTR:a})},FormRenderer.formatAndSanitizeHTML=function(a){return d(c(e(a)))}}.call(this),function(){FormRenderer.getLength=function(a,b){var c;return c=f.trim(b),"words"===a?(c.replace(/['";:,.?\-!]+/g,"").match(/\S+/g)||"").length:c.length}}.call(this),function(){FormRenderer.normalizeNumber=function(a,b){var c;return c=a.replace(/,/g,"").replace(/-/g,"").replace(/^\+/,"").trim(),b&&(c=c.replace(new RegExp(b+"$","i"),"").trim()),c}}.call(this),function(){FormRenderer.toBoolean=function(a){return _.contains(["True","Yes","true","1",1,"yes",!0],a)}}.call(this),function(){FormRenderer.VERSION="1.2.10"}.call(this),function(){var a;a=["US","GB","CA"],FormRenderer.ORDERED_COUNTRIES=_.uniq(_.union(a,[void 0],_.keys(d))),FormRenderer.PROVINCES_CA=["Alberta","British Columbia","Labrador","Manitoba","New Brunswick","Newfoundland","Nova Scotia","Nunavut","Northwest Territories","Ontario","Prince Edward Island","Quebec","Saskatchewen","Yukon"],FormRenderer.PROVINCES_US=["Alabama","Alaska","American Samoa","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","District Of Columbia","Federated States Of Micronesia","Florida","Georgia","Guam","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Marshall Islands","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Northern Mariana Islands","Ohio","Oklahoma","Oregon","Palau","Pennsylvania","Puerto Rico","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virgin Islands","Virginia","Washington","West Virginia","Wisconsin","Wyoming"]}.call(this),function(){var a,b=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};a=["present","blank"],FormRenderer.ConditionChecker=function(){function c(a,b){var c;this.responseField=a,this.condition=b,this.value=(null!=(c=this.responseField)?c.toText():void 0)||""}return c.prototype.method_eq=function(){return this.value.toLowerCase()===this.condition.value.toLowerCase()},c.prototype.method_contains=function(){return this.value.toLowerCase().indexOf(this.condition.value.toLowerCase())>-1},c.prototype.method_not=function(){return!this.method_eq()},c.prototype.method_does_not_contain=function(){return!this.method_contains()},c.prototype.method_gt=function(){return parseFloat(this.value)>parseFloat(this.condition.value)},c.prototype.method_lt=function(){return parseFloat(this.value)<parseFloat(this.condition.value)},c.prototype.method_shorter=function(){return this.length()<parseInt(this.condition.value,10)},c.prototype.method_longer=function(){return this.length()>parseInt(this.condition.value,10)},c.prototype.method_present=function(){return!!this.value.match(/\S/)},c.prototype.method_blank=function(){return!this.method_present()},c.prototype.length=function(){return FormRenderer.getLength(this.responseField.getLengthValidationUnits(),this.value)},c.prototype.isValid=function(){var c;return this.responseField&&_.all(["response_field_id","method"],function(a){return function(b){return a.condition[b]}}(this))&&(c=this.condition.method,b.call(a,c)>=0||this.condition.value)},c.prototype.isVisible=function(){var c;return!this.isValid()||(c=this.condition.method,b.call(a,c)>=0?this["method_"+this.condition.method]():this.method_present()&&this["method_"+this.condition.method]())},c}()}.call(this),function(){FormRenderer.Models.BaseFormComponent=Backbone.DeepModel.extend({initialize:function(a,b,c){return this.fr=b,this.parent=c,this.calculateVisibility()},sync:function(){},validateComponent:function(){},setExistingValue:function(){},shouldPersistValue:function(){return this.isVisible&&(this.group||this.input_field)},getConditions:function(){return this.get("conditions")||[]},isRequired:function(){return this.get("required")},isConditional:function(){return this.getConditions().length>0},parentGroupIsHidden:function(){return null!=this.parent.repeatingGroup&&!this.parent.repeatingGroup.isVisible},calculateVisibilityIsChanged:function(){var a;return a=!!this.isVisible,this.calculateVisibility(),a!==this.isVisible},calculateVisibility:function(){return this.isVisible=this._calculateIsVisible()},_calculateIsVisible:function(){return!this.fr||this.satisfiesConditions(this.parent.formComponents)},satisfiesConditions:function(a){return!this.isConditional()||_[this.conditionMethod()](this.getConditions(),function(b){return function(b){var c;return c=new FormRenderer.ConditionChecker(a.get(b.response_field_id),b),c.isVisible()}}())},conditionMethod:function(){return"any"===this.get("condition_method")?"any":"all"}})}.call(this),function(){var a,b=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};a=function(a){return a&&(a.hasAttribute("data-fr-next-page")||a.hasAttribute("data-fr-previous-page"))},FormRenderer.Models.ResponseField=FormRenderer.Models.BaseFormComponent.extend({input_field:!0,wrapper:"label",field_type:void 0,validators:[],ignoreKeysWhenCheckingPresence:function(){return[]},initialize:function(){if(FormRenderer.Models.BaseFormComponent.prototype.initialize.apply(this,arguments),this.errors=[],this.hasLengthValidation())return this.listenTo(this,"change:value",this.calculateLength)},getError:function(){if(this.errors.length>0)return this.errors.join(" ")},calculateLength:function(){return this.set("currentLength",FormRenderer.getLength(this.getLengthValidationUnits(),this.get("value")))},getLengthValidationUnits:function(){return this.get("min_max_length_units")||"characters"},setExistingValue:function(a){if(a&&this.set("value",a),this.hasLengthValidation())return this.calculateLength()},getValue:function(){return this.get("value")||this.defaultValue()},defaultValue:function(){if("hash"===this.valueType)return{}},toText:function(){return this.getValue()},hasValue:function(){return"hash"===this.valueType?_.some(this.get("value")||{},function(a){return function(c,d){return!(b.call(a.ignoreKeysWhenCheckingPresence(),d)>=0||!c)}}(this)):!!this.get("value")},getOptions:function(){return this.get("options")||[]},getColumns:function(){return this.get("columns")||[]},getSize:function(){return this.get("size")||"small"},sizeToHeaderTag:function(){return{large:"h2",medium:"h3",small:"h4"}[this.getSize()]}}),FormRenderer.Views.ResponseField=Backbone.View.extend({className:"fr_response_field",events:{"blur input, textarea, select":"_onBlur"},initialize:function(a){return this._sharedInitialize(a),this.listenTo(this.model,"afterValidate",this.render),this.listenTo(this.model,"change",this._onInput),this.listenTo(this.model,"change:currentLength",this.auditLength),this.listenTo(this.model,"change:error",this.toggleErrorModifier),this.$el.addClass("fr_response_field_"+this.model.field_type)},_onBlur:function(b){if(this.model.hasValue())return setTimeout(function(b){return function(){var c;if(c=document.activeElement,!e.contains(b.el,c))return a(c)?e(document).one("mouseup",function(){return b.model.validateComponent()}):b.model.validateComponent()}}(this),1)},_onInput:function(){if(this.model.errors.length>0)return this.model.validateComponent({clearOnly:!0})},focus:function(){return this.$el.find(":input:eq(0)").focus()},auditLength:function(){var a,b;if(this.model.hasLengthValidation()&&(a=this.$el.find(".fr_length_counter"))[0])return b=this.model.validateLength(),"short"===b?a.addClass("is_short").removeClass("is_long"):"long"===b?a.addClass("is_long").removeClass("is_short"):a.removeClass("is_short is_long")},toggleErrorModifier:function(){return this.$el[this.model.getError()?"addClass":"removeClass"]("error")},partialName:function(){return this.model.input_field?"response_field":"non_input_response_field"},render:function(){var a;return this.$el.html(JST["partials/"+this.partialName()](this)),rivets.bind(this.$el,{model:this.model}),this.auditLength(),null!=(a=this.form_renderer)&&a.trigger("viewRendered",this),this}})}.call(this),function(){FormRenderer.Models.NonInputResponseField=FormRenderer.Models.ResponseField.extend({input_field:!1,validateComponent:function(){}})}.call(this),function(){FormRenderer.Models.ResponseFieldRepeatingGroup=FormRenderer.Models.BaseFormComponent.extend({group:!0,field_type:"repeating_group",initialize:function(){return FormRenderer.Models.BaseFormComponent.prototype.initialize.apply(this,arguments),this.entries=[]},validateComponent:function(){var a,b,c,d,e;for(d=this.entries,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(a.formComponents.invoke("validateComponent"));return e},setExistingValue:function(a){return this.isRequired()?a&&0!==a.length||(a=[{}]):a?_.isArray(a)&&_.isEmpty(a)&&this.set("skipped",!0):a=[{}],this.entries=_.map(a,function(a){return function(b){return new FormRenderer.Models.ResponseFieldRepeatingGroupEntry({value:b},a.fr,a)}}(this))},addEntry:function(){return this.entries.push(new FormRenderer.Models.ResponseFieldRepeatingGroupEntry({},this.fr,this))},removeEntry:function(a){if(this.entries.splice(a,1),0===this.entries.length)return this.set("skipped",!0)},isSkipped:function(){return!!this.get("skipped")},getValue:function(){return this.isSkipped()?[]:_.invoke(this.entries,"getValue")},maxEntries:function(){return this.get("maxentries")?parseInt(this.get("maxentries"),10)||1/0:1/0},canAdd:function(){return this.entries.length<this.maxEntries()}}),FormRenderer.Models.ResponseFieldRepeatingGroupEntry=Backbone.Model.extend({field_type:"repeating_group_entry",initialize:function(a,b,c){var d;return this.fr=b,this.repeatingGroup=c,d=this.repeatingGroup.get("children"),null==d&&(d=[]),this.initFormComponents(d,this.get("value")||{})},reflectConditions:function(){return this.view.reflectConditions()},canRemove:function(){return this.repeatingGroup.entries.length>1}}),FormRenderer.Views.ResponseFieldRepeatingGroup=Backbone.View.extend({className:"fr_response_field fr_response_field_group",events:{"click .js-remove-entry":"removeEntry","click .js-add-entry":"addEntry","click .js-skip":"toggleSkip"},initialize:function(a){return this._sharedInitialize(a),this.on("shown",function(a){return function(){var b,c,d,e,f;for(e=a.views,f=[],c=0,d=e.length;c<d;c++)b=e[c],f.push(b.trigger("shown"));return f}}(this)),this.on("hidden",function(a){return function(){var b,c,d,e,f;for(e=a.views,f=[],c=0,d=e.length;c<d;c++)b=e[c],f.push(b.trigger("hidden"));return f}}(this))},toggleSkip:function(){return this.model.set("skipped",!this.model.isSkipped()),this.model.isSkipped()||0!==this.model.entries.length||this.addEntry(),this.render()},addEntry:function(){return this.model.addEntry(),this.render(),_.last(this.views).focus()},removeEntry:function(a){var b;return b=this.$el.find(".js-remove-entry").index(a.target.closest(".js-remove-entry")),this.model.removeEntry(b),this.render()},render:function(){var a,b,c,d,f,g,h,i;for(this.views=[],a=e(),h=this.model.entries||[],c=f=0,g=h.length;f<g;c=++f)b=h[c],d=new FormRenderer.Views.ResponseFieldRepeatingGroupEntry({entry:b,form_renderer:this.form_renderer,idx:c}),b.view=d,a=a.add(d.render().el),this.views.push(d);return this.$el.html(JST["partials/repeating_group"](this)),this.$el.removeClass("is_truncated"),this.model.entries.length&&this.model.entries[0].formComponents.length>0&&this.$el.addClass("is_truncated"),rivets.bind(this.$el,{model:this.model}),this.$el.find(".fr_group_entries").append(a),null!=(i=this.form_renderer)&&i.trigger("viewRendered",this),this}}),FormRenderer.Views.ResponseFieldRepeatingGroupEntry=Backbone.View.extend({className:"fr_group_entry",initialize:function(a){return this.entry=a.entry,this.form_renderer=a.form_renderer,this.idx=a.idx,this.views=[],this.on("shown",function(a){return function(){var b,c,d,e,f;for(e=a.views,f=[],c=0,d=e.length;c<d;c++)b=e[c],f.push(b.trigger("shown"));return f}}(this)),this.on("hidden",function(a){return function(){var b,c,d,e,f;for(e=a.views,f=[],c=0,d=e.length;c<d;c++)b=e[c],f.push(b.trigger("hidden"));return f}}(this))},render:function(){var a,b;return this.$el.html(JST["partials/repeating_group_entry"](this)),null!=(b=this.form_renderer)&&b.trigger("viewRendered",this),a=this.$el.find(".fr_group_entry_fields"),this.entry.formComponents.each(function(b){return function(c){var d;return d=FormRenderer.buildFormComponentView(c,b.form_renderer),a.append(d.render().el),d.reflectConditions(),b.views.push(d)}}(this)),this},reflectConditions:function(){var a,b,c,d,e;for(d=this.views,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(a.reflectConditions());return e},focus:function(){return this.views[0].focus()}})}.call(this),function(){FormRenderer.Models.ResponseFieldAddress=FormRenderer.Models.ResponseField.extend({wrapper:"fieldset",field_type:"address",valueType:"hash",ignoreKeysWhenCheckingPresence:function(){return"country"===this.get("address_format")?[]:["country"]},setExistingValue:function(a){if(FormRenderer.Models.ResponseField.prototype.setExistingValue.apply(this,arguments),!(null!=a?a.country:void 0))return this.set("value.country","US")},toText:function(){return _.values(_.pick(this.getValue(),"street","city","state","zipcode","country")).join(" ")}}),FormRenderer.Views.ResponseFieldAddress=FormRenderer.Views.ResponseField.extend({initialize:function(){return FormRenderer.Views.ResponseField.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:value.country",this.render)}})}.call(this),function(){FormRenderer.Models.ResponseFieldBlockOfText=FormRenderer.Models.NonInputResponseField.extend({field_type:"block_of_text"}),FormRenderer.Views.ResponseFieldBlockOfText=FormRenderer.Views.ResponseField.extend({field_type:"block_of_text"})}.call(this),function(){FormRenderer.Models.ResponseFieldCheckboxes=FormRenderer.Models.ResponseField.extend({field_type:"checkboxes",wrapper:"fieldset",setExistingValue:function(a){var b,c,d,e,f;if(null==a){for(b={checked:[]},f=this.getOptions(),d=0,e=f.length;d<e;d++)c=f[d],FormRenderer.toBoolean(c.checked)&&b.checked.push(c.label);return this.set("value",b)}return FormRenderer.Models.ResponseField.prototype.setExistingValue.apply(this,arguments)},toText:function(){var a,b;return a=(null!=(b=this.get("value.checked"))?b.slice(0):void 0)||[],!0===this.get("value.other_checked")&&a.push(this.get("value.other_text")),a.join(" ")},hasValue:function(){var a;return(null!=(a=this.get("value.checked"))?a.length:void 0)>0||this.get("value.other_checked")}}),FormRenderer.Views.ResponseFieldCheckboxes=FormRenderer.Views.ResponseField.extend({wrapper:"fieldset",field_type:"checkboxes"})}.call(this),function(){FormRenderer.Models.ResponseFieldConfirm=FormRenderer.Models.ResponseField.extend({field_type:"confirm",wrapper:"none",getValue:function(){return this.get("value")||!1},setExistingValue:function(a){return this.set("value",!!a)},toText:function(){return this.get("value")?"Yes":"No"}}),FormRenderer.Views.ResponseFieldConfirm=FormRenderer.Views.ResponseField.extend({wrapper:"none",field_type:"confirm"})}.call(this),function(){FormRenderer.Models.ResponseFieldDate=FormRenderer.Models.ResponseField.extend({wrapper:"fieldset",field_type:"date",valueType:"hash",toText:function(){return _.values(_.pick(this.getValue(),"month","day","year")).join("/")},validateType:function(){var a,b,c,d,e,f;if(f=this.get("disable_year")?2e3:parseInt(this.get("value.year"),10)||0,a=parseInt(this.get("value.day"),10)||0,e=parseInt(this.get("value.month"),10)||0,c=1===new Date(f,1,29).getMonth()?29:28,b=[31,c,31,30,31,30,31,31,30,31,30,31],d=b[e-1],!(f>0&&0<e&&e<=12&&0<a&&a<=d))return"date"}}),FormRenderer.Views.ResponseFieldDate=FormRenderer.Views.ResponseField.extend({wrapper:"fieldset",field_type:"date"})}.call(this),function(){FormRenderer.Models.ResponseFieldDropdown=FormRenderer.Models.ResponseField.extend({field_type:"dropdown",setExistingValue:function(a){var b;return null!=a?FormRenderer.Models.ResponseField.prototype.setExistingValue.apply(this,arguments):(b=_.find(this.getOptions(),function(a){return FormRenderer.toBoolean(a.checked)}),b||this.get("include_blank_option")||(b=_.first(this.getOptions())),b?this.set("value",b.label):this.unset("value"))}}),FormRenderer.Views.ResponseFieldDropdown=FormRenderer.Views.ResponseField.extend({field_type:"dropdown"})}.call(this),function(){FormRenderer.Models.ResponseFieldEmail=FormRenderer.Models.ResponseField.extend({field_type:"email",validateType:function(){if(!this.get("value").match(FormRenderer.EMAIL_REGEX))return"email"}}),FormRenderer.Views.ResponseFieldEmail=FormRenderer.Views.ResponseField.extend({field_type:"email"})}.call(this),function(){FormRenderer.Models.ResponseFieldFile=FormRenderer.Models.ResponseField.extend({wrapper:"fieldset",field_type:"file",addFile:function(a,b){var c;return c=this.getFiles().slice(0),c.push({id:a,filename:b}),this.set("value",c)},removeFile:function(a){var b;return b=this.getFiles().slice(0),b.splice(a,1),this.set("value",b)},getFiles:function(){return this.get("value")||[]},canAddFile:function(){return this.getFiles().length<this.maxFiles()},toText:function(){return _.compact(_.pluck(this.getFiles(),"filename")).join(" ")},hasValue:function(){return _.any(this.getFiles(),function(a){return!!a.id})},getAcceptedExtensions:function(){var a;if(a=FormRenderer.FILE_TYPES[this.get("file_types")])return _.map(a,function(a){return"."+a})},getValue:function(){return this.getFiles()},maxFiles:function(){return this.get("allow_multiple_files")?10:1}}),FormRenderer.Views.ResponseFieldFile=FormRenderer.Views.ResponseField.extend({events:_.extend({},FormRenderer.Views.ResponseField.prototype.events,{"click [data-fr-remove-file]":"doRemove"}),render:function(){var a;return FormRenderer.Views.ResponseField.prototype.render.apply(this,arguments),this.$input=this.$el.find("input"),this.$label=this.$el.find(".fr_add_file label"),this.$error=this.$el.find(".fr_add_file .fr_error"),a=void 0,this.$label.on("click",function(a){if(e(this).hasClass("disabled"))return a.preventDefault()}),this.form_renderer&&this.$input.inlineFileUpload({method:"post",action:this.form_renderer.options.screendoorBase+"/api/form_renderer/file",ajaxOpts:{headers:this.form_renderer.serverHeaders},additionalParams:{project_id:this.form_renderer.options.project_id,response_field_id:this.model.get("id"),v:0},start:function(b){return function(c){return a=c.filename,b.$label.addClass("disabled"),b.$label.text(FormRenderer.t.uploading),b.form_renderer.requests+=1}}(this),progress:function(a){return function(b){return a.$label.text(100===b.percent?FormRenderer.t.finishing_up:FormRenderer.t.uploading+" ("+b.percent+"%)")}}(this),complete:function(a){return function(){return a.form_renderer.requests-=1}}(this),success:function(b){return function(c){return b.model.addFile(c.data.file_id,a),b.render()}}(this),error:function(a){return function(b){var c,d;return a.render(),c=null!=(d=b.xhr.responseJSON)?d.errors:void 0,a.$error.text(c||FormRenderer.t.error).show(),setTimeout(function(){return a.$error.hide()},2e3)}}(this)}),this},doRemove:function(a){var b;return b=this.$el.find("[data-fr-remove-file]").index(a.target),this.model.removeFile(b),this.render()}})}.call(this),function(){FormRenderer.Models.ResponseFieldIdentification=FormRenderer.Models.ResponseField.extend({field_type:"identification",valueType:"hash",isRequired:function(){return!0},validateType:function(){return this.get("value.email")&&this.get("value.name")?this.get("value.email").match(FormRenderer.EMAIL_REGEX)?void 0:"email":"identification"}}),FormRenderer.Views.ResponseFieldIdentification=FormRenderer.Views.ResponseField.extend({field_type:"identification"})}.call(this),function(){FormRenderer.loadLeaflet=function(a){return null!=("undefined"!=typeof L&&null!==L?L.GeoJSON:void 0)?a():requireOnce(FormRenderer.MAPBOX_URL,a)},FormRenderer.initMap=function(a){return L.mapbox.accessToken="pk.eyJ1IjoiYWRhbWphY29iYmVja2VyIiwiYSI6Im1SVEQtSm8ifQ.ZgEOSXsv9eLfGQ-9yAmtIg",L.mapbox.map(a,"adamjacobbecker.ja7plkah")},FormRenderer.Models.ResponseFieldMapMarker=FormRenderer.Models.ResponseField.extend({field_type:"map_marker",latLng:function(){return this.get("value")},defaultLatLng:function(){var a,b;if((a=this.get("default_lat"))&&(b=this.get("default_lng")))return[a,b]}}),FormRenderer.Views.ResponseFieldMapMarker=FormRenderer.Views.ResponseField.extend({events:_.extend({},FormRenderer.Views.ResponseField.prototype.events,{"click .fr_map_cover":"enable","click [data-fr-clear-map]":"disable"}),initialize:function(){return FormRenderer.Views.ResponseField.prototype.initialize.apply(this,arguments),this.on("shown",function(){var a;return this.refreshing=!0,null!=(a=this.map)&&a._onResize(),setTimeout(function(a){return function(){return a.refreshing=!1}}(this),0)})},render:function(){return FormRenderer.Views.ResponseField.prototype.render.apply(this,arguments),this.$cover=this.$el.find(".fr_map_cover"),FormRenderer.loadLeaflet(function(a){return function(){if(a.initMap(),a.model.latLng())return a.enable()}}(this)),this},initMap:function(){return this.map=FormRenderer.initMap(this.$el.find(".fr_map_map")[0]),this.$el.find(".fr_map_map").data("map",this.map),this.map.setView(this.model.latLng()||this.model.defaultLatLng()||FormRenderer.DEFAULT_LAT_LNG,13),this.marker=L.marker([0,0]),this.map.on("move",e.proxy(this._onMove,this))},_onMove:function(){var a;if(!this.refreshing)return a=this.map.getCenter(),this.marker.setLatLng(a),this.model.set({value:[a.lat.toFixed(7),a.lng.toFixed(7)]}),this.model.trigger("change:value.0 change:value.1")},enable:function(){if(this.map)return this.map.addLayer(this.marker),this.$cover.hide(),this._onMove()},disable:function(a){return a.preventDefault(),this.map.removeLayer(this.marker),this.$el.find(".fr_map_cover").show(),this.model.unset("value")}})}.call(this),function(){FormRenderer.Models.ResponseFieldNumber=FormRenderer.Models.ResponseField.extend({field_type:"number",validateType:function(){var a;if(a=FormRenderer.normalizeNumber(this.get("value"),this.get("units")),!a.match(/^-?\d*(\.\d+)?$/))return"number"}}),FormRenderer.Views.ResponseFieldNumber=FormRenderer.Views.ResponseField.extend({calculateSize:function(){var a,b;return a=(b=parseInt(this.model.get("max"),10))?(""+b).length:6,this.model.get("integer_only")||(a+=2),a>6?"seven_plus":a>3?"four_six":"one_three"}})}.call(this),function(){FormRenderer.Models.ResponseFieldPageBreak=FormRenderer.Models.NonInputResponseField.extend({field_type:"page_break"}),FormRenderer.Views.ResponseFieldPageBreak=FormRenderer.Views.ResponseField.extend({field_type:"page_break"})}.call(this),function(){FormRenderer.Models.ResponseFieldParagraph=FormRenderer.Models.ResponseField.extend({field_type:"paragraph"}),FormRenderer.Views.ResponseFieldParagraph=FormRenderer.Views.ResponseField.extend({field_type:"paragraph"})}.call(this),function(){FormRenderer.Models.ResponseFieldPhone=FormRenderer.Models.ResponseField.extend({field_type:"phone",validateType:function(){var a,b,c,d;if(b="us"===this.get("phone_format"),c=b?10:7,a=(null!=(d=this.get("value").match(/\d/g))?d.join(""):void 0)||"",!(a.length>=c))return b?"us_phone":"phone"}}),FormRenderer.Views.ResponseFieldPhone=FormRenderer.Views.ResponseField.extend({phonePlaceholder:function(){if("us"===this.model.get("phone_format"))return"(xxx) xxx-xxxx"}})}.call(this),function(){FormRenderer.Models.ResponseFieldPrice=FormRenderer.Models.ResponseField.extend({wrapper:"fieldset",field_type:"price",valueType:"hash",toText:function(){return(this.getValue().dollars||"0")+"."+(this.getValue().cents||"00")},validateType:function(){var a;if(a=[],this.get("value.dollars")&&a.push((""+this.get("value.dollars")).replace(/,/g,"").replace(/^\$/,"")),this.get("value.cents")&&a.push(""+this.get("value.cents")),!_.every(a,function(a){return a.match(/^-?\d+$/)}))return"price"}}),FormRenderer.Views.ResponseFieldPrice=FormRenderer.Views.ResponseField.extend({events:_.extend({},FormRenderer.Views.ResponseField.prototype.events,{'blur [data-rv-input="model.value.cents"]':"formatCents"}),formatCents:function(a){var b;if((b=e(a.target).val())&&b.match(/^\d$/))return this.model.set("value.cents","0"+b)}})}.call(this),function(){FormRenderer.Models.ResponseFieldRadio=FormRenderer.Models.ResponseFieldCheckboxes.extend({field_type:"radio",wrapper:"fieldset"}),FormRenderer.Views.ResponseFieldRadio=FormRenderer.Views.ResponseField.extend({wrapper:"fieldset",field_type:"radio"})}.call(this),function(){FormRenderer.Models.ResponseFieldSectionBreak=FormRenderer.Models.NonInputResponseField.extend({field_type:"section_break"}),FormRenderer.Views.ResponseFieldSectionBreak=FormRenderer.Views.ResponseField.extend({field_type:"section_break"})}.call(this),function(){FormRenderer.Models.ResponseFieldTable=FormRenderer.Models.ResponseField.extend({field_type:"table",initialize:function(){if(FormRenderer.Models.ResponseField.prototype.initialize.apply(this,arguments),this.get("column_totals"))return this.listenTo(this,"change:value.*",this.calculateColumnTotals)},canAddRows:function(){return this.numRows()<this.maxRows()},minRows:function(){return parseInt(this.get("minrows"),10)||0},maxRows:function(){return this.get("maxrows")?parseInt(this.get("maxrows"),10)||1/0:1/0},setExistingValue:function(a){var b,c;return b=Math.max(this.minRows(),(null!=(c=_.values(a)[0])?c.length:void 0)||0,1),this.set("value",_.tap([],function(c){return function(d){var e,f,g,h,i,j,k;for(i=c.getColumns(),j=[],g=0,h=i.length;g<h;g++)f=i[g],e=_.map(function(){k=[];for(var a=0,c=b-1;0<=c?a<=c:a>=c;0<=c?a++:a--)k.push(a);return k}.apply(this),function(b){var d;return c.getPresetValue(f.label,b)||(null!=a&&null!=(d=a[f.label])?d[b]:void 0)}),j.push(d.push(e));return j}}(this)))},numRows:function(){var a;return a=this.get("value"),null!=a&&a.length?Math.max(this.minRows(),a[0].length||0,1):0},hasValue:function(){return _.some(this.getValue(),function(a){return function(b,c){return _.some(b,function(b,d){return!a.getPresetValue(c,d)&&!!b})}}(this))},getPresetValue:function(a,b){var c,d;return null!=(c=this.get("preset_values"))&&null!=(d=c[a])?d[b]:void 0},getValue:function(){return _.tap({},function(a){return function(b){var c,d,e,f,g,h,i;for(h=a.getColumns(),i=[],e=f=0,g=h.length;f<g;e=++f)c=h[e],b[c.label]=[],i.push(function(){var a,f,g;for(g=[],d=a=0,f=this.numRows()-1;0<=f?a<=f:a>=f;d=0<=f?++a:--a)g.push(b[c.label].push(this.get("value."+e+"."+d)||""));return g}.call(a));return i}}(this))},toText:function(){return _.flatten(_.values(this.getValue())).join(" ")},calculateColumnTotals:function(){var a,b,c,d,e,f,g,h,i,j;for(h=this.getColumns(),j=[],d=e=0,g=h.length;e<g;d=++e){for(h[d],b=[],c=f=0,i=this.numRows()-1;0<=i?f<=i:f>=i;c=0<=i?++f:--f)b.push(parseFloat((this.get("value."+d+"."+c)||"").replace(/\$?,?/g,"")));a=_.reduce(b,function(a,b){return _.isNaN(b)?a:a+b},0),j.push(this.set("columnTotals."+d,this.formatColumnSum(a)))}return j},formatColumnSum:function(a){var b,c,d;return a>0?(b=parseFloat(a.toFixed(10)),c=(null!=(d=(""+b).split(".")[1])?d.length:void 0)||0,f.numberFormat(b,c,".",",")):""}}),FormRenderer.Views.ResponseFieldTable=FormRenderer.Views.ResponseField.extend({events:_.extend({},FormRenderer.Views.ResponseField.prototype.events,{"click .js-add-row":"addRow","click .js-remove-row":"removeRow"}),canRemoveRow:function(a){var b;return b=Math.max(1,this.model.minRows()),a>b-1},addRow:function(a){var b,c,d,e;a.preventDefault(),c={},e=this.model.get("value");for(b in e)d=e[b],c[b]=d.concat("");return this.model.set("value",c),this.render()},removeRow:function(a){var b,c,d,f,g;a.preventDefault(),c=e(a.currentTarget).closest("[data-row-index]").data("row-index"),d={},g=this.model.get("value");for(b in g)f=g[b],d[b]=_.tap([],function(a){var b,d,e;e=[];for(b in f)d=f[b],parseInt(b,10)!==c?e.push(a.push(d)):e.push(void 0);return e});return this.model.set("value",d),this.render()}})}.call(this),function(){FormRenderer.Models.ResponseFieldText=FormRenderer.Models.ResponseField.extend({field_type:"text"}),FormRenderer.Views.ResponseFieldText=FormRenderer.Views.ResponseField.extend({field_type:"text"})}.call(this),function(){FormRenderer.Models.ResponseFieldTime=FormRenderer.Models.ResponseField.extend({field_type:"time",wrapper:"fieldset",valueType:"hash",ignoreKeysWhenCheckingPresence:function(){return["am_pm"]},setExistingValue:function(a){if(FormRenderer.Models.ResponseField.prototype.setExistingValue.apply(this,arguments),!(null!=a?a.am_pm:void 0))return this.set("value.am_pm","AM")},toText:function(){return(this.getValue().hours||"00")+":"+(this.getValue().minutes||"00")+":"+(this.getValue().seconds||"00")+" "+this.getValue().am_pm},validateType:function(){var a,b,c;if(a=parseInt(this.get("value.hours"),10),b=parseInt(this.get("value.minutes"),10),c=parseInt(this.get("value.seconds"),10)||0,!(1<=a&&a<=12&&0<=b&&b<=59&&0<=c&&c<=59))return"time"}}),FormRenderer.Views.ResponseFieldTime=FormRenderer.Views.ResponseField.extend({wrapper:"fieldset",field_type:"time"})}.call(this),function(){FormRenderer.Models.ResponseFieldWebsite=FormRenderer.Models.ResponseField.extend({field_type:"website"}),FormRenderer.Views.ResponseFieldWebsite=FormRenderer.Views.ResponseField.extend({field_type:"website"})}.call(this),function(){var a;a={validateType:function(){},validationFns:["validateType","validateInteger","validateLength","validateMinMax"],validateComponent:function(a){var b,c,d,e,f,g,h;if(null==a&&(a={}),d=this.get("error"),this.errors=[],this.isVisible&&!this.parentGroupIsHidden()){if(this.hasValue())for(h=this.validationFns,f=0,g=h.length;f<g;f++)e=h[f],(c=this[e]())&&this.errors.push(FormRenderer.t.errors[c]);else this.isRequired()&&this.errors.push(FormRenderer.t.errors.blank);return b=this.getError(),a.clearOnly&&d!==b?this.set("error",null):this.set("error",this.getError()),this.fr.trigger("afterValidate afterValidate:one",this)}},hasIntegerValidation:function(){return"number"===this.field_type&&this.get("integer_only")},validateInteger:function(){var a;if(this.hasIntegerValidation())return a=FormRenderer.normalizeNumber(this.get("value"),this.get("units")),a.match(/^-?\d+$/)?void 0:"integer"},hasLengthValidation:function(){var a;return("text"===(a=this.field_type)||"paragraph"===a)&&(this.get("minlength")||this.get("maxlength"))},validateLength:function(){var a,b,c;if(this.hasLengthValidation())return c=parseInt(this.get("minlength"),10)||void 0,b=parseInt(this.get("maxlength"),10)||void 0,a=FormRenderer.getLength(this.getLengthValidationUnits(),this.get("value")),c&&a<c?"short":b&&a>b?"long":void 0},hasMinMaxValidation:function(){var a;return("number"===(a=this.field_type)||"price"===a)&&(this.get("min")||this.get("max"))},validateMinMax:function(){var a,b,c;if(this.hasMinMaxValidation())return b=this.get("min")&&parseFloat(this.get("min")),a=this.get("max")&&parseFloat(this.get("max")),c="price"===this.field_type?parseFloat((this.get("value.dollars")||0)+"."+(this.get("value.cents")||0)):parseFloat(this.get("value").replace(/,/g,"")),b&&c<b?"small":a&&c>a?"large":void 0}},_.extend(FormRenderer.Models.ResponseField.prototype,a)}.call(this),function(){var a;a={_sharedInitialize:function(a){return this.form_renderer=a.form_renderer,this.model=a.model,this.model.id&&this.$el.addClass("fr_response_field_"+this.model.id),this.showLabels=this.form_renderer?this.form_renderer.options.showLabels:this.showLabels=a.showLabels},reflectConditions:function(){return this.model.isVisible?this.$el.show():this.$el.hide()},domId:function(){return this.model.cid},getDomId:function(){return domId}},_.extend(FormRenderer.Views.ResponseFieldRepeatingGroup.prototype,a),_.extend(FormRenderer.Views.ResponseField.prototype,a)}.call(this),function(){var a;a={getValue:function(){return _.tap({},function(a){return function(b){return a.formComponents.each(function(a){if(a.shouldPersistValue())return b[a.get("id")]=a.getValue()})}}(this))},initFormComponents:function(a,b){var c,d,e,f;for(this.formComponents=new Backbone.Collection,this.response_fields=this.formComponents,e=0,f=a.length;e<f;e++)c=a[e],d=FormRenderer.buildFormComponentModel(c,this.fr,this),d.setExistingValue(b[d.get("id")]),this.formComponents.add(d);return this.initConditions(),this.listenTo(this.formComponents,"change:value change:value.*",function(a){return this.runConditions(a),this.fr.responsesChanged()})},initConditions:function(){return this.allConditions=_.flatten(this.formComponents.map(function(a){return _.map(a.getConditions(),function(b){return _.extend({},b,{parent:a})})}))},conditionsForResponseField:function(a){return _.filter(this.allConditions,function(b){return""+b.response_field_id==""+a.id})},runConditions:function(a){var b;if(b=!1,_.each(this.conditionsForResponseField(a),function(a){if(a.parent.calculateVisibilityIsChanged())return b=!0}),b)return this.reflectConditions()}},_.extend(FormRenderer.prototype,a),_.extend(FormRenderer.Models.ResponseFieldRepeatingGroupEntry.prototype,a)}.call(this),function(){FormRenderer.Plugins.Base=function(){function a(a){this.fr=a}return a}()}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};FormRenderer.Plugins.Autosave=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.afterFormLoad=function(){return setInterval(function(a){return function(){if(a.fr.state.get("hasChanges"))return a.fr.save()}}(this),5e3)},c}(FormRenderer.Plugins.Base)}.call(this),function(){var b,c,d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c="frDraft",b=function(b){var c,d,e;return e=a.location.href,b=b.replace(/[\[\]]/g,"\\$&"),c=new RegExp("[?&]"+b+"(=([^&#]*)|&|#|$)"),d=c.exec(e),d?d[2]?decodeURIComponent(d[2].replace(/\+/g," ")):"":null},FormRenderer.Plugins.BookmarkDraft=function(a){function d(){return d.__super__.constructor.apply(this,arguments)}return e(d,a),d.prototype.beforeFormLoad=function(){var a;if(a=b(c))return this.fr.options.response.id=a},d.prototype.afterFormLoad=function(){return this.fr.subviews.bookmarkDraft=new FormRenderer.Plugins.BookmarkDraft.View({form_renderer:this.fr}),this.fr.$el.append(this.fr.subviews.bookmarkDraft.render().el)},d}(FormRenderer.Plugins.Base),FormRenderer.Plugins.BookmarkDraft.View=Backbone.View.extend({events:{"click .js-fr-bookmark":"requestBookmark"},initialize:function(a){return this.form_renderer=a.form_renderer},render:function(){return this.$el.html(JST["plugins/bookmark_draft"](this)),this.form_renderer.trigger("viewRendered",this),this},showBookmark:function(a){return prompt(FormRenderer.t.bookmark_hint,a)},getUrl:function(){var a;return a=new Url,a.query[c]=this.form_renderer.options.response.id,a.toString()},requestBookmark:function(a){var b;return a.preventDefault(),b=function(a){return function(){return a.render(),a.showBookmark(a.getUrl())}}(this),this.form_renderer.options.response.id?b():(this.$el.find("a").text(FormRenderer.t.saving),this.form_renderer.waitForRequests(function(a){return function(){return a.form_renderer.options.response.id?b():a.form_renderer.save({cb:b})}}(this)))}})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};FormRenderer.Plugins.BottomBar=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.afterFormLoad=function(){return this.fr.subviews.bottomBar=new FormRenderer.Plugins.BottomBar.View({form_renderer:this.fr}),this.fr.$el.append(this.fr.subviews.bottomBar.render().el)},c}(FormRenderer.Plugins.Base),FormRenderer.Plugins.BottomBar.View=Backbone.View.extend({events:{"click [data-fr-previous-page]":function(a){return a.preventDefault(),this.form_renderer.handlePreviousPage()},"click [data-fr-next-page]":function(a){return a.preventDefault(),this.form_renderer.handleNextPage()}},initialize:function(a){return this.form_renderer=a.form_renderer,this.listenTo(this.form_renderer.state,"change:activePage change:hasChanges change:submitting change:hasServerErrors",this.render)},render:function(){return this.$el.html(JST["plugins/bottom_bar"](this)),this.form_renderer.trigger("viewRendered",this),this}})}.call(this),function(){var b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};FormRenderer.Plugins.ErrorBar=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return c(b,a),b.prototype.afterFormLoad=function(){return this.fr.subviews.errorBar=new FormRenderer.Plugins.ErrorBar.View({form_renderer:this.fr}),this.fr.$el.prepend(this.fr.subviews.errorBar.render().el)},b}(FormRenderer.Plugins.Base),FormRenderer.Plugins.ErrorBar.View=Backbone.View.extend({events:{"click a":function(a){return a.preventDefault(),this.form_renderer.focusFirstError()}},initialize:function(a){return this.form_renderer=a.form_renderer,this.listenTo(this.form_renderer,"afterValidate:all",function(a){return function(){return a.render(),a.$el.find(".fr_error_alert_bar a").focus()}}(this)),this.listenTo(this.form_renderer,"afterValidate:one",function(){if(this.form_renderer.areAllPagesValid())return this.render()})},render:function(){return this.$el.html(JST["plugins/error_bar"](this)),this.form_renderer.trigger("viewRendered",this),this.form_renderer.areAllPagesValid()||a.scrollTo(0,this.$el.offset().top-this.form_renderer.options.scrollToPadding),this}})}.call(this),function(){var b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};FormRenderer.Plugins.PageState=function(b){function d(){return d.__super__.constructor.apply(this,arguments)}return c(d,b),d.prototype.afterFormLoad=function(){var b,c,d;return(b=null!=(d=a.location.hash.match(/page([0-9]+)/))?d[1]:void 0)&&(c=parseInt(b,10),this.fr.isPageVisible(c)&&this.fr.activatePage(c)),this.fr.state.on("change:activePage",function(b,c){return a.location.hash="page"+c})},d}(FormRenderer.Plugins.Base)}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};FormRenderer.Plugins.SavedSession=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.beforeFormLoad=function(){var a,b;return a="project-"+this.fr.options.project_id+"-response-id",(b=this.fr.options.response).id||(b.id=Cookies.get(a)),this.fr.on("afterSave",function(){if(!this.state.get("submitting"))return Cookies.set(a,this.options.response.id)}),this.fr.on("afterSubmit",function(){return Cookies.remove(a)}),this.fr.on("errorSaving",function(){return Cookies.remove(a)})},c}(FormRenderer.Plugins.Base)}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function d(){this.constructor=b}for(var e in c)a.call(c,e)&&(b[e]=c[e]);return d.prototype=c.prototype,b.prototype=new d,b.__super__=c.prototype,b};FormRenderer.Plugins.WarnBeforeUnload=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.afterFormLoad=function(){return BeforeUnload.enable({if:function(a){return function(){return a.fr.state.get("hasChanges")}}(this)})},c}(FormRenderer.Plugins.Base)}.call(this),function(){FormRenderer.Views.Page=Backbone.View.extend({className:"fr_page",initialize:function(a){return this.form_renderer=a.form_renderer,this.models=[],this.views=[]},render:function(){var a,b,c,d,e;for(this.hide(),e=this.models,c=0,d=e.length;c<d;c++)a=e[c],b=FormRenderer.buildFormComponentView(a,this.form_renderer),this.$el.append(b.render().el),b.reflectConditions(),this.views.push(b);return this},hide:function(){var a,b,c,d,e;for(this.$el.hide(),d=this.views,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(a.trigger("hidden"));return e},show:function(){var a,b,c,d,e;for(this.$el.show(),d=this.views,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(a.trigger("shown"));return e},reflectConditions:function(){var a,b,c,d,e;for(d=this.views,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(a.reflectConditions());return e},validate:function(){var a,b,c,d,e;for(d=this.models,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(a.validateComponent());return e},fieldViews:function(){return _.tap([],function(a){return function(b){var c,d,e,f,g,h,i;for(h=a.views,i=[],f=0,g=h.length;f<g;f++)e=h[f],e.model.group?e.model.isSkipped()?i.push(void 0):i.push(function(){var a,f,g,h;for(g=e.model.entries,h=[],a=0,f=g.length;a<f;a++)c=g[a],h.push(function(){var a,e,f,g;for(f=c.view.views,g=[],a=0,e=f.length;a<e;a++)d=f[a],g.push(b.push(d));return g}());return h}()):i.push(b.push(e));return i}}(this))},firstViewWithError:function(){return _.find(this.fieldViews(),function(a){return a.model.errors.length>0})},isVisible:function(){return _.any(this.models,function(a){return a.isVisible})},isValid:function(){return!this.firstViewWithError()}})}.call(this),function(){FormRenderer.Views.Pagination=Backbone.View.extend({events:{"click [data-activate-page]":function(a){return a.preventDefault(),this.form_renderer.activatePage(e(a.currentTarget).data("activate-page"))}},initialize:function(a){return this.form_renderer=a.form_renderer,this.listenTo(this.form_renderer.state,"change:activePage",this.render),this.listenTo(this.form_renderer,"afterValidate",this.render)},render:function(){return this.$el.html(JST["partials/pagination"](this)),this.form_renderer.trigger("viewRendered",this),this}})}.call(this),FormRenderer.FILE_TYPES={images:["bmp","gif","jpg","jpeg","png","psd","tif","tiff"],videos:["m4v","mp4","mov","mpg"],audio:["m4a","mp3","wav"],docs:["doc","docx","pdf","rtf","txt"],spreadsheets:["csv","xls","xlsx"],presentations:["ppt","pptx"],pdfs:["pdf"]};var g={address:"Address",add_another:"Add another",answer:"Answer this question",back_to_page:"Back to page :num",blind:"Blind",bookmark_hint:"To finish your response later, copy the link below.",cents:"Cents",characters:"characters",choose_an_option:"Choose an option",city:"City",clear:"Clear",click_to_set:"Click to set location",coordinates:"Coordinates",country:"Country",dollars:"Dollars",email:"Email",enter_at_least:"Enter at least :min",enter_between:"Enter between :min and :max",enter_exactly:"Enter :num",enter_up_to:"Enter up to :max",error:"Error",errors:{blank:"This field can't be blank.",date:"Please enter a valid date.",email:"Please enter a valid email address.",identification:"Please enter your name and email address.",integer:"Please enter a whole number.",large:"Your answer is too large.",long:"Your answer is too long.",number:"Please enter a valid number.",phone:"Please enter a valid phone number.",price:"Please enter a valid price.",short:"Your answer is too short.",small:"Your answer is too small.",time:"Please enter a valid time.",us_phone:"Please enter a valid 10-digit phone number."},error_bar:{errors:"Your response has <a href='#'>validation errors</a>."},error_filename:"Error reading filename",error_loading:"Error loading form",error_saving:"Error saving",finishing_up:"Finishing up...",finish_later:"Finish this later",has_conditions:"Has conditions",hidden:"Hidden",loading_form:"Loading form...",na:"N/A",name:"Name",next_page:"Next page",not_supported:"Sorry, your browser does not support this embedded form. Please visit <a href=':url?fr_not_supported=t'>:url</a> to fill out this form.",other:"Other",postal_code:"Postal Code",province:"Province",remove:"Remove",saved:"Saved",saving:"Saving...",skip:"Skip this question",skipped:"This question is skipped.",state:"State",state_province_region:"State / Province / Region",submit:"Submit",submitting:"Submitting",thanks:"Thanks for submitting our form!",upload:"Upload a file",uploading:"Uploading...",upload_another:"Upload another file",we_accept:"We'll accept",words:"words",write_here:"Write your answer here",zip_code:"ZIP Code"};"undefined"!=typeof FormRenderer&&(FormRenderer.t=g),a.JST||(a.JST={}),a.JST["fields/address"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,e=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){var a,c,f,g,h,i,j,k,l;if(a=this.model.get("address_format"),e(b("\n\n")),"city_state"!==a&&"city_state_zip"!==a&&"country"!==a&&(e(b("\n  <div class='fr_grid'>\n    <div class='fr_full has_sub_label'>\n      <label class=\"fr_sub_label\" for='")),e(this.domId()),e(b("_street'>")),e(FormRenderer.t.address),e(b('</label>\n      <input type="text"\n             id="')),e(this.domId()),e(b("_street\"\n             data-rv-input='model.value.street' />\n    </div>\n  </div>\n"))),e(b("\n\n")),"country"!==a){if(e(b("\n  <div class='fr_grid'>\n    <div class='fr_half has_sub_label'>\n      <label class=\"fr_sub_label\" for='")),e(this.domId()),e(b("_city'>")),e(FormRenderer.t.city),e(b("</label>\n      <input type=\"text\"\n             data-rv-input='model.value.city'\n             id='")),e(this.domId()),e(b("_city' />\n    </div>\n\n    <div class='fr_half has_sub_label'>\n      <label class=\"fr_sub_label\" for='")),e(this.domId()),e(b("_state'>\n        ")),"US"===this.model.get("value.country")?(e(b("\n          ")),e(FormRenderer.t.state),e(b("\n        "))):"CA"===this.model.get("value.country")?(e(b("\n          ")),e(FormRenderer.t.province),e(b("\n        "))):(e(b("\n          ")),e(FormRenderer.t.state_province_region),e(b("\n        "))),e(b("\n      </label>\n\n      ")),"US"===(i=this.model.get("value.country"))||"CA"===i){for(e(b("\n        <select data-rv-value='model.value.state' data-width='100%' id='")),e(this.domId()),e(b("_state'>\n          <option></option>\n          ")),j=FormRenderer["PROVINCES_"+this.model.get("value.country")],c=0,g=j.length;c<g;c++)l=j[c],e(b("\n            <option value='")),e(l),e(b("'>")),e(l),e(b("</option>\n          "));e(b("\n        </select>\n      "))}else e(b("\n        <input type=\"text\" data-rv-input='model.value.state' id='")),e(this.domId()),e(b("_state' />\n      "));e(b("\n    </div>\n  </div>\n"))}if(e(b("\n\n<div class='fr_grid'>\n  ")),"city_state"!==a&&"country"!==a&&(e(b("\n    <div class='fr_half has_sub_label'>\n      <label class=\"fr_sub_label\" for='")),e(this.domId()),e(b("_zipcode'>\n        ")),"US"===this.model.get("value.country")?(e(b("\n          ")),e(FormRenderer.t.zip_code),e(b("\n        "))):(e(b("\n          ")),e(FormRenderer.t.postal_code),e(b("\n        "))),e(b("\n      </label>\n      <input type=\"text\"\n             data-rv-input='model.value.zipcode'\n             id='")),e(this.domId()),e(b("_zipcode' />\n    </div>\n  "))),e(b("\n\n  ")),"city_state"!==a&&"city_state_zip"!==a){for(e(b("\n    <div class='fr_half has_sub_label'>\n      <label class=\"fr_sub_label\" for='")),e(this.domId()),e(b("_country'>")),e(FormRenderer.t.country),e(b("</label>\n      <select data-rv-value='model.value.country' data-width='100%' id='")),e(this.domId()),e(b("_country'>\n        ")),k=FormRenderer.ORDERED_COUNTRIES,f=0,h=k.length;f<h;f++)l=k[f],e(b("\n          <option value='")),e(l),e(b("'>")),e(d[l]||"---"),e(b("</option>\n        "));e(b("\n      </select>\n    </div>\n  "))}e(b("\n</div>\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/block_of_text"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b(JST["partials/labels"](this))),d(b("\n\n<div class='fr_text size_")),d(this.model.getSize()),d(b("'>\n  ")),d(this.safe(FormRenderer.formatAndSanitizeHTML(this.model.get("description")))),d(b("\n</div>\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/checkboxes"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){var a,c,e,f;for(f=this.model.getOptions(),a=0,c=f.length;a<c;a++)e=f[a],d(b("\n  <label class='fr_option control'>\n    <input type='checkbox' data-rv-checkedarray='model.value.checked' value=\"")),d(e.label),d(b('" />\n    ')),d(e.translated_label||e.label),d(b("\n  </label>\n"));d(b("\n\n")),this.model.get("include_other_option")&&(d(b("\n  <div class='fr_option fr_other_option'>\n    <label class='control'>\n      <input type='checkbox' data-rv-checked='model.value.other_checked' />\n      ")),d(FormRenderer.t.other),d(b("\n    </label>\n\n    <input type='text'\n           data-rv-show='model.value.other_checked'\n           data-rv-input='model.value.other_text'\n           placeholder='")),d(FormRenderer.t.write_here),d(b("' />\n  </div>\n"))),d(b("\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/confirm"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b("<label class='fr_option control'>\n  <input type='checkbox' data-rv-checked='model.value' />\n  ")),d(this.model.get("label")),d(b(JST["partials/required"](this))),d(b("\n</label>\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/date"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b("<div class='fr_grid'>\n  <div class='has_sub_label'>\n    <label class=\"fr_sub_label\" for=\"")),d(this.domId()),d(b('_month">MM</label>\n    <input type="text"\n           id="')),d(this.domId()),d(b("_month\"\n           data-rv-input='model.value.month'\n           maxlength='2'\n           size='2' />\n  </div>\n\n  <div class='fr_spacer'>/</div>\n\n  <div class='has_sub_label'>\n    <label class=\"fr_sub_label\" for=\"")),d(this.domId()),d(b("_day\">DD</label>\n    <input type=\"text\"\n           data-rv-input='model.value.day'\n           maxlength='2'\n           size='2'\n           id=\"")),d(this.domId()),d(b('_day" />\n  </div>\n\n  ')),this.model.get("disable_year")||(d(b("\n    <div class='fr_spacer'>/</div>\n\n    <div class='has_sub_label'>\n      <label class=\"fr_sub_label\" for=\"")),d(this.domId()),d(b("_year\">YYYY</label>\n      <input type=\"text\"\n             data-rv-input='model.value.year'\n             maxlength='4'\n             size='4'\n             id=\"")),d(this.domId()),d(b('_year" />\n    </div>\n  '))),d(b("\n</div>\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/dropdown"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){var a,c,e,f;for(d(b('<select id="')),d(this.domId()),d(b("\" data-rv-value='model.value'>\n  ")),this.model.get("include_blank_option")&&(d(b('\n    <option selected value="">\n      ')),d(FormRenderer.t.choose_an_option),d(b("\n    </option>\n  "))),d(b("\n\n  ")),f=this.model.getOptions(),a=0,c=f.length;a<c;a++)e=f[a],d(b('\n    <option value="')),d(e.label),d(b('">\n      ')),d(e.translated_label||e.label),d(b("\n    </option>\n  "));d(b("\n</select>\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/email"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b('<input type="text" inputmode="email"\n       id="')),d(this.domId()),d(b("\"\n       data-rv-input='model.value' />\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/file"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){var a,c,e,g,h;for(d(b("<div class='fr_files'>\n  ")),h=this.model.getFiles(),e=0,g=h.length;e<g;e++)a=h[e],d(b("\n    <div class='fr_file'>\n      <span>")),d(a.filename),d(b("</span>\n      <button data-fr-remove-file class='")),d(FormRenderer.BUTTON_CLASS),d(b("'>")),d(FormRenderer.t.remove),d(b("</button>\n    </div>\n  "));d(b("\n</div>\n\n")),this.model.canAddFile()&&(d(b("\n  <div class='fr_add_file'>\n    <label for='")),d(this.domId()),d(b("' class='")),d(FormRenderer.BUTTON_CLASS),d(b("'>\n      ")),d(this.model.getFiles().length?FormRenderer.t.upload_another:FormRenderer.t.upload),d(b("\n    </label>\n\n    <input type='file'\n           id='")),d(this.domId()),d(b("'\n           ")),(c=this.model.getAcceptedExtensions())&&(d(b("\n            accept='")),d(c.join(",")),d(b("'\n           "))),d(b("\n           />\n\n    <span class='fr_error' style='display:none'></span>\n\n    ")),(c=this.model.getAcceptedExtensions())&&(d(b("\n      <div class='fr_description'>\n        ")),d(FormRenderer.t.we_accept),d(b(" ")),d(f.toSentence(c)),d(b("\n      </div>\n    "))),d(b("\n  </div>\n"))),d(b("\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/identification"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b("<div class='fr_grid'>\n  <div class='fr_half'>\n    <label for='")),d(this.domId()),d(b("-name'>")),d(FormRenderer.t.name),d(b(" <abbr class='fr_required' title='required'>*</abbr></label>\n    <input type='text'\n           id='")),d(this.domId()),d(b("-name'\n           data-rv-input='model.value.name' />\n  </div>\n\n  <div class='fr_half'>\n    <label for='")),d(this.domId()),d(b("-email'>")),d(FormRenderer.t.email),d(b(" <abbr class='fr_required' title='required'>*</abbr></label>\n    <input type=\"text\"\n           id='")),d(this.domId()),d(b("-email'\n           data-rv-input='model.value.email' />\n  </div>\n</div>\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/map_marker"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b("<div class='fr_map_wrapper'>\n  <div class='fr_map_map' />\n\n  <div class='fr_map_cover'>\n    ")),d(FormRenderer.t.click_to_set),d(b("\n  </div>\n\n  <div class='fr_map_toolbar'>\n    <div class='fr_map_coord'>\n      <strong>")),d(FormRenderer.t.coordinates),d(b(":</strong>\n      <span data-rv-show='model.value'>\n        <span data-rv-text='model.value.0' />,\n        <span data-rv-text='model.value.1' />\n      </span>\n      <span data-rv-hide='model.value' class='fr_map_no_location'>")),d(FormRenderer.t.na),d(b("</span>\n    </div>\n    <a class='fr_map_clear' data-fr-clear-map data-rv-show='model.value' href='#'>")),d(FormRenderer.t.clear),d(b("</a>\n  </div>\n</div>\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/number"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b('<input type="text"\n       id="')),d(this.domId()),d(b("\"\n       data-rv-input='model.value'\n       class=\"size_")),d(this.calculateSize()),d(b('" />\n\n')),this.model.get("units")&&(d(b("\n  <span class='fr_units'>\n    ")),d(this.model.get("units")),d(b("\n  </span>\n"))),d(b("\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/page_break"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b("<div class='fr_page_break_inner'>\n  Page break\n</div>\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/paragraph"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b('<textarea\n   id="')),d(this.domId()),d(b('"\n   class="size_')),d(this.model.getSize()),d(b("\"\n   data-rv-input='model.value' />\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/phone"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b('<input type="text"\n       inputmode="tel"\n       id="')),d(this.domId()),d(b("\"\n       data-rv-input='model.value'\n       placeholder=\"")),d(this.phonePlaceholder()),d(b('" />\n'))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/price"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b("<div class='fr_grid'>\n  <div class='fr_spacer'>$</div>\n\n  <div class='has_sub_label'>\n    <label class=\"fr_sub_label\" for=\"")),d(this.domId()),d(b('_dollars">')),d(FormRenderer.t.dollars),d(b('</label>\n    <input type="text"\n           id="')),d(this.domId()),d(b("_dollars\"\n           data-rv-input='model.value.dollars'\n           size='6' />\n  </div>\n\n  ")),this.model.get("disable_cents")||(d(b("\n    <div class='fr_spacer'>.</div>\n    <div class='has_sub_label'>\n      <label class=\"fr_sub_label\" for=\"")),d(this.domId()),d(b('_cents">')),d(FormRenderer.t.cents),d(b("</label>\n      <input type=\"text\"\n             data-rv-input='model.value.cents'\n             maxlength='2'\n             size='2'\n             id=\"")),d(this.domId()),d(b('_cents" />\n    </div>\n  '))),d(b("\n</div>\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/radio"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){var a,c,e,f;for(f=this.model.getOptions(),a=0,c=f.length;a<c;a++)e=f[a],d(b("\n  <label class='fr_option control'>\n    <input type='radio'\n           data-rv-dobtradiogroup='model.value.checked'\n           value=\"")),d(e.label),d(b('"\n    />\n    ')),d(e.translated_label||e.label),d(b("\n  </label>\n"));d(b("\n\n")),this.model.get("include_other_option")&&(d(b("\n  <div class='fr_option fr_other_option'>\n    <label class='control'>\n      <input type='radio'\n             data-rv-dobtradiogroup='model.value.checked'\n             class=\"js_other_option\"\n      />\n      ")),d(FormRenderer.t.other),d(b("\n    </label>\n\n    <input type='text'\n           data-rv-show='model.value.other_checked'\n           data-rv-input='model.value.other_text'\n           placeholder='")),d(FormRenderer.t.write_here),d(b("'\n    />\n  </div>\n"))),d(b("\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/section_break"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){var a;d(b(JST["partials/labels"](this))),d(b("\n\n")),a=FormRenderer.formatAndSanitizeHTML(this.model.get("description")),d(b("\n<")),d(this.model.sizeToHeaderTag()),d(b(">")),d(this.model.get("label")),d(b("</")),d(this.model.sizeToHeaderTag()),d(b(">\n")),a&&(d(b("\n  <div class='fr_text size_")),d(this.model.getSize()),d(b("'>\n    ")),d(this.safe(a)),d(b("\n  </div>\n"))),d(b("\n\n<hr />\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/table"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){var a,c,e,f,g,h,i,j,k,l,m,n,o,p;for(d(b("<table class='fr_table'>\n  <thead>\n    <tr>\n      ")),m=this.model.getColumns(),f=0,h=m.length;f<h;f++)a=m[f],d(b("\n        <th>")),d(a.translated_label||a.label),d(b("</th>\n      "));for(d(b("\n\n      <th class='fr_table_col_remove'></th>\n    </tr>\n  </thead>\n\n  <tbody>\n    ")),c=g=0,n=this.model.numRows()-1;0<=n?g<=n:g>=n;c=0<=n?++g:--g){for(d(b('\n      <tr data-row-index="')),d(c),d(b('">\n        ')),o=this.model.getColumns(),e=k=0,i=o.length;k<i;e=++k)a=o[e],d(b("\n          ")),this.model.getPresetValue(a.label,c)?(d(b("\n            <td class='fr_table_preset'>\n              <span data-rv-text='model.value.")),d(e),d(b(".")),d(c),d(b("'></span>\n          "))):(d(b("\n            <td>\n              <textarea data-rv-input='model.value.")),d(e),d(b(".")),d(c),d(b("'\n                        rows='1'\n                        aria-label=\"")),d(a.translated_label||a.label),d(b(" #")),d(c+1),d(b('"\n                        ')),0===e&&0===c&&(d(b("id='")),d(this.domId()),d(b("'"))),d(b(" />\n          "))),d(b("\n          </td>\n        "));d(b("\n\n        <td class='fr_table_col_remove'>\n          ")),this.canRemoveRow(c)&&(d(b("\n            <a class='js-remove-row' href='#'>\n              ")),d(b(FormRenderer.REMOVE_ROW_ICON)),d(b("\n            </a>\n          "))),d(b("\n        </td>\n      </tr>\n    "))}if(d(b("\n  </tbody>\n\n  ")),this.model.get("column_totals")){for(d(b("\n    <tfoot>\n      <tr>\n        ")),p=this.model.getColumns(),e=l=0,j=p.length;l<j;e=++l)a=p[e],d(b("\n          <td data-rv-text='model.columnTotals.")),d(e),d(b("'></td>\n        "));d(b('\n        <td class="fr_table_col_remove"></td>\n      </tr>\n    </tfoot>\n  '))}d(b("\n</table>\n\n<div class='fr_table_add_row_wrapper'>\n  ")),this.model.canAddRows()&&(d(b("\n    <a class='js-add-row' href='#'>\n      ")),d(b(FormRenderer.ADD_ROW_ICON)),d(b("\n      ")),d(FormRenderer.t.add_another),d(b("\n    </a>\n  "))),d(b("\n</div>\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/text"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b('<input type="text"\n       id="')),d(this.domId()),d(b('"\n       class="size_')),d(this.model.getSize()),d(b("\"\n       data-rv-input='model.value' />\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/time"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b("<div class='fr_grid'>\n  <div class='has_sub_label'>\n    <label class=\"fr_sub_label\" for=\"")),d(this.domId()),d(b('_hours">HH</label>\n    <input type="text"\n           id="')),d(this.domId()),d(b("_hours\"\n           data-rv-input='model.value.hours'\n           maxlength='2'\n           size='2' />\n  </div>\n\n  <div class='fr_spacer'>:</div>\n\n  <div class='has_sub_label'>\n    <label class=\"fr_sub_label\" for=\"")),d(this.domId()),d(b("_minutes\">MM</label>\n    <input type=\"text\"\n           data-rv-input='model.value.minutes'\n           maxlength='2'\n           size='2'\n           id=\"")),d(this.domId()),d(b('_minutes" />\n  </div>\n\n  ')),this.model.get("disable_seconds")||(d(b("\n    <div class='fr_spacer'>:</div>\n\n    <div class='has_sub_label'>\n      <label class=\"fr_sub_label\" for=\"")),d(this.domId()),d(b("_seconds\">SS</label>\n      <input type=\"text\"\n             data-rv-input='model.value.seconds'\n             maxlength='2'\n             size='2'\n             id=\"")),d(this.domId()),d(b('_seconds" />\n    </div>\n  '))),d(b("\n\n  <div class='has_sub_label'>\n    <select data-rv-value='model.value.am_pm' data-width='auto' aria-label='AM/PM'>\n      <option value='AM'>AM</option>\n      <option value='PM'>PM</option>\n    </select>\n  </div>\n</div>\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["fields/website"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b('<input type="text" inputmode="url"\n       id="')),d(this.domId()),d(b("\"\n       data-rv-input='model.value'\n       placeholder='http://' />\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST.main=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b("<div class='fr_loading'>\n  ")),d(FormRenderer.t.loading_form),d(b("\n</div>\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["partials/description"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){this.model.get("description")&&(d(b("\n  <div class='fr_description'>\n    ")),d(this.safe(FormRenderer.formatAndSanitizeHTML(this.model.get("description")))),d(b("\n  </div>\n"))),d(b("\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["partials/error"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b("<div class='fr_error' data-rv-show='model.error' data-rv-text='model.error'></div>\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["partials/label"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b("<label ")),this.model.group||"fieldset"===this.model.wrapper?d(b('aria-hidden="true"')):(d(b('for="')),d(this.domId()),d(b('"'))),d(b(">\n  ")),d(this.model.get("label")),d(b(JST["partials/required"](this))),d(b("\n  ")),d(b(JST["partials/labels"](this))),d(b("\n</label>\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["partials/labels"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){this.showLabels&&(d(b("\n  ")),this.model.get("admin_only")&&(d(b("\n    <span class='label label_fb'><i class='fa fa-lock'></i>")),d(FormRenderer.t.hidden),d(b("</span>\n  "))),d(b("\n  ")),this.model.get("blind")&&(d(b("\n    <span class='label label_fb'><i class='fa fa-eye-slash'></i> ")),d(FormRenderer.t.blind),d(b("</span>\n  "))),d(b("\n  ")),this.model.isConditional()&&(d(b("\n    <span class='label label_fb'><i class='fa fa-code-fork'></i>")),d(FormRenderer.t.has_conditions),d(b("</span>\n  "))),d(b("\n"))),d(b("\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["partials/length_counter"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b("<span class='fr_length_counter' data-rv-text='model.currentLength'></span>\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["partials/length_validations"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){var a,c,e;c=this.model.get("minlength"),d(b("\n")),a=this.model.get("maxlength"),d(b("\n")),e=this.model.getLengthValidationUnits(),d(b("\n\n")),this.model.hasLengthValidation()&&(d(b("\n  <div class='fr_min_max'>\n    <span class='fr_min_max_guide'>\n      ")),c&&a?(d(b("\n        ")),c===a?(d(b("\n          ")),d(FormRenderer.t.enter_exactly.replace(":num",c)),d(b(" ")),d(FormRenderer.t[e]),d(b(".\n        "))):(d(b("\n          ")),d(FormRenderer.t.enter_between.replace(":min",c).replace(":max",a)),d(b(" ")),d(FormRenderer.t[e]),d(b(".\n        "))),d(b("\n      "))):c?(d(b("\n        ")),d(FormRenderer.t.enter_at_least.replace(":min",c)),d(b(" ")),d(FormRenderer.t[e]),d(b(".\n      "))):a&&(d(b("\n        ")),d(FormRenderer.t.enter_up_to.replace(":max",a)),d(b(" ")),d(FormRenderer.t[e]),d(b(".\n      "))),d(b("\n    </span>\n\n    ")),d(b(JST["partials/length_counter"](this))),d(b("\n  </div>\n"))),d(b("\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["partials/min_max_validations"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){var a,c;this.model.hasMinMaxValidation()&&(d(b("\n  ")),c=this.model.get("min"),d(b("\n  ")),a=this.model.get("max"),d(b("\n\n  <div class='fr_min_max'>\n    ")),c&&a?(d(b("\n      ")),d(FormRenderer.t.enter_between.replace(":min",c).replace(":max",a)),d(b(".\n    "))):c?(d(b("\n      ")),d(FormRenderer.t.enter_at_least.replace(":min",c)),d(b(".\n    "))):a&&(d(b("\n      ")),d(FormRenderer.t.enter_up_to.replace(":max",a)),d(b(".\n    "))),d(b("\n  </div>\n"))),d(b("\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["partials/non_input_response_field"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b(JST["fields/"+this.model.field_type](this))),d(b("\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["partials/pagination"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){var a,c,e,f,g;if(this.form_renderer.visiblePages().length>1){for(d(b("\n  <ul class='fr_pagination'>\n    ")),g=this.form_renderer.visiblePages(),c=e=0,f=g.length;e<f;c=++e)a=g[c],d(b("\n      <li class='")),this.form_renderer.isPageValid(a)||d(b("has_errors")),d(b("'>\n        ")),a===this.form_renderer.state.get("activePage")?(d(b("\n          <span>")),d(c+1),d(b("</span>\n        </li>\n        "))):(d(b('\n          <a data-activate-page="')),d(a),d(b("\" href='#'>\n            ")),d(c+1),d(b("\n          </a>\n        "))),d(b("\n      </li>\n    "));d(b("\n  </ul>\n"))}d(b("\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["partials/repeating_group"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b("<fieldset class='fr_fieldset'>\n  <legend>")),d(this.model.get("label")),d(b("</legend>\n\n  ")),d(b(JST["partials/label"](this))),d(b("\n\n  ")),this.model.isSkipped()?(d(b("\n    <a href='#' class='js-skip fr_group_answer'>")),d(FormRenderer.t.answer),d(b("</a>\n    <div class='fr_group_skipped' style='clear: both'>")),d(FormRenderer.t.skipped),d(b("</div>\n  "))):(d(b("\n    ")),this.model.isRequired()||(d(b("\n      <a href='#' class='js-skip fr_group_skip'>")),d(FormRenderer.t.skip),d(b("</a>\n    "))),d(b("\n\n    <div class='fr_group_entries'>\n    </div>\n\n    ")),this.model.canAdd()&&(d(b("\n      <a href='#' class='js-add-entry ")),d(FormRenderer.BUTTON_CLASS),d(b("'>")),d(FormRenderer.t.add_another),d(b("</a>\n    "))),d(b("\n  "))),d(b("\n</fieldset>\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["partials/repeating_group_entry"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b("<div class='fr_group_entry_idx'><span>")),d(this.idx+1),d(b("</span></div>\n\n<div class='fr_group_entry_fields'>\n</div>\n\n")),this.entry.canRemove()&&(d(b("\n  <a href='#' class='js-remove-entry ")),d(b(FormRenderer.REMOVE_ENTRY_LINK_CLASS)),d(b("'>")),d(b(FormRenderer.REMOVE_ENTRY_LINK_HTML)),d(b("</a>\n"))),d(b("\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["partials/required"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){this.model.get("required")&&d(b("&nbsp;<abbr class='fr_required' title='required'>*</abbr>")),d(b("\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["partials/response_field"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){"fieldset"===this.model.wrapper?(d(b("\n  <fieldset class='fr_fieldset'>\n    <legend>")),d(this.model.get("label")),d(b("</legend>\n    ")),d(b(JST["partials/label"](this))),d(b("\n    <div class='fr_field_wrapper'>\n      ")),d(b(JST["fields/"+this.model.field_type](this))),d(b("\n    </div>\n  </fieldset>\n"))):"label"===this.model.wrapper?(d(b("\n  ")),d(b(JST["partials/label"](this))),d(b("\n  <div class='fr_field_wrapper'>\n    ")),d(b(JST["fields/"+this.model.field_type](this))),d(b("\n  </div>\n"))):(d(b("\n  <div class='fr_field_wrapper'>\n    ")),d(b(JST["fields/"+this.model.field_type](this))),d(b("\n  </div>\n"))),d(b("\n\n")),d(b(JST["partials/length_validations"](this))),d(b("\n")),d(b(JST["partials/min_max_validations"](this))),d(b("\n")),d(b(JST["partials/error"](this))),d(b("\n")),d(b(JST["partials/description"](this))),d(b("\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["plugins/bookmark_draft"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){d(b("<div class='fr_bookmark'>\n  <a href='#' class='js-fr-bookmark'>")),d(FormRenderer.t.finish_later),d(b("</a>\n</div>\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["plugins/bottom_bar"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};d(b("<div class='fr_bottom'>\n  ")),a.call(this.form_renderer.options.plugins,"Autosave")>=0&&(d(b("\n    <div class='fr_bottom_l'>\n      ")),this.form_renderer.state.get("hasServerErrors")?(d(b("\n        ")),d(this.form_renderer.state.get("serverErrorText")||FormRenderer.t.error_saving),d(b("\n      "))):this.form_renderer.state.get("hasChanges")?(d(b("\n        ")),d(FormRenderer.t.saving),d(b("\n      "))):(d(b("\n        ")),d(FormRenderer.t.saved),d(b("\n      "))),d(b("\n    </div>\n  "))),d(b("\n\n  <div class='fr_bottom_r'>\n    ")),this.form_renderer.isFirstPage()||(d(b("\n      <button data-fr-previous-page class='")),d(FormRenderer.BUTTON_CLASS),d(b("'>\n        ")),d(FormRenderer.t.back_to_page.replace(":num",this.form_renderer.previousPage())),d(b("\n      </button>\n    "))),d(b("\n\n    ")),this.form_renderer.state.get("submitting")?(d(b("\n      <button disabled class='")),d(FormRenderer.BUTTON_CLASS),d(b("'>\n        ")),d(FormRenderer.t.submitting),d(b("\n      </button>\n    "))):(d(b("\n      <button data-fr-next-page class='")),d(FormRenderer.BUTTON_CLASS),d(b("'>\n        ")),d(this.form_renderer.isLastPage()||!this.form_renderer.options.enablePages?FormRenderer.t.submit:FormRenderer.t.next_page),d(b("\n      </button>\n    "))),d(b("\n  </div>\n</div>\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())},a.JST||(a.JST={}),a.JST["plugins/error_bar"]=function(a){var b=function(a){void 0===a&&null==a&&(a="");var b=new String(a);return b.ecoSafe=!0,b};return function(){var a=[],c=this,d=function(b){void 0!==b&&null!=b&&a.push(b.ecoSafe?b:c.escape(b))};return function(){this.form_renderer.areAllPagesValid()||(d(b("\n  <div class='fr_error_alert_bar' role='alert'>\n    ")),d(b(FormRenderer.t.error_bar.errors)),d(b("\n  </div>\n"))),d(b("\n"))}.call(this),a.join("")}.call(function(){var c,d={escape:function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},safe:b};for(c in a)d[c]=a[c];return d}())}}(window);